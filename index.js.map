{"version":3,"file":"index.js","sources":["../src/net/api.js","../src/vm.js","../src/ui/GearSlots.js","../src/data/fish.js","../src/data/loot.js","../src/data/spawnTables.js","../src/sim/spawn.js","../src/data/balance.js","../src/ui/HBar.js","../src/ui/BarsDock.js","../src/progression/progress.js","../src/ui/GearModal.js","../src/data/gear.js","../src/ui/Bobber.js","../src/ui/theme.js","../src/ui/ModalHost.js","../src/assets/bg/bg_lake_day.png?url","../src/assets/bg/bg_lake_evening.png?url","../src/assets/bg/bg_lake_night.png?url","../src/assets/bg/bg_lake_sunset.png?url","../src/data/locations.js","../src/locations/LocationMgr.js","../src/data/shopCatalog.js","../src/assets/fish/bleak.png","../src/assets/fish/bream.png","../src/assets/fish/carp.png","../src/assets/fish/crucian.png","../src/assets/fish/ide.png","../src/assets/fish/perch.png","../src/assets/fish/pike.png","../src/assets/fish/roach.png","../src/assets/fish/ruffe.png","../src/assets/fish/tench.png","../src/assets/pick/chest_wood.png","../src/assets/pick/crayfish.png","../src/assets/pick/frog.png","../src/assets/pick/grass_snake.png","../src/assets/pick/loot_coins_small.png","../src/assets/pick/rusty_can.png","../src/assets/pick/stick.png","../src/assets/PhotoBank.js","../src/ui/CatchModals.js","../src/ui/KeepnetBadge.js","../src/ui/ClockHUD.js","../src/ui/LevelBadge.js","../src/ui/DepthSonar.js","../src/ui/DepthCtrl.js","../src/ui/MapModal.js","../src/ui/ActionDock.js","../src/ui/PagedGrid.js","../src/data/QuestDB.js","../src/quests/QuestEvents.js","../src/quests/QuestState.js","../src/quests/QuestRewards.js","../src/ui/QuestsModal.js","../src/ui/ActiveQuestHUD.js","../src/ui/TopHUD.js","../src/time/TimeCycle.js","../src/locations/LocationEditor.js","../src/quests/QuestKinds.js","../src/quests/QuestHooks.js","../src/quests/CatchFlow.js","../src/net/chat.js","../src/ui/ChatOverlay.js","../src/scenes/Start.js","../src/data/pricing.js","../src/ui/MarketModal.js","../src/ui/ShopModal.js","../src/ui/WalletBadge.js","../src/scenes/Base.js","../src/scenes/Auth.js","../src/main.js"],"sourcesContent":["// src/net/api.js\nconst API_BASE = (window.API_BASE || '').trim();\n\nconst LS_USER  = 'gc_user';\nconst LS_TOKEN = 'gc_token';\nconst LS_STATE = 'gc_state';\n\nasync function tryFetch(url, opts) {\n  if (!API_BASE) throw new Error('offline');\n  const r = await fetch(API_BASE + url, { credentials: 'include', ...opts });\n  if (!r.ok) throw new Error('http ' + r.status);\n  return r.json();\n}\n\nexport const Auth = {\n  isAuthed: false,\n  user: null,\n  token: null,\n\n  async ensure() {\n    const t = localStorage.getItem(LS_TOKEN);\n    const u = localStorage.getItem(LS_USER);\n    if (t && u) {\n      this.isAuthed = true; this.token = t; this.user = JSON.parse(u);\n      return true;\n    }\n    if (!API_BASE) {\n      // –æ—Ñ–ª–∞–π–Ω-–≥–æ—Å—Ç—å\n      this.isAuthed = true;\n      this.user = { id: 'guest', email: 'guest@local' };\n      this.token = 'guest';\n      localStorage.setItem(LS_USER, JSON.stringify(this.user));\n      localStorage.setItem(LS_TOKEN, this.token);\n      return true;\n    }\n    this.isAuthed = false;\n    return false;\n  },\n\n  async register({ email, password }) {\n    try {\n      const data = await tryFetch('/auth/register', {\n        method:'POST', headers:{'Content-Type':'application/json'},\n        body: JSON.stringify({ email, password })\n      });\n      this.isAuthed = true; this.user = data.user; this.token = data.token;\n      localStorage.setItem(LS_USER, JSON.stringify(this.user));\n      localStorage.setItem(LS_TOKEN, this.token);\n      return { ok:true, offline:false };\n    } catch {\n      // –æ—Ñ–ª–∞–π–Ω-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: –ª–æ–∫–∞–ª—å–Ω—ã–π ¬´–∞–∫–∫–∞—É–Ω—Ç¬ª\n      const user = { id: email, email };\n      const token = 'dev-' + btoa(email).slice(0,16);\n      this.isAuthed = true; this.user = user; this.token = token;\n      localStorage.setItem(LS_USER, JSON.stringify(user));\n      localStorage.setItem(LS_TOKEN, token);\n      return { ok:true, offline:true };\n    }\n  },\n\n  async login({ email, password }) {\n    try {\n      const data = await tryFetch('/auth/login', {\n        method:'POST', headers:{'Content-Type':'application/json'},\n        body: JSON.stringify({ email, password })\n      });\n      this.isAuthed = true; this.user = data.user; this.token = data.token;\n      localStorage.setItem(LS_USER, JSON.stringify(this.user));\n      localStorage.setItem(LS_TOKEN, this.token);\n      return { ok:true, offline:false };\n    } catch {\n      // –æ—Ñ–ª–∞–π–Ω-–ª–æ–≥–∏–Ω\n      const user = { id: email || 'guest', email: email || 'guest@local' };\n      const token = 'dev-' + btoa((email||'guest') + Date.now()).slice(0,16);\n      this.isAuthed = true; this.user = user; this.token = token;\n      localStorage.setItem(LS_USER, JSON.stringify(user));\n      localStorage.setItem(LS_TOKEN, token);\n      return { ok:true, offline:true };\n    }\n  },\n\n  logout() {\n    this.isAuthed = false; this.user = null; this.token = null;\n    localStorage.removeItem(LS_USER);\n    localStorage.removeItem(LS_TOKEN);\n  }\n};\n\nexport const API = {\n  async loadState() {\n    try {\n      return await tryFetch('/state', { method:'GET' });\n    } catch {\n      const raw = localStorage.getItem(LS_STATE);\n      return raw ? JSON.parse(raw) : null;\n    }\n  },\n  async saveState(state) {\n    localStorage.setItem(LS_STATE, JSON.stringify(state)); // –≤—Å–µ–≥–¥–∞ –¥—É–±–ª–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ\n    try {\n      return await tryFetch('/state', {\n        method:'POST',\n        headers:{'Content-Type':'application/json'},\n        body: JSON.stringify(state)\n      });\n    } catch {\n      return { ok:true, offline:true };\n    }\n  }\n};\n","// src/vm.js\nexport const VM = {\n  _s: Object.create(null),\n\n  // --- –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ---\n  get(k, dflt){ return Object.prototype.hasOwnProperty.call(this._s, k) ? this._s[k] : dflt; },\n  set(k, v){ this._s[k] = v; this._save(); return v; },\n  setMany(obj){ Object.assign(this._s, obj); this._save(); },\n  has(k){ return Object.prototype.hasOwnProperty.call(this._s, k); },\n  del(k){ if (this.has(k)) { delete this._s[k]; this._save(); } },\n  clear(){ this._s = Object.create(null); this._save(); },\n\n  // --- persist (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –í–´–ö–õ), —É–¥–æ–±–Ω–æ –¥–ª—è –¥–µ–±–∞–≥–∞ ---\n  _persist: false,\n  _lsKey: 'rf.vm',\n  init({ persist=false, key } = {}){\n    this._persist = !!persist;\n    if (key) this._lsKey = key;\n    if (this._persist) {\n      try {\n        const raw = localStorage.getItem(this._lsKey);\n        if (raw) this._s = JSON.parse(raw) || Object.create(null);\n      } catch(e){ this._s = Object.create(null); }\n    }\n    return this;\n  },\n  _save(){\n    if (!this._persist) return;\n    try { localStorage.setItem(this._lsKey, JSON.stringify(this._s)); } catch(e){}\n  },\n\n  // --- —É–¥–æ–±–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã ---\n  resetClock(){\n    this.del('clockAnchorMs');\n    this.del('clockOffsetMin');\n    this.del('clockDayLengthMin');\n  },\n\n  snapshotFromStart(scene){\n    this.setMany({\n      gear: scene.gear,\n      keepnet: scene.keepnet,\n      wallet: scene.wallet,\n      rigDepthM: scene.rigDepthM,\n      inventory: scene.inventory,\n      keepnetCap: scene.keepnetCap ?? 25,\n      locationId: scene.locationMgr?.getCurrentId?.() || scene.locationMgr?.current || 'lake',\n      level: scene.progress?.level ?? this.get('level', 1),\n    });\n  },\n\n  defaults(){\n    return {\n      gear: null,\n      keepnet: [],\n      wallet: { coins: 0, gold: 0 },\n      keepnetCap: 25,\n      rigDepthM: 1.2,\n      locationId: 'lake',\n      level: 1,\n      inventory: {\n        rods:  ['rod_wood_1'],\n        reels: ['reel_rusty'],\n        lines: ['line_old_1'],\n        hooks: ['hook_rusty'],\n        bait:  { worm: 25 },\n        hookPacks: { hook_rusty: 5 },\n      },\n    };\n  }\n};\nexport default VM;\n","// src/ui/GearSlots.js\nexport class GearSlots {\n  /**\n   * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:\n   *  A) new GearSlots(scene, gear, onClick?)\n   *  B) new GearSlots(scene, slotsBottom:number, gear)\n   */\n  constructor(scene, a2, a3) {\n    this.scene = scene;\n\n    // —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã\n    let gear, onClick, slotsBottom;\n    if (typeof a2 === 'number') {         // —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ B (–∫–∞–∫ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å)\n      slotsBottom = a2;\n      gear = a3;\n      onClick = {};\n    } else {                               // —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ A (–Ω–æ–≤–∞—è)\n      gear = a2;\n      onClick = a3 || {};\n    }\n    this.gear = gear || {};\n    this.onClick = onClick;\n\n    const W = scene.scale.width;\n    const H = scene.scale.height;\n\n    // –≥–µ–æ–º–µ—Ç—Ä–∏—è –∏ —Ä–∞–∑–º–µ—Ä—ã\n    this.MARGIN_X = 16;\n    this.GAP = 10;\n    this.SIZE = Math.min(96, Math.floor((W - this.MARGIN_X * 2 - this.GAP * 4) / 5)); // –∫–≤–∞–¥—Ä–∞—Ç\n    this.h = this.SIZE;                                // –≤–∞–∂–Ω–æ: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–Ω–∞—Ä—É–∂–∏\n    this.yBottom = (typeof slotsBottom === 'number') ? slotsBottom : (H - 12);\n    this.yTop = this.yBottom - this.h;\n\n    // –ø–æ—Ä—è–¥–æ–∫: –∫–∞–∫ –Ω–∞ —Ç–≤–æ—ë–º —Å–∫—Ä–∏–Ω–µ\n    this.items = ['rod', 'reel', 'line', 'hook', 'bait'];\n    this.icons = { rod:'üé£', reel:'üéõÔ∏è', line:'üßµ', hook:'ü™ù', bait:'ü™±' };\n\n    // X –ø–æ–∑–∏—Ü–∏–∏\n    this.xs = [];\n    for (let i = 0; i < 5; i++) {\n      this.xs.push(this.MARGIN_X + i * (this.SIZE + this.GAP));\n    }\n\n    // —Ä–µ–Ω–¥–µ—Ä\n    this._elems = [];\n    this.items.forEach((key, idx) => {\n      const x = this.xs[idx];\n\n      const bg = scene.add.graphics().setDepth(700);\n      bg.fillStyle(0x111522, 0.90);\n      bg.fillRoundedRect(x, this.yTop, this.SIZE, this.SIZE, 14);\n      bg.lineStyle(2, 0xffffff, 0.18);\n      bg.strokeRoundedRect(x, this.yTop, this.SIZE, this.SIZE, 14);\n\n      const icon = scene.add.text(x + this.SIZE / 2, this.yTop + 16, this.icons[key], {\n        fontFamily: 'Arial, sans-serif', fontSize: '34px', color: '#ffffff'\n      }).setOrigin(0.5, 0).setDepth(701);\n\n      const value = scene.add.text(x + this.SIZE / 2, this.yTop + this.SIZE - 22, '', {\n        fontFamily: 'Arial, sans-serif', fontSize: '13px', color: '#dfeaff'\n      }).setOrigin(0.5, 0).setDepth(701);\n\n      const hit = scene.add.zone(x, this.yTop, this.SIZE, this.SIZE)\n        .setOrigin(0, 0).setInteractive().setDepth(702);\n\n      hit.on('pointerdown', () => {\n        const fn = this.onClick?.[key];\n        if (typeof fn === 'function') fn();\n      });\n\n      this._elems.push({ bg, icon, value, hit, key });\n    });\n\n    this.update(this.gear);\n  }\n\n  update(gearIn) {\n    const gear = gearIn || this.gear || {};\n    const text = {\n      rod:  gear.rod ? `${gear.rod.capKg} –∫–≥` : '',\n      line: gear.line ? `${gear.line.capKg} –∫–≥` : '',\n      reel: (gear.reel && (gear.reel.pullBoost != null)) ? `${Math.round((gear.reel.pullBoost)*100)}%` : '',\n      hook: (gear.hook && (gear.hook.count != null)) ? `${gear.hook.count} —à—Ç` : '',\n      bait: `√ó ${gear.inv?.bait ?? 0}`,\n    };\n    this._elems.forEach(el => el.value.setText(text[el.key] ?? ''));\n  }\n\n  setVisible(v) {\n    this._elems.forEach(({ bg, icon, value, hit }) => {\n      bg.setVisible(v); icon.setVisible(v); value.setVisible(v); hit.setInteractive(v);\n    });\n  }\n}\n","// src/data/fish.js\nexport const FishCatalog = [\n  // ‚Äî‚Äî‚Äî –±–∞–∑–æ–≤—ã–µ ¬´–º–∏—Ä–Ω—ã–µ¬ª ‚Äî‚Äî‚Äî\n  {\n    id: 'crucian', name: '–ö–∞—Ä–∞—Å—å', rarity: 'common',\n    baseWeight: [0.20, 2.30], weightBias: 1.7,\n    marketMinKg: 0.80, pricePerKg: 4, wholesaleFactor: 0.6,\n    info: '–ù–µ–ø—Ä–∏—Ö–æ—Ç–ª–∏–≤—ã–π, –¥–µ—Ä–∂–∏—Ç—Å—è —É —Ç—Ä–∞–≤—ã –∏ –∫—Ä–æ–º–æ–∫, –ª—é–±–∏—Ç —Ç—ë–ø–ª—É—é –≤–æ–¥—É –∏ –ø—Ä–∏–∫–æ—Ä–º.',\n    habitats: ['lake','pond'],\n    prefers: { baits: ['worm','bread','corn'], time: ['dawn','day','evening'], depth: [0.3, 2.5] }\n  },\n  {\n    id: 'roach', name: '–ü–ª–æ—Ç–≤–∞', rarity: 'common',\n    baseWeight: [0.10, 1.20], weightBias: 1.6,\n    marketMinKg: 0.60, pricePerKg: 3, wholesaleFactor: 0.6,\n    info: '–°—Ç–∞–∏ –¥–µ—Ä–∂–∞—Ç—Å—è –Ω–∞ –±—Ä–æ–≤–∫–∞—Ö –∏ —É –∫—É–≤—à–∏–Ω–æ–∫, —Ö–æ—Ä–æ—à–æ –±–µ—Ä—ë—Ç —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å–∞–¥–∫–∏.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm','bread'], time: ['dawn','day','evening'], depth: [0.4, 3.0] }\n  },\n  {\n    id: 'bleak', name: '–£–∫–ª–µ–π–∫–∞', rarity: 'common',\n    baseWeight: [0.03, 0.15], weightBias: 1.2,\n    marketMinKg: 0.10, pricePerKg: 2.2, wholesaleFactor: 0.55,\n    info: '–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è —Å—Ç–∞–π–Ω–∞—è —Ä—ã–±–∞, —á–∞—Å—Ç–æ –Ω–∞ –º–µ–ª–∫–æ–≤–æ–¥—å–µ –∏ –ø–æ–¥ —Å–∞–º–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç—å—é –≤–æ–¥—ã.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['bread','worm'], time: ['dawn','day','evening'], depth: [0.1, 1.0] }\n  },\n  {\n    id: 'bream', name: '–õ–µ—â', rarity: 'uncommon',\n    baseWeight: [0.60, 3.00], weightBias: 1.7,\n    marketMinKg: 1.20, pricePerKg: 6, wholesaleFactor: 0.65,\n    info: '–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç —Å–≤–∞–ª—ã –∏ —è–º—ã, –∞–∫—Ç–∏–≤–Ω–µ–µ —Å—É–º–µ—Ä–∫–∞–º–∏ –∏ –Ω–æ—á—å—é. –õ—é–±–∏—Ç –ø—Ä–∏–∫–æ—Ä–º.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm','corn'], time: ['dawn','evening','night'], depth: [1.5, 6.0] }\n  },\n  {\n    id: 'tench', name: '–õ–∏–Ω—å', rarity: 'uncommon',\n    baseWeight: [0.40, 2.80], weightBias: 1.7,\n    marketMinKg: 1.00, pricePerKg: 7, wholesaleFactor: 0.7,\n    info: '–¢–∏—Ö–∏–µ –∑–∞—Ä–æ—Å—à–∏–µ –∑–∞–ª–∏–≤—ã; –∞–∫—Ç–∏–≤–µ–Ω –Ω–∞ –∑–æ—Ä—è—Ö.',\n    habitats: ['lake','pond'],\n    prefers: { baits: ['worm','corn'], time: ['dawn','evening'], depth: [0.5, 2.5] }\n  },\n  {\n    id: 'ide', name: '–Ø–∑—å', rarity: 'uncommon',\n    baseWeight: [0.50, 2.50], weightBias: 1.6,\n    marketMinKg: 1.20, pricePerKg: 6, wholesaleFactor: 0.65,\n    info: '–°–∏–ª—å–Ω–∞—è —Ä—ã–±–∞ —Å—Ç—Ä—É–π –∏ –æ–±—Ä–∞—Ç–æ–∫; –∫–ª—é—ë—Ç –Ω–∞ –∂–∏–≤–æ—Ç–Ω—ã–µ –∏ —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å–∞–¥–∫–∏.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm','bread'], time: ['dawn','day','evening'], depth: [0.5, 2.5] }\n  },\n\n  // ‚Äî‚Äî‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –º–∏—Ä–Ω—ã–µ ‚Äî‚Äî‚Äî\n  {\n    id: 'rudd', name: '–ö—Ä–∞—Å–Ω–æ–ø—ë—Ä–∫–∞', rarity: 'common',\n    baseWeight: [0.05, 0.60], weightBias: 1.5,\n    marketMinKg: 0.25, pricePerKg: 3.5, wholesaleFactor: 0.6,\n    info: '–õ—é–±–∏—Ç –∫—É–≤—à–∏–Ω–∫–∏ –∏ –∫—Ä–æ–º–∫–∏ —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏; –±–µ—Ä—ë—Ç –ª—ë–≥–∫–∏–µ –Ω–∞—Å–∞–¥–∫–∏ –≤ –ø–æ–ª–≤–æ–¥—ã.',\n    habitats: ['lake','pond','river'],\n    prefers: { baits: ['bread','worm'], time: ['dawn','day','evening'], depth: [0.3, 2.0] }\n  },\n  {\n    id: 'silver_bream', name: '–ì—É—Å—Ç–µ—Ä–∞', rarity: 'common',\n    baseWeight: [0.20, 1.20], weightBias: 1.7,\n    marketMinKg: 0.60, pricePerKg: 3.8, wholesaleFactor: 0.6,\n    info: '–†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏—Ü–∞ –ª–µ—â–∞; –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ø–æ–≥–ª—É–±–∂–µ –∏ –∞–∫—Ç–∏–≤–Ω–∞ —Å—É–º–µ—Ä–∫–∞–º–∏.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm'], time: ['dawn','evening','night'], depth: [1.5, 4.0] }\n  },\n  {\n    id: 'dace', name: '–ï–ª–µ—Ü', rarity: 'common',\n    baseWeight: [0.05, 0.40], weightBias: 1.5,\n    marketMinKg: 0.20, pricePerKg: 3.2, wholesaleFactor: 0.6,\n    info: '–ú–µ–ª–∫–∏–µ –±—ã—Å—Ç—Ä—ã–µ —Å—Ç—Ä—É–∏, —á–∏—Å—Ç–∞—è –≤–æ–¥–∞; –ª—é–±–∏—Ç –º–µ–ª–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ –Ω–∞—Å–∞–¥–∫–∏.',\n    habitats: ['river'],\n    prefers: { baits: ['worm','bread'], time: ['dawn','day','evening'], depth: [0.3, 2.0] }\n  },\n  {\n    id: 'chub', name: '–ì–æ–ª–∞–≤–ª—å', rarity: 'uncommon',\n    baseWeight: [0.40, 3.00], weightBias: 1.6,\n    marketMinKg: 1.00, pricePerKg: 7, wholesaleFactor: 0.7,\n    info: '–ü–µ—Ä–µ–∫–∞—Ç—ã –∏ –∫–æ—Ä—è–∂–Ω–∏–∫; –ø–æ–ª—É-—Ö–∏—â–Ω–∏–∫, –±–µ—Ä—ë—Ç –Ω–∞—Å–∞–¥–∫–∏ –∏ –≤–µ—Ä—Ç—É—à–∫–∏.',\n    habitats: ['river'],\n    prefers: { baits: ['worm','bread','spinner'], time: ['dawn','day','evening'], depth: [0.4, 2.5] }\n  },\n\n  // ‚Äî‚Äî‚Äî —Ö–∏—â–Ω–∏–∫–∏ ‚Äî‚Äî‚Äî\n  {\n    id: 'perch', name: '–û–∫—É–Ω—å', rarity: 'common',\n    baseWeight: [0.20, 1.50], weightBias: 1.5,\n    marketMinKg: 0.60, pricePerKg: 5, wholesaleFactor: 0.65,\n    info: '–°—Ç–∞–∏ —É –∫–æ—Ä—è–∂–Ω–∏–∫–∞ –∏ —Å–≤–∞–ª–æ–≤; —Ö–æ—Ä–æ—à–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –±–ª—ë—Å–Ω—ã –∏ –º–∞–ª—å–∫–∞.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm','spinner','fish'], time: ['dawn','day','evening'], depth: [0.5, 4.0] }\n  },\n  {\n    id: 'pike', name: '–©—É–∫–∞', rarity: 'rare',\n    baseWeight: [0.80, 3.50], weightBias: 1.8,\n    marketMinKg: 2.00, pricePerKg: 9, wholesaleFactor: 0.7,\n    info: '–ê–º–±—É—à—é—Ä–Ω—ã–π —Ö–∏—â–Ω–∏–∫ —É —Ç—Ä–∞–≤—ã; –ø–∏–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚Äî —Ä–∞—Å—Å–≤–µ—Ç –∏ –∑–∞–∫–∞—Ç.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['fish','spinner'], time: ['dawn','evening','day'], depth: [0.5, 3.5] }\n  },\n  {\n    id: 'zander', name: '–°—É–¥–∞–∫', rarity: 'rare',\n    baseWeight: [1.00, 6.00], weightBias: 1.9,\n    marketMinKg: 1.80, pricePerKg: 10, wholesaleFactor: 0.72,\n    info: '–ì–ª—É–±–æ–∫–∏–µ –±—Ä–æ–≤–∫–∏; –∞–∫—Ç–∏–≤–µ–Ω –≤ —Ç–µ–º–Ω–æ—Ç–µ –∏ –Ω–∞ –∑–æ—Ä—è—Ö.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['fish','spinner'], time: ['dawn','evening','night'], depth: [2.0, 8.0] }\n  },\n  {\n    id: 'asp', name: '–ñ–µ—Ä–µ—Ö', rarity: 'rare',\n    baseWeight: [1.00, 4.00], weightBias: 1.8,\n    marketMinKg: 1.50, pricePerKg: 9, wholesaleFactor: 0.7,\n    info: '–ü–µ–ª–∞–≥–∏—á–µ—Å–∫–∏–π —Ä–µ—á–Ω–æ–π —Ö–∏—â–Ω–∏–∫; –≤—ã—Ö–æ–¥–∏—Ç –±–∏—Ç—å –º–∞–ª—å–∫–∞ –Ω–∞ —Ä–∞—Å—Å–≤–µ—Ç–µ.',\n    habitats: ['river'],\n    prefers: { baits: ['spinner','fish'], time: ['dawn','day'], depth: [0.5, 3.0] }\n  },\n  {\n    id: 'burbot', name: '–ù–∞–ª–∏–º', rarity: 'uncommon',\n    baseWeight: [0.60, 3.00], weightBias: 1.7,\n    marketMinKg: 1.00, pricePerKg: 7, wholesaleFactor: 0.7,\n    info: '–ù–æ—á–Ω–æ–π —Ö–æ–ª–æ–¥–æ–ª—é–±–∏–≤—ã–π —Ö–∏—â–Ω–∏–∫; –¥–µ—Ä–∂–∏—Ç—Å—è —è–º, –±–µ—Ä—ë—Ç –Ω–∞ —Ä—ã–±—å–∏ –∫—É—Å–∫–∏ –∏ —á–µ—Ä–≤—è.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['fish','worm'], time: ['night','dawn'], depth: [2.0, 6.0] }\n  },\n  {\n    id: 'catfish', name: '–°–æ–º', rarity: 'epic',\n    baseWeight: [1.50, 8.00], weightBias: 2.0,\n    marketMinKg: 2.50, pricePerKg: 11, wholesaleFactor: 0.75,\n    info: '–ö—Ä—É–ø–Ω—ã–π –¥–æ–Ω–Ω—ã–π —Ö–∏—â–Ω–∏–∫; –∞–∫—Ç–∏–≤–µ–Ω –Ω–æ—á—å—é, –ª—é–±–∏—Ç —è–º—ã –∏ –∫–æ—Ä—è–∂–Ω–∏–∫.',\n    habitats: ['lake','river'],\n    prefers: { baits: ['fish','worm'], time: ['night','evening'], depth: [2.0, 8.0] }\n  },\n\n  // ‚Äî‚Äî‚Äî –∫–∞—Ä–ø–æ–≤—ã–µ ¬´—Ç—è–∂–∏¬ª ‚Äî‚Äî‚Äî\n  {\n    id: 'carp', name: '–ö–∞—Ä–ø', rarity: 'rare',\n    baseWeight: [1.00, 4.00], weightBias: 1.9,\n    marketMinKg: 2.00, pricePerKg: 8, wholesaleFactor: 0.7,\n    info: '–°–∏–ª—å–Ω–∞—è –¥–æ–Ω–Ω–∞—è —Ä—ã–±–∞; –ª—é–±–∏—Ç –ø—Ä–∏–∫–æ—Ä–º–ª–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –∏ –æ–∫–Ω–∞ –≤ —Ç—Ä–∞–≤–µ.',\n    habitats: ['lake','pond'],\n    prefers: { baits: ['corn','bread','worm'], time: ['dawn','day','evening'], depth: [1.0, 5.0] }\n  }\n];\n","\n// src/data/loot.js\nexport const LootCatalog = [\n  // ‚Äî‚Äî‚Äî –°–æ–∫—Ä–æ–≤–∏—â–∞ / –Ω–∞–≥—Ä–∞–¥—ã ‚Äî‚Äî‚Äî\n  {\n    id: 'loot_coins_small', kind: 'loot', name: '–ö–æ—à–µ–ª—ë–∫ –º–æ–Ω–µ—Ç', rarity: 'uncommon',\n    habitats: ['lake','river','pond'],\n    prefers: { baits: ['worm','bread'], time: ['day','evening',], depth: [1, 3] },\n    reward: { coins: [50, 150] } // –¥–∏–∞–ø–∞–∑–æ–Ω –º–æ–Ω–µ—Ç\n  },\n  {\n    id: 'chest_wood', kind: 'loot', name: '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π —è—â–∏–∫', rarity: 'rare',\n    habitats: ['lake'],\n    prefers: { baits: ['worm','bread','corn','fish'], time: ['day','evening','night','dawn'], depth: [3, 5] },\n    reward: { coins: [2000, 60000] } // —Å–µ–π—á–∞—Å —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –¥–∞—ë—Ç –º–æ–Ω–µ—Ç—ã\n  },\n\n  // ‚Äî‚Äî‚Äî –ü–æ–±–æ—á–Ω–∞—è –∂–∏–≤–Ω–æ—Å—Ç—å (–º–æ–∂–Ω–æ ¬´–ø—Ä–æ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –µ—Å—Ç—å¬ª) ‚Äî‚Äî‚Äî\n  {\n    id: 'crayfish', kind: 'bycatch', name: '–†–∞–∫', rarity: 'uncommon',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm'], time: ['evening','night'], depth: [1, 3] },\n    sell: { price: 2 } // –ø—Ä–æ—Å—Ç–æ –Ω–∞—á–∏—Å–ª—è–µ–º –º–æ–Ω–µ—Ç—ã –∫–∞–∫ –∑–∞ –ø—Ä–æ–¥–∞–∂—É\n  },\n  {\n    id: 'frog', kind: 'bycatch', name: '–ñ–∞–±–∞', rarity: 'common',\n    habitats: ['pond','lake'],\n    prefers: { baits: ['worm','bread'], time: ['evening','night'], depth: [0, 1] },\n    sell: { price: 1 }\n  },\n\n  // ‚Äî‚Äî‚Äî –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π –º—É—Å–æ—Ä ‚Äî‚Äî‚Äî\n  {\n    id: 'rusty_can', kind: 'trash', name: '–†–∂–∞–≤–∞—è –±–∞–Ω–∫–∞', rarity: 'common',\n    habitats: ['lake','river'],\n    prefers: { baits: ['worm','bread'], time: ['day','evening'], depth: [0, 1] },\n    reward: { coins: [0, 2] } // –∏–Ω–æ–≥–¥–∞ —á—É—Ç—å-—á—É—Ç—å –º–æ–Ω–µ—Ç\n  },\n  {\n    id: 'stick', kind: 'trash', name: '–ü–∞–ª–∫–∞', rarity: 'common',\n    habitats: ['lake'],\n    prefers: { baits: ['worm','bread'], time: ['day','evening'], depth: [0, 1] },\n    reward: { coins: [0, 1] }\n  },\n\n  // ‚Äî‚Äî‚Äî –ù–∞ –±—É–¥—É—â–µ–µ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å ‚Äî‚Äî‚Äî\n  {\n    id: 'grass_snake', kind: 'bycatch', name: '–£–∂', rarity: 'rare',\n    habitats: ['lake','river'],\n    prefers: { baits: ['fish','worm'], time: ['day'], depth: [0, 1] },\n    reward: { coins: [1, 3] } // —Å–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ –º–æ–Ω–µ—Ç–∫–∏\n  }\n];\n","// src/data/spawnTables.js\n// –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∫ —à–∞–Ω—Å–∞–º (1 = –æ–±—ã—á–Ω–æ, 0 = –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è)\n// –ö–∞–∫–∏–µ –≤–∏–¥—ã –∏ —Å –∫–∞–∫–∏–º–∏ –≤–µ—Å–∞–º–∏ (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏) –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –ª–æ–∫–∞—Ü–∏—è—Ö.\n// minDepth ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞, —Å –∫–æ—Ç–æ—Ä–æ–π –≤–∏–¥ –¥–æ—Å—Ç—É–ø–µ–Ω.\n// –î–ª—è –∫–∞–∂–¥–æ–π –ª–æ–∫–∞—Ü–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–¥—ã.\n// –ó–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å:\n//  - number        ‚Üí –º–Ω–æ–∂–∏—Ç–µ–ª—å –≤–µ—Å–∞ (1 = –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, 0 = –≤—ã–∫–ª—é—á–µ–Ω–æ);\n//  - object        ‚Üí { w?:number, minDepth?:number, maxDepth?:number }\n\nexport const SPAWN_TABLES = {\n  lake: {\n    crucian: 1.2,\n    roach:   1.1,\n    perch:    0.9,\n    ruffe:     0.8 ,\n    bleak:   0.7,\n    bream:     0.6,\n    tench:     0.5 ,\n    ide:     0.6,\n    pike:      0.35,\n    carp:      0.4,\n    rudd: 0.9,\n     silver_bream: 0.7,\n      dace: 0.0,\n       chub: 0.0, // (—Ä–µ—á–Ω—ã—Ö ‚Äî 0 –≤ –æ–∑–µ—Ä–µ)\n  zander:  0.25,\n   asp: 0.0,\n    burbot:  0.35,\n  catfish:0.15,\n   minDepth: 2.0 , \n  pike:   0.35  ,\n\n    // –ª—É—Ç—Ç\n    loot_coins_small:   0.06,\n    chest_wood:         0.015, \n    crayfish:           0.20, \n    frog:               0.12,              \n    rusty_can:          0.15,        \n    stick:              0.12,              \n    grass_snake:        0.03,             \n  },\n\n\n  river: {\n    crucian: 0.6,\n    roach:   1.2,\n    perch:     1.0,\n    ruffe:   1.0,\n    bleak:   1.1,\n    bream:     0.7 ,\n    tench:   0.0,                 // –Ω–µ—Ç –≤ —Ä–µ–∫–µ\n    ide:       0.9 ,\n    pike:      0.4,\n    carp:    0.3,\n  },\n\n  // sea –∑–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç—ã—à–∫–∞ (–Ω–µ—Ç –º–æ—Ä—Å–∫–∏—Ö –≤–∏–¥–æ–≤ –≤ FishCatalog)\n  sea: {\n    crucian: 0, roach: 0, perch: 0, ruffe: 0, bleak: 0,\n    bream: 0, tench: 0, ide: 0, pike: 0, carp: 0\n  }\n};\n","// src/sim/spawn.js\nimport { FishCatalog } from '../data/fish.js';\nimport { LootCatalog } from '../data/loot.js';\nimport { SPAWN_TABLES } from '../data/spawnTables.js';\n\n// –ï–¥–∏–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥: —Ä—ã–±–µ –ø—Ä–æ—Å—Ç–∞–≤–∏–º kind='fish'\nconst Catalog = [\n  ...FishCatalog.map(s => ({ ...s, kind: 'fish' })),\n  ...LootCatalog\n];\nconst DEBUG_SPAWN = true;\n\n\nfunction weightFromTable(loc, id) {\n  const v = (SPAWN_TABLES[loc] || {})[id];\n  if (v == null) return 0;\n  if (typeof v === 'number') return v;\n  return v.w ?? 1;\n}\n\nfunction timeAllowed(def, tag){\n  const pref = def?.prefers?.time;\n  if (!pref || !Array.isArray(pref) || pref.length === 0) return true;\n  return pref.includes(tag);   // <-- –ë–ï–ó –ø–æ–±–ª–∞–∂–µ–∫ \n}\n\n\nfunction depthRangeFromTable(loc, id) {\n  const v = (SPAWN_TABLES[loc] || {})[id];\n  if (v && typeof v === 'object') {\n    return [v.minDepth ?? -Infinity, v.maxDepth ?? Infinity];\n  }\n  return [-Infinity, Infinity];\n}\n\nfunction pickWeighted(pairs) {\n  const sum = pairs.reduce((s, [, w]) => s + w, 0);\n  if (sum <= 0) return pairs[0]?.[0] ?? null;\n  let r = Math.random() * sum;\n  for (const [obj, w] of pairs) { r -= w; if (r <= 0) return obj; }\n  return pairs[pairs.length - 1][0];\n}\n\n// –í–µ—Å (–∫–≥) —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä—ã–±—ã\nfunction rollWeight(spec, bait) {\n  const [minW, maxW] = spec.baseWeight || [0.2, 2.0];\n  const baseBias = spec.weightBias ?? 1.6; // >1 ‚Üí —á–∞—â–µ –∫ min\n  const bias = (spec.prefers?.baits?.includes(bait)) ? baseBias * 0.8 : baseBias;\n  const t = Math.pow(Math.random(), bias);\n  return +(minW + t * (maxW - minW)).toFixed(3);\n}\n\n// –ù–∞–≥—Ä–∞–¥—ã –¥–ª—è –ª—É—Ç–∞/–º—É—Å–æ—Ä–∞/–ø–æ–±–æ—á–∫–∏\nfunction randInt(a, b) { return Math.floor(a + Math.random() * (b - a + 1)); }\nfunction rollReward(spec) {\n  if (spec.reward?.coins) {\n    const [a, b] = spec.reward.coins;\n    return { coins: randInt(a, b) };\n  }\n  if (spec.sell?.price) return { coins: spec.sell.price };\n  return {};\n}\n\n// === –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ===\nexport function spawnFish(ctx = {}) {\n  const bait = ctx.bait ?? 'worm';\n  const tod  = ctx.timeOfDay ?? 'day';\n  const loc  = ctx.locationId ?? 'lake';\n  const d    = ctx.depthM ?? 1.5;\n\n  console.log('[spawnFish ctx]', { bait, tod, loc, depthM: d });\n\n// 1) –ñ—ë—Å—Ç–∫–∏–π —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É –∏ —Ç–∞–±–ª–∏—Ü–∞–º (—Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π)\nconst candidates = Catalog.filter(sp => {\n  if (sp.habitats && !sp.habitats.includes(loc)) {\n    if (DEBUG_SPAWN) console.log('‚Äì', sp.id, '–Ω–µ—Ç –≤ habitat', loc);\n    return false;\n  }\n\n  if (sp.prefers?.baits && !sp.prefers.baits.includes(bait)) {\n    if (DEBUG_SPAWN) console.log('‚Äì', sp.id, 'bait!=', bait);\n    return false;\n  }\n\n  if (!timeAllowed(sp, tod)) {\n    if (DEBUG_SPAWN) console.log('‚Äì', sp.id, 'time!=', tod, 'need one of', sp.prefers?.time);\n    return false;\n  }\n\n  if (sp.prefers?.depth?.length === 2) {\n    const [d0, d1] = sp.prefers.depth;\n    if (d < d0 || d > d1) {\n      if (DEBUG_SPAWN) console.log('‚Äì', sp.id, `depth ${d} ‚àâ [${d0}, ${d1}]`);\n      return false;\n    }\n  }\n\n  const [minD, maxD] = depthRangeFromTable(loc, sp.id);\n  if (d < minD || d > maxD) {\n    if (DEBUG_SPAWN) console.log('‚Äì', sp.id, `depth ${d} ‚àâ table[${minD}, ${maxD}]`);\n    return false;\n  }\n\n  const w = weightFromTable(loc, sp.id);\n  if (!(w > 0)) {\n    if (DEBUG_SPAWN) console.log('‚Äì', sp.id, 'weight=0');\n    return false;\n  }\n  return true;\n});\n\n\nif (!candidates.length) {\n  console.warn('[spawnFish] no candidates after filters', { loc, d, bait, tod });\n  return null;\n}\n\nconst pool = candidates;\n\n  if (!pool.length) {\n    console.warn('[spawnFish] empty pool', { loc, d, bait, tod });\n    return null;\n  }\n\n  // 2) –í–µ—Å–∞: —Ç–∞–±–ª–∏—Ü–∞ √ó —Ç–∏–ø √ó –∑–æ–Ω–∞–ª—å–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä—ã–±—ã)\n  const areaMods = (x, y) => {\n    if (typeof ctx.getAreaMods === 'function') return ctx.getAreaMods(x, y);\n    if (typeof ctx.getSpotMods === 'function') return ctx.getSpotMods(x, y);\n    return null;\n  };\n\n  // –ß–µ–º –º–µ–Ω—å—à–µ –º–Ω–æ–∂–∏—Ç–µ–ª—å ‚Äî —Ç–µ–º —Ä–µ–∂–µ —Ç–∏–ø.\n  const TYPE_WEIGHT = { fish: 1.0, loot: 0.06, bycatch: 0.12, trash: 0.10 };\n\n  const pairs = pool.map(sp => {\n    let w = weightFromTable(loc, sp.id) * (TYPE_WEIGHT[sp.kind] ?? 1);\n    if (sp.kind === 'fish' && ctx.cast) {\n      const mul = areaMods(ctx.cast.x, ctx.cast.y)?.species?.[sp.id];\n      if (mul) w *= mul;\n    }\n    return [sp, Math.max(0, w)];\n  });\n\n  console.log('[spawnFish pool]', pool.map(s => `${s.kind}:${s.id}`));\n  console.table(pairs.map(([s, w]) => ({ id: s.id, kind: s.kind, w })));\n\n  // 3) –í—ã–±–æ—Ä\n  const chosenSpec = pickWeighted(pairs) || pairs[0][0];\n  const chosenW = pairs.find(([s]) => s.id === chosenSpec.id)?.[1];\n  console.log('[spawnFish chosen]', chosenSpec.kind, chosenSpec.id, 'w=', chosenW, 'depth=', d);\n\n  // 4) –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞\n  if (chosenSpec.kind === 'fish') {\n    const weightKg = rollWeight(chosenSpec, bait);\n    return {\n      kind: 'fish',\n      id: chosenSpec.id,\n      name: chosenSpec.name,\n      weightKg,\n      priceKg: chosenSpec.pricePerKg ?? 1,\n      maxKg:   chosenSpec.baseWeight?.[1] ?? weightKg,\n      spec: chosenSpec\n    };\n  } else {\n    const reward = rollReward(chosenSpec);\n    return {\n      kind: chosenSpec.kind,   // 'loot' | 'trash' | 'bycatch'\n      id: chosenSpec.id,\n      name: chosenSpec.name,\n      reward,\n      spec: chosenSpec\n    };\n  }\n}\n","// src/data/balance.js\n\n/**\n * –ë–æ–≥–∞—Ç—ã–π —Ç—é–Ω–∏–Ω–≥ –±–æ—ë–≤–∫–∏. –í—Å—ë –≤ –ø–∏–∫—Å–µ–ª—è—Ö/—Å–µ–∫ –∏ –µ–¥/—Å–µ–∫.\n * –ú–µ–Ω—è–π –∫–∞–∫ —É–¥–æ–±–Ω–æ –∏–ª–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ —á–µ—Ä–µ–∑ opts.tuning.\n */\nexport const BASE_TUNING = {\n  // –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∫–∞–ª (0..100)\n  tension: {\n    fillTimeAt1: 0.90,      // –ø—Ä–∏ ratio=1.0 (–≤–µ—Å/–ø—Ä–æ—á–Ω–æ—Å—Ç—å) –∑–∞ —Å–∫–æ–ª—å–∫–æ —Å–µ–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è 0‚Üí100\n    curveAlpha: 1.20,       // –∫—Ä–∏–≤–∏–∑–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–æ—Å—Ç–∞ –ø—Ä–∏ —Ç—è–∂—ë–ª—ã—Ö —Ä—ã–±–∏–Ω–∞—Ö\n    downPerSec: 150,        // —Å–ø–∞–¥ –ø—Ä–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏ (–µ–¥/—Å–µ–∫)\n  },\n\n  // –°–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –ø–æ –≤–æ–¥–µ\n  speeds: {\n    basePull: 1500,          // –±–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –∏–≥—Ä–æ–∫–æ–º (px/s) –¥–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤\n    baseFish: 7 ,           // –±–∞–∑–æ–≤–∞—è ¬´—É–ø–ª—ã–≤–∞–ª–∫–∞¬ª —Ä—ã–±—ã (px/s) –¥–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤\n    minPull: 30,            // –Ω–∏–∂–Ω–∏–π –ø—Ä–µ–¥–µ–ª, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ ¬´–∑–∞–ª–∏–ø–∞–Ω–∏—è¬ª\n    minFish: 18,            // ‚Üê –æ–ø—É—Å—Ç–∏, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –û–ß–ï–ù–¨ –º–µ–¥–ª–µ–Ω–Ω—É—é —Ä—ã–±—É\n    hookQPullBonus: 0.25,   // –ø—Ä–∏–±–∞–≤–∫–∞ –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–≥—Ä–æ–∫–∞ –æ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥—Å–µ—á–∫–∏ (0..1)\n    heavinessFishBonus: 0.10, // —Ä—ã–±–∞ –±—ã—Å—Ç—Ä–µ–µ –ø—Ä–∏ ratio>1 (–Ω–∞ —Å–∫–æ–ª—å–∫–æ –∑–∞ Œîratio=+1)\n  },\n\n  // –ö—Ä—ã—à–∫–∞: —Ä—ã–±–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ù–ê–í–°–ï–ì–î–ê –±—ã—Å—Ç—Ä–µ–µ –∏–≥—Ä–æ–∫–∞\n  caps: {\n    fishCapBase: 1.12,      // —Ä—ã–±–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –±—ã—Ç—å —á—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ –∏–≥—Ä–æ–∫–∞\n    fishCapByMiss: 0.08,    // +—Å–∫–æ–ª—å–∫–æ –∫–∞–ø–∞ –ø—Ä–∏ –ø–ª–æ—Ö–æ–π –ø–æ–¥—Å–µ—á–∫–µ (1 - hookQ)\n  },\n\n  // ¬´–°–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –Ω–µ —Ç—è–Ω—É—Ç—å¬ª (—Å–µ–∫—É–Ω–¥)\n  escape: {\n    base: 3.2,\n    byHookQ: 1.4,           // —á–µ–º –ª—É—á—à–µ –ø–æ–¥—Å–µ—á–∫–∞ ‚Äî —Ç–µ–º –¥–æ–ª—å—à–µ –æ–∫–Ω–æ\n    byHookCtrl: 0.5,        // —Ö–æ—Ä–æ—à–∏–µ –∫—Ä—é—á–∫–∏ –¥–∞—é—Ç –ª—é—Ñ—Ç\n    byMeanRatio: 0.4,       // —Ç—è–∂—ë–ª–∞—è —Ä—ã–±–∞ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –æ–∫–Ω–æ\n    byEndurance: 0.6,       // –≤—ã–Ω–æ—Å–ª–∏–≤—ã–µ –≤–∏–¥—ã —É–º–µ–Ω—å—à–∞—é—Ç –æ–∫–Ω–æ\n  },\n\n  // –†—ã–≤–∫–∏ —Ä—ã–±—ã\n  jerk: {\n    minMs: 2400, maxMs: 3600,\n    baseAdd: 5,            // +–µ–¥. –≤ –±–∞—Ä—ã –ø—Ä–∏ —Ä—ã–≤–∫–µ\n    addPerHeav: 12,        // –ø—Ä–∏—Ä–æ—Å—Ç –æ—Ç —Ç—è–∂–µ—Å—Ç–∏ (heav = max(0, meanRatio-0.3))\n    maxAdd: 22,            // –ø–æ—Ç–æ–ª–æ–∫ —Å–∏–ª—ã —Ä—ã–≤–∫–∞\n    chance: 0.65,          // –±–∞–∑–æ–≤—ã–π —à–∞–Ω—Å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ —Ç–∏–∫–µ\n    burstChanceScale: 0.20 // –≤–ª–∏—è–Ω–∏–µ ¬´–≤–∑—Ä—ã–≤–Ω–æ—Å—Ç–∏¬ª –≤–∏–¥–∞ –Ω–∞ —à–∞–Ω—Å\n  },\n\n  // –í–ª–∏—è–Ω–∏–µ —Å—Ä–µ–¥—ã (–≤—Å–µ 0..1)\n  env: {\n    currentToFish: 0.30,    // —Ç–µ—á–µ–Ω–∏–µ —É—Å–∫–æ—Ä—è–µ—Ç —Ä—ã–±—É\n    wavesToFish:   0.10,    // –≤–æ–ª–Ω—ã –ª—ë–≥–∫–æ –¥–æ–±–∞–≤–ª—è—é—Ç ¬´—É–ø–ª—ã–≤–∞–ª–∫—É¬ª\n    vegToPlayer:  -0.10,    // –≤–æ–¥–æ—Ä–æ—Å–ª–∏ –º–µ—à–∞—é—Ç –∏–≥—Ä–æ–∫—É (- –æ–∑–Ω–∞—á–∞–µ—Ç –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ)\n  },\n\n  // –®—Ç—Ä–∞—Ñ –∑–∞ ¬´–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ¬ª –æ—Å–Ω–∞—Å—Ç–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –≥–ª—É–±–∏–Ω–µ, –≤ –º–µ—Ç—Ä–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\n  hook: {\n    penaltyPerRigM: 0.15,   // –Ω–∞ –∫–∞–∂–¥—ã–π 1–º –ª–∏—à–Ω–µ–π –¥–ª–∏–Ω—ã –æ—Å–Ω–∞—Å—Ç–∫–∏ ‚Äî -0.15 –∫ hookQ\n  },\n\n  // –°–∫–æ–ª—å–∂–µ–Ω–∏–µ (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ ‚Äî –º–æ–∂–Ω–æ —Å—á–∏—Ç—ã–≤–∞—Ç—å –∏–∑ params.baseSlipChance)\n  slip: {\n    base: 0.12,\n    byHookCtrl: -0.04,      // —Ö–æ—Ä–æ—à–∏–µ –∫—Ä—é—á–∫–∏ —É–º–µ–Ω—å—à–∞—é—Ç —Å—Ä—ã–≤\n    byHookQ: -0.03,         // –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥—Å–µ—á–∫–∞ —É–º–µ–Ω—å—à–∞–µ—Ç —Å—Ä—ã–≤\n    byMeanRatio: 0.05,      // —Ç—è–∂—ë–ª–∞—è —Ä—ã–±–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ä—ã–≤\n  },\n\n  // –ë–æ–∫–æ–≤–∞—è –ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å: –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è (Start —Å–µ–π—á–∞—Å –º–Ω–æ–∂–∏—Ç –Ω–∞ 0.75)\n  side: {\n    baseFactor: 0.75,\n  }\n};\n\n// –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–∞—Ç.–ø–æ–º–æ—â–Ω–∏–∫–∏\nconst clamp = (x, a, b) => Math.max(a, Math.min(b, x));\nconst pow = Math.pow;\n\n/**\n * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–æ—è.\n * –°–æ–≤–º–µ—Å—Ç–∏–º —Å–æ —Å—Ç–∞—Ä—ã–º –≤—ã–∑–æ–≤–æ–º: calcFightParams(gear, fish, hookQ)\n *\n * –ù–æ–≤—ã–µ –æ–ø—Ü–∏–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):\n *  - opts.tuning  ‚Äî –æ–±—ä–µ–∫—Ç-–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ BASE_TUNING (—á–∞—Å—Ç–∏—á–Ω—ã–π)\n *  - opts.env     ‚Äî { current:0..1, waves:0..1, vegetation:0..1 }\n *  - opts.rigDeltaM ‚Äî |–æ—Å–Ω–∞—Å—Ç–∫–∞ - –ª–æ–∫–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞| –≤ –º–µ—Ç—Ä–∞—Ö; —à—Ç—Ä–∞—Ñ—É–µ—Ç hookQ\n *  - opts.difficulty ‚Äî 0..1 –æ–±—â–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å ¬´—Å–ª–æ–∂–Ω–æ—Å—Ç–∏¬ª (–≤–ª–∏—è–µ—Ç —Å–ª–µ–≥–∫–∞)\n */\nexport function calcFightParams(gear, fish, hookQ, opts = {}) {\n  const T = deepMerge(BASE_TUNING, opts.tuning || {});\n  const env = opts.env || {};\n  const difficulty = clamp(opts.difficulty ?? 0.5, 0, 1);\n\n  // --- –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –¥–µ—Ñ–æ–ª—Ç—ã ---\n  const rodCap  = gear?.rod?.capKg  ?? 1;\n  const lineCap = gear?.line?.capKg ?? 1;\n  const reelBoost = gear?.reel?.pullBoost ?? 1.0;\n  const hookCtrl  = gear?.hook?.control  ?? 1.0;\n\n  const weight = Math.max(0.001, fish?.weightKg ?? 0.5);\n\n  // —á–µ—Ä—Ç—ã –≤–∏–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–ª–∞–ª–∏ –≤ fish.spec –∏–ª–∏ fish.meta)\n  const spec = fish?.spec || fish?.meta || {};\n  const aggression = spec.aggression ?? spec.agg ?? 1.0;   // —Å–∫–æ—Ä–æ—Å—Ç—å/–¥–∞–≤–ª–µ–Ω–∏–µ\n  const burst      = spec.burstiness ?? 1.0;               // –≤–∑—Ä—ã–≤–Ω–æ—Å—Ç—å ‚Üí jerk\n  const endurance  = spec.endurance  ?? 1.0;               // ¬´–¥–æ–ª–≥–æ –Ω–µ —Å–¥–∞—ë—Ç—Å—è¬ª\n  const agility    = spec.agility    ?? 1.0;               // –±–æ–∫–æ–≤—ã–µ –º–∞–Ω—ë–≤—Ä—ã\n\n  // ¬´—Ç—è–∂–µ—Å—Ç—å¬ª –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∞—Å—Ç–µ–π\n  const ratioRod  = weight / rodCap;\n  const ratioLine = weight / lineCap;\n  const meanRatio = (ratioRod + ratioLine) * 0.5;\n\n  // —à—Ç—Ä–∞—Ñ –∑–∞ –ª–∏—à–Ω—é—é –¥–ª–∏–Ω—É –æ—Å–Ω–∞—Å—Ç–∫–∏ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–ª–∏)\n  const rigPenalty = clamp((opts.rigDeltaM ?? 0) * (T.hook?.penaltyPerRigM ?? 0), 0, 0.9);\n  const effHookQ   = clamp((hookQ ?? 0) - rigPenalty, 0, 1);\n\n  // ====== 1) –®–ö–ê–õ–´ –ù–ê–ü–†–Ø–ñ–ï–ù–ò–Ø (–µ–¥/—Å–µ–∫) ======\n  const RATE_AT_1 = 100 / Math.max(0.01, T.tension.fillTimeAt1);\n  const alpha = T.tension.curveAlpha;\n  // –°–¥–µ–ª–∞–µ–º –ª—ë–≥–∫—É—é ¬´—Å–ª–æ–∂–Ω–æ—Å—Ç—å¬ª: –ø—Ä–∏ difficulty‚Üí1 —Ä–æ—Å—Ç —É—Å–∫–æ—Ä—è–µ—Ç—Å—è –Ω–∞ ~10%\n  const diffScale = 1 + 0.1 * (difficulty - 0.5) * 2;\n\n  const rate = (r) => RATE_AT_1 * pow(Math.max(r, 0.01), alpha) * diffScale;\n\n  const rodUp  = rate(ratioRod);\n  const lineUp = rate(ratioLine);\n  const down   = T.tension.downPerSec;\n\n  // ====== 2) –°–ö–û–†–û–°–¢–ò –ü–û –í–û–î–ï (px/s) ======\n  // –≤–ª–∏—è–Ω–∏–µ —Å—Ä–µ–¥—ã\n  const envFishK  = 1 + (env.current ?? 0)*T.env.currentToFish + (env.waves ?? 0)*T.env.wavesToFish;\n  const envPullK  = 1 + (env.vegetation ?? 0)*T.env.vegToPlayer;\n\n  const basePull  = T.speeds.basePull;\n  const baseFish  = T.speeds.baseFish;\n\n  let pullSpeed = basePull\n    * reelBoost\n    * (1 + T.speeds.hookQPullBonus * effHookQ)\n    * envPullK;\n\n  let fishPullSpeed = baseFish\n    * aggression\n    * (1 + T.speeds.heavinessFishBonus * (meanRatio - 1))\n    / Math.max(0.25, hookCtrl)\n    * envFishK;\n\n  pullSpeed     = Math.max(T.speeds.minPull, pullSpeed);\n  fishPullSpeed = Math.max(T.speeds.minFish, fishPullSpeed);\n\n  // –∫—Ä—ã—à–∞: —Ä—ã–±–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ ¬´–Ω–∞–≤—Å–µ–≥–¥–∞¬ª –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ –∏–≥—Ä–æ–∫–∞\n  const fishCap = T.caps.fishCapBase + (1 - effHookQ) * T.caps.fishCapByMiss;\n  fishPullSpeed = Math.min(fishPullSpeed, pullSpeed * fishCap);\n\n  // ====== 3) –û–ö–ù–û –ë–ï–ó –¢–Ø–ì–ò (—Å–µ–∫) ======\n  const escapeLimit = Math.max(\n    2.0, // –Ω–∏–∂–Ω—è—è –∑–∞—â–∏—Ç–∞\n    T.escape.base\n      + T.escape.byHookQ     * effHookQ\n      + T.escape.byHookCtrl  * (hookCtrl - 1)\n      - T.escape.byMeanRatio * (meanRatio - 1)\n      - T.escape.byEndurance * (endurance - 1)\n  );\n\n  // ====== 4) –†–´–í–ö–ò ======\n  const heav = Math.max(0, meanRatio - 0.3); // –∫–∞–∫ —Ä–∞–Ω—å—à–µ\n  const jerkAdd = clamp(\n    T.jerk.baseAdd + Math.min(T.jerk.maxAdd, T.jerk.addPerHeav * heav) * clamp(burst, 0.5, 1.5),\n    2, T.jerk.maxAdd\n  );\n  const jerkChance = clamp(\n    T.jerk.chance * (1 + T.jerk.burstChanceScale * (burst - 1)) * (1 + 0.08 * (meanRatio - 1)),\n    0.05, 0.95\n  );\n\n  // ====== 5) –ë–ê–ó–û–í–´–ô CHANCE –°–†–´–í–ê (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å) ======\n  const baseSlipChance = clamp(\n    (T.slip.base)\n      + T.slip.byHookCtrl  * (hookCtrl - 1)\n      + T.slip.byHookQ     * (effHookQ - 0.5) * 2\n      + T.slip.byMeanRatio * (meanRatio - 1),\n    0.02, 0.45\n  );\n\n  return {\n    // —à–∫–∞–ª—ã –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è\n    rodUp, lineUp, down,\n\n    // –¥–≤–∏–∂–µ–Ω–∏–µ\n    pullSpeed,\n    fishPullSpeed,\n    escapeLimit,\n\n    // —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã\n    ratioRod, ratioLine,\n\n    // —Ä—ã–≤–∫–∏\n    jerk: {\n      add: jerkAdd,\n      minMs: T.jerk.minMs,\n      maxMs: T.jerk.maxMs,\n      chance: jerkChance\n    },\n\n    // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è, –µ—Å–ª–∏ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è (–Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Å–∏—Å—Ç–µ–º–∞–º)\n    sideFactor: (BASE_TUNING.side?.baseFactor ?? 0.75) * clamp(agility, 0.6, 1.4),\n    baseSlipChance,  // –º–æ–∂–Ω–æ –ø—Ä–∏—Å–≤–æ–∏—Ç—å —Å—Ü–µ–Ω–µ: this.baseSlipChance = params.baseSlipChance\n    debug: {\n      meanRatio, effHookQ, rigPenalty, envFishK, envPullK\n    }\n  };\n}\n\n/**\n * –ì–ª—É–±–æ–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ (–ø—Ä–æ—Å—Ç–æ–µ, –¥–ª—è –ø–ª–æ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤/–≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤–∞—Ä–µ–π)\n */\nfunction deepMerge(a, b) {\n  if (!b) return a;\n  const out = {...a};\n  for (const k in b) {\n    if (b[k] && typeof b[k] === 'object' && !Array.isArray(b[k])) {\n      out[k] = deepMerge(a[k] ?? {}, b[k]);\n    } else {\n      out[k] = b[k];\n    }\n  }\n  return out;\n}\n","// src/ui/HBar.js\nexport class HBar {\n  /**\n   * @param {Phaser.Scene} scene\n   * @param {number} xLeft\n   * @param {number} yBottom\n   * @param {number} width\n   * @param {number} height\n   * @param {string} label\n   * @param {{ icon?: string, depth?: number }} [opts]\n   */\n  constructor(scene, xLeft, yBottom, width, height, label, opts = {}) {\n    this.scene = scene;\n    this.x = Math.round(xLeft);\n    this.yBottom = Math.round(yBottom);\n    this.w = Math.round(width);\n    this.h = Math.round(height);\n    this.value = 0;\n    this.enabled = false;\n    this.threshold = 80;\n    this.icon = opts.icon || '';\n    this.depth = opts.depth ?? 706;\n\n    this.colors = {\n      bg: 0x0f1524,\n      border: 0xffffff,\n      fillIdle: 0x9aa0a6,\n      fillSafe: 0x2ecc71,\n      fillDanger: 0xe67e22\n    };\n\n    this.g = scene.add.graphics().setDepth(this.depth);\n\n    // –ü–æ–¥–ø–∏—Å—å –í–ù–£–¢–†–ò –±–∞—Ä–∞ (—Å–ª–µ–≤–∞-—Ü–µ–Ω—Ç—Ä)\n    this.text = scene.add.text(\n      this.x + 10,\n      this.yBottom - this.h / 2,\n      `${this.icon ? this.icon + ' ' : ''}${label}`,\n      {\n        fontFamily: 'Arial, sans-serif',\n        fontSize: '13px',\n        color: '#e8f1ff',\n        fontStyle: 'bold'\n      }\n    ).setOrigin(0, 0.5).setDepth(this.depth + 2);\n\n    this.draw(0);\n  }\n\n  setThreshold(pct){ this.threshold = Phaser.Math.Clamp(pct, 1, 99); this.draw(this.value); }\n  setEnabled(on){ this.enabled = !!on; this.text.setAlpha(this.enabled ? 1 : 0.75); this.draw(this.value); }\n  set(v){ this.value = Phaser.Math.Clamp(v, 0, 100); this.draw(this.value); }\n  setVisible(vis){ this.g.setVisible(vis); this.text.setVisible(vis); }\n  destroy(){ this.g?.destroy(); this.text?.destroy(); }\n\n  draw(v) {\n    const { g, x, yBottom, w, h, threshold } = this;\n    const r = Math.floor(h / 2);\n    const val = Phaser.Math.Clamp(v, 0, 100);\n\n    g.clear();\n\n    // –§–æ–Ω-¬´–ø–∏–ª—é–ª—è¬ª\n    g.fillStyle(this.colors.bg, this.enabled ? 0.85 : 0.6);\n    g.fillRoundedRect(x, yBottom - h, w, h, r);\n    g.lineStyle(2, this.colors.border, this.enabled ? 0.22 : 0.15);\n    g.strokeRoundedRect(x, yBottom - h, w, h, r);\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\n    const fillW = Math.max(2, Math.round(w * (val / 100)));\n    const danger = val >= threshold;\n    const fillColor = this.enabled ? (danger ? this.colors.fillDanger : this.colors.fillSafe) : this.colors.fillIdle;\n    g.fillStyle(fillColor, this.enabled ? 1.0 : 0.7);\n    const fillR = Math.min(r, Math.floor(fillW / 2));\n    g.fillRoundedRect(x, yBottom - h, fillW, h, fillR);\n\n    // –õ—ë–≥–∫–∏–π –≥–ª—è–Ω–µ—Ü\n    const glossH = Math.max(1, Math.floor(h * 0.35));\n    g.fillStyle(0xffffff, this.enabled ? 0.08 : 0.05);\n    g.fillRoundedRect(x, yBottom - h, fillW, glossH, fillR);\n\n    // –ï–¥–≤–∞ –∑–∞–º–µ—Ç–Ω—ã–π –º–∞—Ä–∫–µ—Ä –ø–æ—Ä–æ–≥–∞ (—Ç–æ–ª—å–∫–æ –≤ –±–æ—é)\n    if (this.enabled) {\n      const tx = Math.round(x + w * (threshold / 100));\n      g.lineStyle(1, 0xffffff, 0.28);\n      g.beginPath(); g.moveTo(tx, yBottom - h + 2); g.lineTo(tx, yBottom - 2); g.strokePath();\n    }\n  }\n}\n","// src/ui/BarsDock.js\nimport { HBar } from './HBar.js';\n\nexport class BarsDock {\n  constructor(scene, slots, pullBtnRect) {\n    this.scene = scene;\n    this.slots = slots;\n\n    const gap = 12;\n    const leftX  = slots.xs[4] + slots.SIZE + gap;\n    const rightX = (pullBtnRect?.x ?? scene.scale.width - 16) - (pullBtnRect?.width ?? 0)/2 - gap;\n\n    this.w = Math.max(160, rightX - leftX);\n    this.h = slots.h;\n    this.x = leftX;\n    this.yTop = slots.yTop;\n    this.yBottom = slots.yBottom;\n\n    // —Ñ–æ–Ω –ø–∞–Ω–µ–ª–∏\n    this.bg = scene.add.graphics().setDepth(705);\n    this.bg.fillStyle(0x111522, 0.90);\n    this.bg.fillRoundedRect(this.x, this.yTop, this.w, this.h, 14);\n    this.bg.lineStyle(2, 0xffffff, 0.18);\n    this.bg.strokeRoundedRect(this.x, this.yTop, this.w, this.h, 14);\n\n    // –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≥–µ–æ–º–µ—Ç—Ä–∏—è\n    const pad = 16;\n    const innerX = this.x + pad;\n    const innerRight = this.x + this.w - pad;\n    const innerW = Math.max(60, innerRight - innerX);\n    const barH = 18;\n    const spacing = 14;                // ‚Üê –±–æ–ª—å—à–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ø–æ–ª–æ—Å–∞–º–∏\n    const barsBottom = this.yBottom - pad;\n\n    // –ø–æ–¥–ø–∏—Å—å —Ç–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ –±–∞—Ä–∞: –∏–∫–æ–Ω–∫–∞ + –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç\n    this.rodBar  = new HBar(scene, innerX, barsBottom - (barH + spacing), innerW, barH, '–£–¥–æ—á–∫–∞', { icon: 'üé£', depth: 706 });\n    this.lineBar = new HBar(scene, innerX, barsBottom,                    innerW, barH, '–õ–µ—Å–∫–∞',  { icon: 'üßµ', depth: 706 });\n\n    this.yTopBars = this.yTop;\n  }\n\n  setMode(mode){\n    const active = mode === 'fight';\n    this.bg.setAlpha(active ? 0.90 : 0.55);\n    this.rodBar.setEnabled(active);\n    this.lineBar.setEnabled(active);\n    if (!active) { this.rodBar.set(0); this.lineBar.set(0); }\n  }\n\n  setVisible(v){ this.setMode(v ? 'fight' : 'idle'); } // —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å\n  set(rodVal, lineVal){ this.rodBar.set(rodVal); this.lineBar.set(lineVal); }\n\n  destroy(){ this.bg.destroy(); this.rodBar.destroy(); this.lineBar.destroy(); }\n}\n","// –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è: XP –∑–∞ —Ä—ã–±—É, —É—Ä–æ–≤–Ω–∏, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage\n\nexport class Progress {\n  constructor(scene) {\n    this.scene = scene;\n    this.level = 1;\n    this.xp = 0;        // —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è\n    this.totalXp = 0;   // —Å—É–º–º–∞—Ä–Ω—ã–π XP –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è\n    this.load();\n  }\n\n  // –°–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ XP –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å\n  xpNeeded(level) {\n    // –º—è–≥–∫–∞—è –∫—Ä–∏–≤—É–ª—è: —Ä–∞—Å—Ç—ë—Ç –ø–ª–∞–≤–Ω–æ\n    return Math.floor(5 * Math.pow(level, 1.35));\n  }\n\n  // –ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏\n  static rarityMult(rarity) {\n    if (rarity === 'rare') return 2.0;\n    if (rarity === 'uncommon') return 1.4;\n    return 1.0; // common\n  }\n\n  // –ë–∞–∑–æ–≤—ã–π XP –∑–∞ —Ä—ã–±—É\n  xpForFish(fish) {\n    const w = Math.max(0, fish?.weightKg || 0);\n    const rarity = fish?.species?.rarity || 'common';\n    const base = 5 + 10 * w;                    // –≤–µ—Å —Ä–µ—à–∞–µ—Ç\n    const mult = Progress.rarityMult(rarity);   // —Ä–µ–¥–∫–æ—Å—Ç—å —É–º–Ω–æ–∂–∞–µ—Ç\n    return Math.round(base * mult);\n  }\n\n  // –í—ã–¥–∞—á–∞ XP —Å —É—á—ë—Ç–æ–º ¬´–æ—Ç–ø—É—Å—Ç–∏–ª = x2¬ª\n  grantCatchXP(fish, { released = false } = {}) {\n    const base = this.xpForFish(fish);\n    const gain = released ? base * 2 : base;\n    return this.addXp(gain);\n  }\n\n  // –î–æ–±–∞–≤–∏—Ç—å XP (–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∞–ø—ã)\n  addXp(amount) {\n    let add = Math.max(0, Math.floor(amount || 0));\n    this.totalXp += add;\n\n    let leveled = 0;\n    while (add > 0) {\n      const need = this.xpNeeded(this.level) - this.xp;\n      if (add >= need) {\n        add -= need;\n        this.level += 1;\n        this.xp = 0;\n        leveled += 1;\n      } else {\n        this.xp += add;\n        add = 0;\n      }\n    }\n\n    this.save();\n    return { leveled, level: this.level, xp: this.xp, toNext: this.xpNeeded(this.level) };\n  }\n\n  save() {\n    try {\n      localStorage.setItem('rf.progress', JSON.stringify({\n        level: this.level, xp: this.xp, totalXp: this.totalXp\n      }));\n    } catch (e) {}\n  }\n\n  load() {\n    try {\n      const raw = localStorage.getItem('rf.progress');\n      if (raw) {\n        const o = JSON.parse(raw);\n        this.level = o.level || 1;\n        this.xp = o.xp || 0;\n        this.totalXp = o.totalXp || 0;\n      }\n    } catch (e) {}\n  }\n}\n","// src/ui/GearModal.js\nexport class GearModal {\n  constructor(scene, kind, list, activeId, onPick, onClose) {\n    this.scene = scene;\n    this.kind = kind;\n    this.list = list || [];\n    this.activeId = activeId || null;\n    this.onPick = onPick;\n    this.onClose = onClose;\n    this.killed = false;\n\n    this.depthBase = 2000;\n\n    this.build();\n    this.layout(); // –ø–µ—Ä–≤–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞\n    this.bindResize();\n  }\n\n  build() {\n    const s = this.scene;\n    const W = s.scale.width, H = s.scale.height;\n\n    // –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ\n    this.overlay = s.add.rectangle(0, 0, W, H, 0x000000, 0.6)\n      .setOrigin(0, 0)\n      .setDepth(this.depthBase)\n      .setInteractive();\n\n    // –ø–∞–Ω–µ–ª—å\n    this.panel = s.add.rectangle(0, 0, 560, 380, 0x242a36, 1)\n      .setStrokeStyle(2, 0xffffff, 0.22)\n      .setDepth(this.depthBase + 1);\n\n    // –∑–∞–≥–æ–ª–æ–≤–æ–∫\n    const titleText = ({\n      rod:  '–£–¥–æ—á–∫–∏',\n      reel: '–ö–∞—Ç—É—à–∫–∏',\n      line: '–õ–µ—Å–∫–∏',\n      hook: '–ö—Ä—é—á–∫–∏'\n    })[this.kind] || '–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞';\n\n    this.title = s.add.text(0, 0, titleText, {\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '24px',\n      color: '#ffffff'\n    }).setOrigin(0.5, 0).setDepth(this.depthBase + 2);\n\n    // –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è\n    this.btnClose = s.add.text(0, 0, '‚úï', {\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '22px',\n      color: '#ffffff'\n    }).setOrigin(0.5, 0).setDepth(this.depthBase + 2).setInteractive();\n\n    this.btnClose.on('pointerdown', () => this.close());\n\n    // –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞\n    this.listContainer = s.add.container(0, 0).setDepth(this.depthBase + 2);\n\n    // —Å–æ–∑–¥–∞—ë–º —Å—Ç—Ä–æ–∫–∏ —Å–ø–∏—Å–∫–∞\n    this.rows = [];\n    this.list.forEach((it, i) => {\n      const row = this.buildRow(it);\n      this.rows.push(row);\n      this.listContainer.add([row.bg, row.name, row.sub, row.tick]);\n    });\n  }\n\n  buildRow(it) {\n    const s = this.scene;\n    const rowH = 56;\n\n    // –∑–∞–≥–ª—É—à–µ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Äì —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Å—Ç–∞–≤–∏–º –≤ layout()\n    const cx = 0, cy = 0;\n\n    const bg = s.add.rectangle(cx, cy, 100, rowH, 0x3a4558, 1)\n      .setStrokeStyle(2, 0xffffff, this.activeId === it.id ? 0.35 : 0.18)\n      .setInteractive();\n\n    // hover\n    bg.on('pointerover', () => bg.setFillStyle(0x425066, 1));\n    bg.on('pointerout',  () => bg.setFillStyle(0x3a4558, 1));\n\n    // –≤—ã–±–æ—Ä\n    bg.on('pointerdown', () => {\n      if (this.killed) return;\n      this.pick(it);\n    });\n\n    // –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ª–µ–≤–∞\n    const name = s.add.text(0, 0, it.name || '‚Äî', {\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '18px',\n      color: '#ffffff'\n    }).setOrigin(0, 0.5);\n\n    // –ø–æ–¥–ø–∏—Å—å/—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞\n    const subTxt =\n      this.kind === 'rod'  ? `–ü—Ä–æ—á–Ω–æ—Å—Ç—å: ${it.capKg} –∫–≥` :\n      this.kind === 'line' ? `–ü—Ä–æ—á–Ω–æ—Å—Ç—å: ${it.capKg} –∫–≥` :\n      this.kind === 'reel' ? `–¢—è–≥–∞: ${(it.pullBoost*100).toFixed(0)}%` :\n      this.kind === 'hook' ? `–ö–æ–Ω—Ç—Ä–æ–ª—å: ${(it.control*100).toFixed(0)}%` : '';\n    const sub = s.add.text(0, 0, subTxt, {\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '14px',\n      color: '#d6deea'\n    }).setOrigin(0, 0.5);\n\n    // –æ—Ç–º–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ\n    const tick = s.add.text(0, 0, this.activeId === it.id ? '‚úì' : '', {\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '18px',\n      color: '#7ddc7a'\n    }).setOrigin(1, 0.5);\n\n    return { bg, name, sub, tick, rowH, it };\n  }\n\n  layout() {\n    const s = this.scene;\n    const W = s.scale.width, H = s.scale.height;\n\n    // —Ä–∞–∑–º–µ—Ä—ã –ø–∞–Ω–µ–ª–∏\n    const panelW = Math.min(560, W - 120);\n    const panelH = Math.min(380, H - 160);\n    this.panel.setSize(panelW, panelH);\n    this.panel.setPosition(W / 2, H / 2);\n\n    // –∑–∞–≥–æ–ª–æ–≤–æ–∫\n    this.title.setPosition(this.panel.x, this.panel.y - panelH / 2 + 18);\n\n    // –∫—Ä–µ—Å—Ç–∏–∫\n    this.btnClose.setPosition(this.panel.x + panelW / 2 - 22, this.panel.y - panelH / 2 + 8);\n\n    // –∫–æ–Ω—Ç–µ–Ω—Ç-–∑–æ–Ω–∞\n    const pad = 18;\n    const areaLeft   = this.panel.x - panelW / 2 + pad;\n    const areaTop    = this.panel.y - panelH / 2 + 62;\n    const areaWidth  = panelW - pad * 2;\n    const rowGap     = 8;\n\n    // –≤—ã—Ä–æ–≤–Ω—è—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –ü–û –®–ò–†–ò–ù–ï –ü–ê–ù–ï–õ–ò (–∞ –Ω–µ —ç–∫—Ä–∞–Ω–∞)\n    let y = areaTop;\n    this.rows.forEach(r => {\n      r.bg.setSize(areaWidth, r.rowH);\n      r.bg.setPosition(areaLeft + areaWidth / 2, y + r.rowH / 2);\n\n      // —Ç–µ–∫—Å—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏\n      const textLeft = areaLeft + 14;\n      r.name.setPosition(textLeft, r.bg.y - 8);\n      r.sub.setPosition(textLeft, r.bg.y + 12);\n\n      // –≥–∞–ª–æ—á–∫–∞ —Å–ø—Ä–∞–≤–∞\n      r.tick.setPosition(areaLeft + areaWidth - 12, r.bg.y);\n\n      y += r.rowH + rowGap;\n    });\n\n    // overlay —Ä–∞—Å—Ç—è–Ω—É—Ç—å\n    this.overlay.setSize(W, H);\n  }\n\n  pick(def) {\n    // –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≥–∞–ª–æ—á–∫—É/—Ä–∞–º–∫—É\n    this.rows.forEach(r => {\n      const active = r.it.id === def.id;\n      r.tick.setText(active ? '‚úì' : '');\n      r.bg.setStrokeStyle(2, 0xffffff, active ? 0.35 : 0.18);\n    });\n\n    // –≤—ã–∑–æ–≤ –∫–æ–ª–±—ç–∫–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ\n    try { this.onPick && this.onPick(def); } catch(e){}\n    this.close();\n  }\n\n  bindResize() {\n    this._onResize = () => {\n      if (!this.killed) this.layout();\n    };\n    this.scene.scale.on('resize', this._onResize);\n  }\n\n  close() {\n    if (this.killed) return;\n    this.killed = true;\n\n    // —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –≤—Å—ë\n    [this.overlay, this.panel, this.title, this.btnClose].forEach(g => g && g.destroy());\n    if (this.rows) {\n      this.rows.forEach(r => {\n        r.bg.destroy(); r.name.destroy(); r.sub.destroy(); r.tick.destroy();\n      });\n      this.rows.length = 0;\n    }\n    if (this.listContainer) this.listContainer.destroy(true);\n\n    // —Å–Ω—è—Ç—å —Å–ª—É—à–∞—Ç–µ–ª—å resize\n    if (this._onResize) this.scene.scale.off('resize', this._onResize);\n\n    // —É–≤–µ–¥–æ–º–∏—Ç—å —Å—Ü–µ–Ω—É\n    try { this.onClose && this.onClose(); } catch(e){}\n  }\n}\n\nexport default GearModal;\n","// src/data/gear.js\nexport const GearDB = {\n  rods: [\n    { id: 'rod_wood_1',  name: '–£–¥–æ—á–∫–∞ –¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è', capKg: 1.0 },\n    { id: 'rod_fib_5',   name: '–£–¥–æ—á–∫–∞ –∫–æ–º–ø–æ–∑–∏—Ç–Ω–∞—è', capKg: 5.0 },\n  ],\n  lines: [\n    { id: 'line_old_1',  name: '–õ–µ—Å–∫–∞ —Å—Ç–∞—Ä–∞—è', capKg: 1.0 },\n    { id: 'line_nylon_4',name: '–õ–µ—Å–∫–∞ –Ω–µ–π–ª–æ–Ω–æ–≤–∞—è', capKg: 4.0 },\n  ],\n  reels: [\n    { id: 'reel_rusty', name: '–ö–∞—Ç—É—à–∫–∞ —Ä–∂–∞–≤–∞—è', pullBoost: 0.01 }, // 1% —Å–∏–ª—ã\n    { id: 'reel_pro',   name: '–ö–∞—Ç—É—à–∫–∞ –∫–∞—Ä–ø–æ–≤–∞—è', pullBoost: 1.15 },\n  ],\n  hooks: [\n    { id: 'hook_rusty',  name: '–ö—Ä—é—á–æ–∫ —Ä–∂–∞–≤—ã–π',  control: 1.00 },\n    { id: 'hook_sharp',  name: '–ö—Ä—é—á–æ–∫ –æ—Å—Ç—Ä—ã–π',  control: 1.12 },\n  ],\n  baits: ['bread','worm','corn','fish'],\n};\n\n// src/data/gear.js\nexport function getDefaultGear() {\n  return {\n    rod:  { id:'rod_wood_1',  capKg: 1.0, durability: 100 },\n    line: { id:'line_old_1',  capKg: 1.0, durability: 100 },\n    reel: { id:'reel_rusty',  pullBoost: 1.00 },\n    hook: { id:'hook_rusty',  control: 1.0, count: 5 },\n    bait: 'worm',\n    inv:  { bait: 25 }\n  };\n}\n\n","// ui/Bobber.js\nexport class Bobber {\n  constructor(scene, x, y){\n    this.s = scene;\n    this.c = scene.add.container(x, y).setDepth(805);\n\n    // –ø—Ä–æ—Å—Ç–∞—è ¬´–¥–ª–∏–Ω–Ω–∞—è¬ª —Ñ–æ—Ä–º–∞ –ø–æ–ø–ª–∞–≤–∫–∞ –∏–∑ Graphics\n    const g = scene.add.graphics();\n    g.fillStyle(0xffffff, 1).fillEllipse(0, -8, 10, 20);\n    g.fillStyle(0xff3b3b, 1).fillRect(-2, -18, 4, 8); // ¬´–∞–Ω—Ç–µ–Ω–∫–∞¬ª\n    this.c.add(g);\n\n    this.minStandingDepth = 0.45; // –º ‚Äî –º–µ–ª—å—á–µ —ç—Ç–æ–≥–æ ¬´–ª–æ–∂–∏–º—Å—è¬ª\n    this._tweens = new Set();\n  }\n\n  // —Å–≤–æ–π—Å—Ç–≤–∞, —á—Ç–æ–±—ã tween/–∫–æ–¥ –º–æ–≥ –º–µ–Ω—è—Ç—å x/y\n  get x(){ return this.c.x; } set x(v){ this.c.x = v; }\n  get y(){ return this.c.y; } set y(v){ this.c.y = v; }\n\n  setPosition(x,y){ this.c.setPosition(x,y); }\n\n  setShallow(isShallow){\n    // –ª–µ–≥–∫–∏–π –Ω–∞–∫–ª–æ–Ω, –µ—Å–ª–∏ –º–µ–ª–∫–æ\n    this.c.setRotation(isShallow ? Phaser.Math.DegToRad(70) : 0);\n  }\n\n  // ¬´–ø–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ¬ª –≤ –æ–∂–∏–¥–∞–Ω–∏–∏\n  startIdleBobbing(){\n    this.stopAllTweens();\n    const tw = this.s.tweens.add({\n      targets: this.c,\n      y: { from: this.c.y, to: this.c.y + 6 },\n      duration: 900, yoyo: true, repeat: -1, ease: 'Sine.inOut'\n    });\n    this._tweens.add(tw);\n  }\n\n  // ¬´–ø–æ–∫–ª—ë–≤–∫–∞¬ª ‚Äî –±—ã—Å—Ç—Ä–∞—è —Ç—Ä—è—Å–∫–∞\n  biteShake(){\n    this.stopAllTweens();\n    const tw = this.s.tweens.add({\n      targets: this.c,\n      y: { from: this.c.y, to: this.c.y + 14 },\n      duration: 140, yoyo: true, repeat: 6, ease: 'Sine.inOut',\n      onComplete: () => { this.startIdleBobbing(); }\n    });\n    this._tweens.add(tw);\n  }\n\n  stopAllTweens(){\n    for (const t of this._tweens){ t.remove(); }\n    this._tweens.clear();\n    // –Ω–∞ –≤—Å—è–∫–∏–π ‚Äî —É–±–∏—Ç—å –ª—é–±—ã–µ —á—É–∂–∏–µ —Ç–≤–∏–Ω—ã –ø–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É\n    this.s.tweens.killTweensOf(this.c);\n  }\n\n  destroy(){\n    this.stopAllTweens();\n    this.c.destroy();\n  }\n\n\n\n  // –ø—Ä–æ–∫—Å–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (—Å—Ü–µ–Ω–∞ —á–∏—Ç–∞–µ—Ç bobber.x/y)\n  get x(){ return this.c.x } set x(v){ this.c.x = v }\n  get y(){ return this.c.y } set y(v){ this.c.y = v }\n}\n","// ui/theme.js\nexport const UI = {\n  // –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –º–∞—Å—à—Ç–∞–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞\n  scale(scene){\n    const W = scene.scale.width, H = scene.scale.height;\n    return Phaser.Math.Clamp(Math.min(W/1280, H/720), 0.85, 1.25);\n  },\n  rem(scene, px){ return Math.round(px * UI.scale(scene)); },\n\n  z: {\n    bg: 11100,\n    world: 0,\n    bobber: 5,\n    // –Ω–∏–∑\n    slots: 700,\n    bars: 705,\n    bottomHudBg: 704,\n    // –≤–µ—Ä—Ö\n    levelBadge: 940,\n    keepnet: 950,\n    wallet: 952,\n    sonar: 965,\n    depthBtn: 980,\n    map: 900,\n    modal: 2000,\n    market: 2100\n  },\n\n  color: {\n    panel: 0x111522,\n    panelStroke: { c: 0xffffff, a: 0.18 },\n    tile: 0x2a3348,\n    tileHover: 0x33405a,\n    good: 0x2ecc71,\n    warn: 0xe67e22\n  },\n\n  radius: 14,\n  pad: 16,\n\n  // ===== –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –ª–∞–π–∞—É—Ç–∞ =====\n  layout: {\n    sonar: {\n      anchorX: 150,                   // —è–∫–æ—Ä—å —Å–ª–µ–≤–∞\n      size: { w: 240, h: 150 },       // –≥–∞–±–∞—Ä–∏—Ç—ã –ø–∞–Ω–µ–ª–∏\n      raiseRem: 456,                   // –±—ã–ª–æ 456px ‚Üí —Ç–µ–ø–µ—Ä—å UI.rem(scene, 96)\n      depthAttachGap: 14              // –∑–∞–∑–æ—Ä –º–µ–∂–¥—É –ª–æ–∫–∞—Ç–æ—Ä–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –≥–ª—É–±–∏–Ω—ã\n    },\n    top: {\n      gap: 12,                        // –æ—Ç—Å—Ç—É–ø—ã –≤ —à–∞–ø–∫–µ\n      btnW: 160\n    },\n    pull: {\n      outerPad: 18                    // –æ—Ç—Å—Ç—É–ø –∫–Ω–æ–ø–∫–∏ ¬´–¢—è–Ω—É—Ç—å¬ª –æ—Ç –∫—Ä–∞—ë–≤\n    }\n  }\n};\nexport default UI;\n","// src/ui/ModalHost.js\nexport class ModalHost {\n  constructor(scene, baseDepth = 2000){\n    this.s = scene;\n    this.base = baseDepth;\n    this.stack = [];\n\n    this.root = scene.add.container(0,0)\n      .setDepth(baseDepth)\n      .setScrollFactor(0);\n    this.root.setVisible(false);\n\n    const W = scene.scale.width, H = scene.scale.height;\n\n    // –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π \"–ø—Ä–æ–≥–ª–æ—Ç\" —Å–æ–±—ã—Ç–∏–π\n    const swallow = (pointer, _x, _y, event) => {\n      const e = event || pointer?.event;\n      e?.stopImmediatePropagation?.();\n      e?.stopPropagation?.();\n    };\n\n    // –û–î–ò–ù overlay\nthis.overlay = scene.add.rectangle(0,0,W,H,0x000000,0.6)\n  .setOrigin(0,0)\n  .setScrollFactor(0)\n  .setInteractive()\n  .setDepth(baseDepth);\n\nthis.overlay.on('pointerdown', swallow);\nthis.root.add(this.overlay);\n\n    scene.scale.on('resize', () => {\n      this.overlay.setSize(scene.scale.width, scene.scale.height);\n    });\n  }\n\n  // buildFn(container, api)\n  open(buildFn, depthOffset = 1){\n    this.root.setVisible(true);\n\n    const c = this.s.add.container(0,0); // depth –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ –≤–∞–∂–µ–Ω\n    this.root.add(c);\n\n    let closed = false;\n    let escCb = null;\n\n    const api = {\n      close: () => {\n        if (closed) return;\n        closed = true;\n        this.close(c);\n      },\n      onEsc: (fn) => { escCb = fn; }\n    };\n\n    this.stack.push(c);\n\n    const escOnce = () => {\n      if (closed) return;\n      if (typeof escCb === 'function') escCb();\n      else api.close();\n    };\n    this.s.input.keyboard?.once('keydown-ESC', escOnce);\n\n    buildFn(c, api);\n    return api;\n  }\n\n  close(container){\n    const i = this.stack.indexOf(container);\n    if (i >= 0) this.stack.splice(i,1);\n    container?.destroy();\n    if (this.stack.length === 0) this.root.setVisible(false);\n  }\n\n  destroy(){\n    this.root?.destroy();\n    this.stack.length = 0;\n  }\n}\nexport default ModalHost;\n","export default \"__VITE_ASSET__DqhJ457o__\"","export default \"__VITE_ASSET__BkRAt6Oa__\"","export default \"__VITE_ASSET__DEL0ShIn__\"","export default \"__VITE_ASSET__C9t6QYOo__\"","\n// src/data/locations.js\nconst BG = (name) => new URL(`../assets/bg/${name}.png`, import.meta.url).href;\n// src/locations/locations.js\nexport const LOCATIONS = [\n  {\n    id: 'lake',\n    title: '–û–∑–µ—Ä–æ',\n\n        bgSet: {\n      // dawn:  { key: 'bg_lake_evening', url: BG('bg_lake_evening') }, // –µ—Å–ª–∏ –Ω–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ dawn\n      day:   { key: 'bg_lake_day',     url: BG('bg_lake_day') },\n      // dusk:  { key: 'bg_lake_sunset',  url: BG('bg_lake_sunset') },\n      night: { key: 'bg_lake_night',   url: BG('bg_lake_night') },\n    bgDay:   { key: 'bg_lake_day',     url: BG('bg_lake_day') },\n    bgNight: { key: 'bg_lake_night',   url: BG('bg_lake_night') },\n    bgDawn:  { key: 'bg_lake_evening', url: BG('bg_lake_evening') },\n    bgDusk:  { key: 'bg_lake_sunset',  url: BG('bg_lake_sunset') },\n    },\n\n    depthGrid: { cols: 8, rows: 4, data: [\n      1.2,1.6,2.0,2.8,3.6,3.2,2.0,1.5,\n      1.4,1.8,2.4,3.2,3.8,3.4,2.2,1.6,\n      1.6,2.0,2.6,3.4,3.9,3.5,2.4,1.8,\n      1.0,1.2,1.6,2.2,2.6,2.2,1.6,1.1,\n    ]},\n\n    depthColumns: {\n      cols: 10,\n      profiles: [\n        [[0,3.7],[0.25,2.6],[0.55,1.1],[1,2.6]],\n        [[0.3,4.1],[0.30,2.8],[0.60,2.3],[1,2.6]],\n        [[0.2,3.6],[0.30,2.8],[0.60,3.3],[1,1.6]],\n        [[0,3.5],[0.40,2.6],[0.75,4.8],[1,2.2]],\n        [[0,3.3],[0.50,2.0],[0.80,2.2],[1,3.4]],\n        [[0,2.9],[0.45,2.8],[0.78,3.1],[1,2.3]],\n        [[0,3.0],[0.40,2.4],[0.70,3.7],[1,2.0]],\n        [[0,3.6],[0.35,2.0],[0.65,4.4],[1,2.8]],\n        [[0,2.7],[0.30,2.0],[0.55,2.1],[1,1.6]],\n        [[0,2.7],[0.25,2.6],[0.52,2.0],[1,2.5]],\n      ]\n    },\n\ncastMask: {\n  \"allowedPolys\": [\n    [\n      [\n        0.016,\n        0.644\n      ],\n      [\n        0.174,\n        0.614\n      ],\n      [\n        0.224,\n        0.569\n      ],\n      [\n        0.356,\n        0.554\n      ],\n      [\n        0.591,\n        0.56\n      ],\n      [\n        0.727,\n        0.592\n      ],\n      [\n        1,\n        0.662\n      ],\n      [\n        0.994,\n        0.989\n      ],\n      [\n        0.001,\n        0.977\n      ]\n    ]\n  ],\n  \"blockedPolys\": [\n    [\n      [\n        0.004,\n        0.851\n      ],\n      [\n        0.996,\n        0.831\n      ],\n      [\n        0.993,\n        0.985\n      ],\n      [\n        0,\n        0.98\n      ]\n    ]\n  ]\n},\n\n    // –Ø–í–ù–´–ô —Å–ø–∏—Å–æ–∫ –≤–∏–¥–æ–≤ —ç—Ç–æ–π –ª–æ–∫–∞—Ü–∏–∏ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–±–∏—Ä–∞—Ç—å ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç).\n    // –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞—Ç—å, –æ–Ω –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω –∏–∑ speciesAreas –∏ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–∑ SPAWN_TABLES.\n    fishIds: ['carp', 'perch', 'roach', 'pike'],\n\n    speciesAreas: [\n      {\n        speciesId: 'carp',\n        mult: 1.5,\n        polys: [[[0.047,0.286],[0.067,0.406],[0.09,0.288]]]\n      }\n    ]\n  },\n\n\n\n  {\n    id: 'river',\n    title: '–†–µ–∫–∞',\n    bg: {\n      key: 'bg_river_day',\n      url: new URL('../assets/bg/bg_river_day.png', import.meta.url).href,\n    },\n    depthGrid: {\n      cols: 10, rows: 4,\n      data: [\n        0.8,1.0,1.2,1.6,2.2,2.6,2.2,1.6,1.2,1.0,\n        0.9,1.1,1.4,1.8,2.6,3.0,2.6,1.8,1.4,1.1,\n        1.0,1.2,1.6,2.0,2.8,3.2,2.8,2.0,1.6,1.2,\n        0.8,0.9,1.1,1.4,2.0,2.4,2.0,1.4,1.1,0.9,\n      ]\n    },\n  },\n  {\n    id: 'sea',\n    title: '–ú–æ—Ä–µ',\n    bg: {\n      key: 'bg_sea_day',\n      url: new URL('../assets/bg/bg_sea_day.png', import.meta.url).href,\n    },\n    depthGrid: {\n      cols: 6, rows: 3,\n      data: [\n        1.5,2.0,3.0,6.0,8.0,4.0,\n        2.0,3.5,6.0,9.0,12.0,7.0,\n        1.8,2.5,4.0,7.0,10.0,5.0,\n      ]\n    },\n  },\n];\n","// src/locations/LocationMgr.js\nimport { LOCATIONS } from '../data/locations.js';\n// import { WaterWavePipeline } from '../effects/WaterWavePipeline.js';\n\nexport class LocationMgr {\n  constructor(scene, initialId = 'lake') {\n    this.s = scene;\n    this.current = initialId;\n\n    // BG\n    this.bg = null;                 // –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏\n    this.bgLayers = null;           // { day, night }\n    this.bgWaterLayers = null;      // { day, night }\n    this._veil = null;              // —Ç—ë–º–Ω–∞—è –≤—É–∞–ª—å (—É—Ç—Ä–æ/–≤–µ—á–µ—Ä)\n    this._grade = null;             // —Ü–≤–µ—Ç–æ–≤–æ–π –≥—Ä–∞–¥–∏–Ω–≥ (—Ç—ë–ø–ª—ã–π —Ä–∞—Å—Å–≤–µ—Ç/–∑–∞–∫–∞—Ç)\n\n    // water + FX\n    this._resizeBound = false;\n    this._waterMaskG = null;\n    this._waterGeomMask = null;\n    this._waterPipeline = null;\n    this._waterTime = 0;\n    this._waterFxEnabled = true;\n    // casting mask debug\n    this._maskG = null;\n    this._castMaskEnabled = true;\n\n    // depth debug\n    this._depthDebug = null;\n\n    // water bounds (px)\n    this.waterTop = 0;\n    this.waterBottom = this.s.scale.height;\n    this._waterAreaLockedByScene = false;\n    this._bgTimer = null; // —Å—Ü–µ–Ω–∞ ¬´–∑–∞–ª–æ—á–∏–ª–∞¬ª –≥—Ä–∞–Ω–∏—Ü—ã –≤–æ–¥—ã?\n    this._castUV = { minV: 0, maxV: 1 };\n\n  }\n\n  // ---------------- assets ----------------\n  // –ì—Ä—É–∑–∏–º –¢–û–õ–¨–ö–û day & night (—Å —É–º–Ω—ã–º–∏ —Ñ–æ–ª–±—ç–∫–∞–º–∏).\n  static loadAssets(scene) {\n    for (const loc of LOCATIONS) {\n      const S = loc.bgSet || {};\n      const dayKey   = (S.day?.key)   || loc.bgDay?.key   || loc.bg?.key;\n      const dayUrl   = (S.day?.url)   || loc.bgDay?.url   || loc.bg?.url;\n      const nightKey = (S.night?.key) || loc.bgNight?.key || dayKey;\n      const nightUrl = (S.night?.url) || loc.bgNight?.url || dayUrl;\n\n      if (dayKey && dayUrl)     scene.load.image(dayKey, dayUrl);\n      if (nightKey && nightUrl) scene.load.image(nightKey, nightUrl);\n    }\n    scene.load.on(Phaser.Loader.Events.LOAD_ERROR, (file) =>\n      console.warn('LOAD_ERROR:', file.key, file.src)\n    );\n  }\n\n  // ---------------- background ----------------\n  applyBackground() {\n    const { width: W, height: H } = this.s.scale;\n\n    // cleanup\n    this.bg?.destroy(); this.bg = null;\n    if (this.bgLayers) Object.values(this.bgLayers).forEach(i => i?.destroy());\n    if (this.bgWaterLayers) Object.values(this.bgWaterLayers).forEach(i => i?.destroy());\n    this.bgLayers = {};\n    this.bgWaterLayers = {};\n\n    const loc = this.data || {};\n    const S = loc.bgSet || {};\n    const dayKey   = (S.day?.key)   || loc.bgDay?.key   || loc.bg?.key   || null;\n    const nightKey = (S.night?.key) || loc.bgNight?.key || dayKey        || null;\n    if (!dayKey && !nightKey) return;\n\n    const baseDepth = -300;\n\n    // base\n    if (dayKey) {\n      const imgDay = this.s.add.image(W/2, H/2, dayKey)\n        .setOrigin(0.5).setDepth(baseDepth + 1).setScrollFactor(0).setAlpha(0);\n      this._fitCover(imgDay); this.bgLayers.day = imgDay;\n    }\n    if (nightKey) {\n      const imgNight = this.s.add.image(W/2, H/2, nightKey)\n        .setOrigin(0.5).setDepth(baseDepth + 1).setScrollFactor(0).setAlpha(0);\n      this._fitCover(imgNight); this.bgLayers.night = imgNight;\n    }\n\n    // water (–ø–æ–¥ —à–µ–π–¥–µ—Ä/–º–∞—Å–∫—É)\n    if (dayKey) {\n      const imgDayW = this.s.add.image(W/2, H/2, dayKey)\n        .setOrigin(0.5).setDepth(baseDepth + 1.5).setScrollFactor(0).setAlpha(0);\n      this._fitCover(imgDayW); this.bgWaterLayers.day = imgDayW;\n    }\n    if (nightKey) {\n      const imgNightW = this.s.add.image(W/2, H/2, nightKey)\n        .setOrigin(0.5).setDepth(baseDepth + 1.5).setScrollFactor(0).setAlpha(0);\n      this._fitCover(imgNightW); this.bgWaterLayers.night = imgNightW;\n    }\n\n    // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º day, –∏–Ω–∞—á–µ night\n    (this.bgLayers.day || this.bgLayers.night)?.setAlpha(1);\n    (this.bgWaterLayers.day || this.bgWaterLayers.night)?.setAlpha(1);\n\n    // –ø–æ—Å—Ç-—Å–ª–æ–∏\n    this._veil?.destroy();\n    this._veil = this.s.add.rectangle(0, 0, W, H, 0x000000, 0)\n      .setOrigin(0, 0).setDepth(baseDepth + 2).setScrollFactor(0);\n    this._grade?.destroy();\n    this._grade = this.s.add.rectangle(0, 0, W, H, 0xffffff, 0)\n      .setOrigin(0, 0).setDepth(baseDepth + 2.1).setScrollFactor(0)\n      .setBlendMode(Phaser.BlendModes.MULTIPLY);\n\n    // –≥—Ä–∞–Ω–∏—Ü—ã –≤–æ–¥—ã ‚Üí –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞, –µ—Å–ª–∏ —Å—Ü–µ–Ω–∞ –Ω–µ –∑–∞–¥–∞–ª–∞\n    if (!this._waterAreaLockedByScene) this._resolveWaterAreaFromConfig();\n    // –º–∞—Å–∫–∞ –ø–æ allowedPolys\n    this.setWaterMaskFromCastMask(this.data?.castMask);\n\n    // resize\n    if (!this._resizeBound) {\n      this._resizeBound = true;\n      this.s.scale.on('resize', () => {\n        const w = this.s.scale.width, h = this.s.scale.height;\n        if (this.bgLayers.day)   this._fitCover(this.bgLayers.day);\n        if (this.bgLayers.night) this._fitCover(this.bgLayers.night);\n        if (this.bgWaterLayers.day)   this._fitCover(this.bgWaterLayers.day);\n        if (this.bgWaterLayers.night) this._fitCover(this.bgWaterLayers.night);\n        this._veil?.setSize(w, h);\n        this._grade?.setSize(w, h);\n\n        if (!this._waterAreaLockedByScene) this._resolveWaterAreaFromConfig();\n        this.setWaterMaskFromCastMask(this.data?.castMask);\n        if (this._waterPipeline) this._setU(2, 'uResolution', w, h);\n        if (this._depthDebug?.visible) this.drawDepthDebug(true);\n        if (this._maskG) this.toggleCastMaskDebug(true);\n      });\n      if (!this._bgTimer) {\n  this._bgTimer = this.s.time.addEvent({\n    delay: 1000, loop: true, callback: () => {\n      const info = this.s.timeCycle?.getInfo?.();\n      // phase/t –Ω–∞–º –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã, –Ω–æ –ø–µ—Ä–µ–¥–∞–¥–∏–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏\n      this.setPhaseBlend(info?.phase ?? 'day', info?.t ?? 0);\n    }\n  });\n  // —É–±—Ä–∞—Ç—å —Ç–∞–π–º–µ—Ä –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å—Ü–µ–Ω—ã\n  this.s.events.once(Phaser.Scenes.Events.SHUTDOWN, () => {\n    this._bgTimer?.remove(); this._bgTimer = null;\n  });\n}\n\n    }\n  }\n\n  // –≤–µ—Ä–Ω—É—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ –∫–æ–Ω—Ñ–∏–≥—É\n  useConfigWaterArea() {\n    this._waterAreaLockedByScene = false;\n    this._resolveWaterAreaFromConfig();\n    this.setWaterMaskFromCastMask(this.data?.castMask);\n  }\n\n  // ---------------- day/night + –≥—Ä–∞–¥–∏–Ω–≥ ----------------\n  setPhaseBlend(phase, t) {\n    if (!this.bgLayers) return;\n\n    const dayImg   = this.bgLayers.day;\n    const nightImg = this.bgLayers.night;\n    if (!dayImg && !nightImg) return;\n\n    // —á–∏—Ç–∞–µ–º —á–∞—Å—ã –∏–∑ timeCycle (0..24), –∏–Ω–∞—á–µ ‚Äî –ø–æ phase\n    const H = this._hourNow(phase, t);\n\n    // –∫–∞—Ä—Ç–∏–Ω–∫–∞: day 06..24, night 00..06\n    const useDay = (H >= 6 && H < 24);\n    dayImg?.setAlpha(0); nightImg?.setAlpha(0);\n    (useDay ? dayImg : nightImg)?.setAlpha(1);\n\n    const dayW = this.bgWaterLayers?.day, nightW = this.bgWaterLayers?.night;\n    dayW?.setAlpha(0); nightW?.setAlpha(0);\n    (useDay ? dayW : nightW)?.setAlpha(1);\n\n    // –≤—É–∞–ª—å –∏ —Ç—ë–ø–ª—ã–π –≥—Ä–∞–¥–∏–Ω–≥ ‚Äî –¢–û–õ–¨–ö–û —Ä–∞—Å—Å–≤–µ—Ç/–∑–∞–∫–∞—Ç\n    const veilA = this._veilAlphaForHour(H);\n    this._veil?.setFillStyle(0x000000, veilA);\n\n    const { color, alpha } = this._gradeColorForHour(H);\n    this._grade?.setFillStyle(color, alpha);\n  }\n  setPhase(p){ this.setPhaseBlend(p, 0); }\n\n  // 0..24\n  _hourNow(phase, t) {\n    const ti = this.s.timeCycle?.getInfo?.();\n    if (ti && typeof ti.pct24 === 'number') {\n      let H = ti.pct24 * 24;\n      H = ((H % 24) + 24) % 24;\n      return H;\n    }\n    // –≥—Ä—É–±—ã–π —Ñ–æ–ª–±—ç–∫, –µ—Å–ª–∏ –Ω–µ—Ç timeCycle.pct24\n    const u = Phaser.Math.Clamp(t ?? 0, 0, 1);\n    if (phase === 'dawn')  return 6 + 3*u;     // 06..09\n    if (phase === 'day')   return 9 + 12*u;    // 09..21\n    if (phase === 'dusk')  return 21 + 3*u;    // 21..24\n    if (phase === 'night') return 0 + 6*u;     // 00..06\n    return 12; // —Å–µ—Ä–µ–¥–∏–Ω–∞ –¥–Ω—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n  }\n\n  // –ª—ë–≥–∫–∞—è —Ç—ë–º–Ω–∞—è –≤—É–∞–ª—å —Ç–æ–ª—å–∫–æ —É—Ç—Ä–æ–º/–≤–µ—á–µ—Ä–æ–º\n  _veilAlphaForHour(H) {\n    const MAX = 0.25; // —Å–∏–ª–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è —Ä–∞—Å—Å–≤–µ—Ç/–∑–∞–∫–∞—Ç\n    if (H >= 6 && H < 9)  return MAX * (1 - (H - 6) / 3); // 06: MAX ‚Üí 09: 0\n    if (H >= 21 && H < 24) return MAX * ((H - 21) / 3);  // 21: 0 ‚Üí 24: MAX\n    return 0; // –¥–Ω—ë–º –∏ –Ω–æ—á—å—é ‚Äî –±–µ–∑ –≤—É–∞–ª–∏\n  }\n\n  // —Ç—ë–ø–ª—ã–π ¬´–æ—Ä–∞–Ω–∂–µ–≤—ã–π¬ª –≥—Ä–∞–¥–∏–Ω–≥ —Ç–æ–ª—å–∫–æ —Ä–∞—Å—Å–≤–µ—Ç/–∑–∞–∫–∞—Ç\n  _gradeColorForHour(H) {\n    const WARM = 0xFFC070; // –º—è–≥–∫–∏–π –æ—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è MULTIPLY\n    if (H >= 6 && H < 9)  return { color: WARM, alpha: 0.18 * (1 - (H - 6) / 3) };\n    if (H >= 21 && H < 24) return { color: WARM, alpha: 0.18 * ((H - 21) / 3) };\n    return { color: 0xffffff, alpha: 0 }; // –¥–Ω—ë–º –∏ –Ω–æ—á—å—é ‚Äî –±–µ–∑ —Ç–æ–Ω–∞\n  }\n\n  // ---------------- shaders & mask ----------------\n  enableWaterFX(opts = {}) {\n    if (!this._waterFxEnabled) return;\n    if (this.s.sys.game.config.renderType !== Phaser.WEBGL) return;\n\n    const pm = this.s.game.renderer?.pipelines; if (!pm) return;\n    let pipe = (typeof pm.get === 'function') ? pm.get('WaterWave') : null;\n    // if (!pipe && typeof pm.add === 'function') {\n    //   pm.add('WaterWave', new WaterWavePipeline(this.s.game));\n    //   pipe = pm.get('WaterWave');\n    // }\n    if (!pipe) return;\n    this._waterPipeline = pipe;\n\n    const { width: W, height: H } = this.s.scale;\n    const { amp=2.0, waveLen=56.0, speed=22.0 } = opts;\n    this._setU(2, 'uResolution', W, H);\n    this._setU(1, 'uAmp', amp);\n    this._setU(1, 'uWaveLen', waveLen);\n    this._setU(1, 'uSpeed', speed);\n    this._setU(1, 'uTime', 0);\n\n    const targets = this.bgWaterLayers ? Object.values(this.bgWaterLayers) : [];\n    targets.forEach(go => go?.setPipeline && go.setPipeline('WaterWave'));\n\n    if (!this._boundUpdate) {\n      this._boundUpdate = (_t, dt) => {\n        this._waterTime += (dt || 0) / 1000;\n        this._setU(1, 'uTime', this._waterTime);\n      };\n      this.s.events.on('update', this._boundUpdate);\n    }\n  }\n  disableWaterFX() {\n    if (!this._waterPipeline) return;\n    const targets = this.bgWaterLayers ? Object.values(this.bgWaterLayers) : [];\n    targets.forEach(go => go?.resetPipeline && go.resetPipeline());\n    this._waterPipeline = null;\n    if (this._boundUpdate) {\n      this.s.events.off('update', this._boundUpdate);\n      this._boundUpdate = null;\n    }\n  }\n\n  _setU(n, name, ...vals) {\n    const p = this._waterPipeline; if (!p) return;\n    const a = p[`setFloat${n}`], b = p[`set${n}f`];\n    if (typeof a === 'function') return a.call(p, name, ...vals);\n    if (typeof b === 'function') return b.call(p, name, ...vals);\n  }\n\n  // —Å—Ü–µ–Ω–∞ –∑–∞–¥–∞—ë—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –≤–æ–¥—ã\n  setWaterArea(topY, bottomY, { lock = true } = {}) {\n    this.waterTop = (topY ?? 0);\n    this.waterBottom = (bottomY ?? this.s.scale.height);\n    if (lock) this._waterAreaLockedByScene = true;\n\n    // uv->xy –º–µ–Ω—è–µ—Ç—Å—è ‚Äî –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –≥–µ–æ–º–∞—Å–∫—É\n    this.setWaterMaskFromCastMask(this.data?.castMask);\n\n    if (this._maskG) this.toggleCastMaskDebug(true);\n  }\n\n  _waterBounds() {\n    return { top: this.waterTop ?? 0, shore: this.waterBottom ?? this.s.scale.height };\n  }\n\n  // —á–∏—Ç–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (–µ—Å–ª–∏ —Å—Ü–µ–Ω–∞ –Ω–µ –∑–∞–ª–æ—á–∏–ª–∞)\n  _resolveWaterAreaFromConfig() {\n    if (this._waterAreaLockedByScene) return;\n    const H = this.s.scale.height;\n    const w = this.data?.water || {};\n    const toPx = (v) => (v <= 1 ? Math.round(v * H) : v|0);\n    const top = (w.top != null) ? toPx(w.top) : 0;\n    const bottom = (w.bottom != null) ? toPx(w.bottom) : H;\n    this.setWaterArea(top, bottom, { lock: true });\n  }\n\n  _uvToXY(u, v) {\n    const W = this.s.scale.width;\n    const { top, shore } = this._waterBounds();\n    const Hwater = Math.max(1, shore - top);\n    return { x: u * W, y: top + v * Hwater };\n  }\n\n  _buildWaterMaskFromAllowed(allowedPolys) {\n    this._waterMaskG?.destroy(); this._waterGeomMask = null;\n    const g = this._waterMaskG = this.s.add.graphics().setScrollFactor(0).setDepth(-9999).setVisible(false);\n    g.clear(); g.fillStyle(0xffffff, 1);\n\n    const polys = (Array.isArray(allowedPolys) && allowedPolys.length)\n      ? allowedPolys : [[[0,0],[1,0],[1,1],[0,1]]];\n\n    for (const poly of polys) {\n      if (!poly || poly.length < 3) continue;\n      const p0 = this._uvToXY(poly[0][0], poly[0][1]);\n      g.beginPath(); g.moveTo(p0.x, p0.y);\n      for (let i=1;i<poly.length;i++){ const p=this._uvToXY(poly[i][0], poly[i][1]); g.lineTo(p.x,p.y); }\n      g.closePath(); g.fillPath();\n    }\n    this._waterGeomMask = new Phaser.Display.Masks.GeometryMask(this.s, g);\n    // --- –≤—ã—á–∏—Å–ª–∏–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–æ–Ω—ã –ø–æ allowedPolys ---\n     let have = false, minV = 1, maxV = 0;\n    if (Array.isArray(allowedPolys) && allowedPolys.length) {\n     for (const poly of allowedPolys) {\n    if (!Array.isArray(poly)) continue;\n    for (const pt of poly) {\n      const v = Array.isArray(pt) ? pt[1] : null;\n      if (typeof v === 'number') {\n        have = true;\n        if (v < minV) minV = v;\n        if (v > maxV) maxV = v;\n      }\n    }\n  }\n}\nthis._castUV = have ? { minV, maxV } : { minV: 0, maxV: 1 };\n\n\n    const targets = this.bgWaterLayers ? Object.values(this.bgWaterLayers) : [];\n    targets.forEach(img => img.setMask(this._waterGeomMask));\n  }\n\n  setWaterMaskFromCastMask(castMask) {\n    this._buildWaterMaskFromAllowed(\n      Array.isArray(castMask?.allowedPolys) ? castMask.allowedPolys : null\n    );\n  }\n\n  // ---------------- casting mask (game logic) ----------------\n  _toUV(x, y) {\n    const W = Math.max(1, this.s.scale.width);\n    const { top, shore } = this._waterBounds();\n    const u = Phaser.Math.Clamp(x / W, 0, 1);\n    const v = Phaser.Math.Clamp((y - top) / Math.max(1, (shore - top)), 0, 1);\n    return { u, v };\n  }\n\n    /**\n   * –ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –≤–¥–æ–ª—å –í–û–î–´ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ (–º–µ–∂–¥—É waterTop –∏ waterBottom).\n   * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0..1, –≥–¥–µ:\n   *  - 0 = —É –±–µ—Ä–µ–≥–∞ (–Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ waterBottom)\n   *  - 1 = ¬´–¥–∞–ª—å—à–µ –æ—Ç –±–µ—Ä–µ–≥–∞¬ª, –≤–µ—Ä—Ö –≤–æ–¥—ã (waterTop)\n   */\n  getShoreDistanceRatio(y) {\n    const { top, shore } = this._waterBounds();\n    const Hwater = Math.max(1, shore - top);\n    const v = Phaser.Math.Clamp((y - top) / Hwater, 0, 1); // 0 –≤–≤–µ—Ä—Ö—É ‚Üí 1 –≤–Ω–∏–∑—É\n    return 1 - v; // ¬´–ø—Ä–∞–≤–µ–µ = –¥–∞–ª—å—à–µ –æ—Ç –±–µ—Ä–µ–≥–∞¬ª\n  }\n  \n\n  /**\n   * –£–¥–æ–±–Ω—ã–π —Ö–µ–ª–ø–µ—Ä –ø—Ä—è–º–æ –¥–ª—è —Ç–æ—á–µ–∫ –ª–æ–∫–∞—Ç–æ—Ä–∞: –≤–µ—Ä–Ω—ë—Ç X –≤–Ω—É—Ç—Ä–∏ —à–∫–∞–ª—ã.\n   * @param {number} y - —ç–∫—Ä–∞–Ω–Ω–∞—è Y –ø–æ–ø–ª–∞–≤–∫–∞\n   * @param {number} left - X –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è —à–∫–∞–ª—ã –ª–æ–∫–∞—Ç–æ—Ä–∞\n   * @param {number} width - —à–∏—Ä–∏–Ω–∞ —à–∫–∞–ª—ã –ª–æ–∫–∞—Ç–æ—Ä–∞\n   */\n  getLocatorXForY(y, left, width) {\n    const r = this.getShoreDistanceRatio(y); // 0..1\n    return left + r * Math.max(0, width);\n  }\n\n/**\n * –ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è \"–¥–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç –±–µ—Ä–µ–≥–∞\" c —É—á—ë—Ç–æ–º –î–û–°–¢–£–ü–ù–û–ô –∑–æ–Ω—ã –∏–∑ castMask.\n * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0..1, –≥–¥–µ 1 = —Å–∞–º–∞—è –¥–∞–ª—å–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è —Ç–æ—á–∫–∞ (–≤–µ—Ä—Ö –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–æ–Ω—ã),\n * 0 = —É –±–µ—Ä–µ–≥–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–æ–Ω—ã.\n */\ngetCastDistanceRatio(y) {\n  const { top, shore } = this._waterBounds();\n  const Hwater = Math.max(1, shore - top);\n  const v = Phaser.Math.Clamp((y - top) / Hwater, 0, 1);\n\n  const { minV = 0, maxV = 1 } = this._castUV || {};\n  const span = Math.max(1e-6, maxV - minV);\n  const vv = Phaser.Math.Clamp(v, minV, maxV);     // —Ä–µ–∂–µ–º –ø–æ –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–æ–Ω–µ\n  return (maxV - vv) / span;                        // 1 = –≤–µ—Ä—Ö –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–æ–Ω—ã ‚Üí –≤–ø—Ä–∞–≤–æ\n}\n\n/** –£–¥–æ–±–Ω—ã–π –º–∞–ø–ø–µ—Ä –¥–ª—è —Å–æ–Ω–∞—Ä–∞ (–µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —Å—Ä–∞–∑—É –≤ –ø–∏–∫—Å–µ–ª–∏ —à–∫–∞–ª—ã) */\n\n  static _pointInPoly(pt, poly) {\n    let inside = false;\n    for (let i = 0, j = poly.length - 1; i < poly.length; j = i++) {\n      const xi = poly[i][0], yi = poly[i][1];\n      const xj = poly[j][0], yj = poly[j][1];\n      const intersect = ((yi > pt.v) !== (yj > pt.v)) &&\n                        (pt.u < (xj - xi) * (pt.v - yi) / ((yj - yi) || 1e-9) + xi);\n      if (intersect) inside = !inside;\n    }\n    return inside;\n  }\n\n  _inAnyPoly(pt, polys = []) {\n    for (const p of polys) {\n      if (Array.isArray(p) && p.length >= 3 && LocationMgr._pointInPoly(pt, p)) return true;\n    }\n    return false;\n  }\n\n  canCastAt(x, y) {\n    const { top, shore } = this._waterBounds();\n    if (y < top || y > shore) return false;\n    if (!this._castMaskEnabled) return true;\n\n    const mask = this.data?.castMask;\n    if (!mask) return true;\n\n    const pt = this._toUV(x, y);\n\n    if (Array.isArray(mask.allowedPolys) || Array.isArray(mask.blockedPolys)) {\n      const hasValidAllowed = mask.allowedPolys?.some(p => Array.isArray(p) && p.length >= 3);\n      if (hasValidAllowed && !this._inAnyPoly(pt, mask.allowedPolys)) return false;\n      const inBlocked = mask.blockedPolys?.length && this._inAnyPoly(pt, mask.blockedPolys);\n      if (inBlocked) return false;\n      return true;\n    }\n\n    if (Array.isArray(mask.polys) && mask.polys.length) {\n      const hasValid = mask.polys.some(p => Array.isArray(p) && p.length >= 3);\n      if (!hasValid) return true;\n      if (mask.mode === 'allow')  return this._inAnyPoly(pt, mask.polys);\n      return !this._inAnyPoly(pt, mask.polys);\n    }\n    return true;\n  }\n\n  setCastMaskEnabled(on = true) { this._castMaskEnabled = !!on; }\n\n  toggleCastMaskDebug(on = true) {\n    if (!on) { this._maskG?.destroy(); this._maskG = null; return; }\n    this._maskG?.destroy();\n    const g = this._maskG = this.s.add.graphics().setDepth(5000);\n    const W = this.s.scale.width;\n    const { top, shore } = this._waterBounds();\n    const Hwater = Math.max(1, shore - top);\n    const toXY = ([u, v]) => ({ x: u * W, y: top + v * Hwater });\n    const draw = (poly, color, alpha) => {\n      const pts = poly.map(toXY);\n      g.fillStyle(color, alpha);\n      g.lineStyle(2, color, 0.9);\n      g.beginPath();\n      g.moveTo(pts[0].x, pts[0].y);\n      for (let i = 1; i < pts.length; i++) g.lineTo(pts[i].x, pts[i].y);\n      g.closePath(); g.fillPath(); g.strokePath();\n    };\n\n    const mask = this.data?.castMask;\n    if (!mask) return;\n    if (Array.isArray(mask.allowedPolys)) mask.allowedPolys.forEach(p => draw(p, 0x00ff88, 0.15));\n    if (Array.isArray(mask.blockedPolys)) mask.blockedPolys.forEach(p => draw(p, 0xff3355, 0.25));\n    if (Array.isArray(mask.polys)) {\n      if (mask.mode === 'allow') mask.polys.forEach(p => draw(p, 0x00ff88, 0.15));\n      else                        mask.polys.forEach(p => draw(p, 0xff3355, 0.25));\n    }\n  }\n\n  // ---------------- depths ----------------\n  _evalProfile(pts, t) {\n    if (!pts?.length) return 0;\n    if (t <= pts[0][0]) return pts[0][1];\n    for (let i = 1; i < pts.length; i++) {\n      if (t <= pts[i][0]) {\n        const [t0, d0] = pts[i - 1], [t1, d1] = pts[i];\n        const u = (t - t0) / Math.max(1e-6, t1 - t0);\n        return d0 + (d1 - d0) * u;\n      }\n    }\n    return pts[pts.length - 1][1];\n  }\n\n  getColumnIndexForX(x) {\n    const cols = this.data?.depthColumns?.cols ?? this.data?.depthGrid?.cols ?? 10;\n    const W = Math.max(1, this.s.scale.width);\n    const u = Phaser.Math.Clamp(x / W, 0, 0.999999);\n    return Math.floor(u * cols);\n  }\n\n  getDepthProfileForColumn(colIdx, samples = 64) {\n    const dc = this.data?.depthColumns;\n    if (dc?.profiles?.length) {\n      const prof = dc.profiles[colIdx] || dc.profiles[colIdx % dc.profiles.length];\n      const depths = new Array(samples);\n      let max = 0;\n      for (let i = 0; i < samples; i++) {\n        const t = (samples === 1) ? 0 : i / (samples - 1);\n        const d = this._evalProfile(prof, t);\n        depths[i] = d; if (d > max) max = d;\n      }\n      return { depths, max };\n    }\n\n    const cols = this.data?.depthGrid?.cols ?? dc?.cols ?? 10;\n    const W = Math.max(1, this.s.scale.width);\n    const x = ((colIdx + 0.5) / cols) * W;\n\n    const { top, shore } = this._waterBounds();\n    const depths = new Array(samples);\n    let max = 0;\n    for (let i = 0; i < samples; i++) {\n      const t = (samples === 1) ? 0 : i / (samples - 1);\n      const y = top + t * (shore - top);\n      const d = this.getDepthAtXY(x, y);\n      depths[i] = d; if (d > max) max = d;\n    }\n    return { depths, max };\n  }\n\n  getDepthAtXY(x, y) {\n    const loc = this.data;\n    if (!loc) return 2;\n\n    const { top, shore } = this._waterBounds();\n    const t = Phaser.Math.Clamp((y - top) / Math.max(1, shore - top), 0, 1);\n\n    const dc = loc.depthColumns;\n    if (dc?.profiles?.length) {\n      const colIdx = this.getColumnIndexForX(x);\n      const prof = dc.profiles[colIdx] || dc.profiles[colIdx % dc.profiles.length];\n      return this._evalProfile(prof, t);\n    }\n\n    const g = loc.depthGrid;\n    if (g?.data && g.cols > 0 && g.rows > 0) {\n      const W = Math.max(1, this.s.scale.width);\n      const u = Phaser.Math.Clamp(x / W, 0, 0.999999);\n      const gx = u * (g.cols - 1);\n      const gy = t * (g.rows - 1);\n\n      const c0 = Math.floor(gx), c1 = Math.min(c0 + 1, g.cols - 1);\n      const r0 = Math.floor(gy), r1 = Math.min(r0 + 1, g.rows - 1);\n      const tx = gx - c0, ty = gy - r0;\n\n      const idx = (r, c) => r * g.cols + c;\n      const d00 = g.data[idx(r0, c0)] ?? 0;\n      const d10 = g.data[idx(r0, c1)] ?? 0;\n      const d01 = g.data[idx(r1, c0)] ?? 0;\n      const d11 = g.data[idx(r1, c1)] ?? 0;\n\n      const d0 = d00 * (1 - tx) + d10 * tx;\n      const d1 = d01 * (1 - tx) + d11 * tx;\n      return d0 * (1 - ty) + d1 * ty;\n    }\n\n    let baseDepth = 2;\n    const bands = loc.depth?.bands;\n    if (bands?.length) {\n      const W = Math.max(1, this.s.scale.width);\n      const u = Phaser.Math.Clamp(x / W, 0, 0.999999);\n      const band = bands.find(b => u >= b.from && u < b.to) || bands[bands.length - 1];\n      baseDepth = band.m ?? 2;\n    }\n    const yg = loc.depth?.yGradient || { top: 1.25, bottom: 0.75 };\n    const k = Phaser.Math.Linear(yg.top, yg.bottom, t);\n    return baseDepth * k;\n  }\n\n  getDepthAtX(x) {\n    const loc = this.data;\n    if (!loc) return 2;\n\n    const g = loc.depthGrid;\n    if (g?.data && g.cols && g.rows) {\n      const W = Math.max(1, this.s.scale.width);\n      const u = Phaser.Math.Clamp(x / W, 0, 0.999999);\n      const c = Math.floor(u * g.cols);\n      let max = 0;\n      for (let r = 0; r < g.rows; r++) {\n        const d = g.data[r * g.cols + c] ?? 0;\n        if (d > max) max = d;\n      }\n      return max || 2;\n    }\n\n    const bands = loc.depth?.bands;\n    if (bands?.length) {\n      const W = Math.max(1, this.s.scale.width);\n      const u = Phaser.Math.Clamp(x / W, 0, 0.999999);\n      const b = bands.find(b => u >= b.from && u < b.to) || bands[bands.length - 1];\n      return b.m ?? 2;\n    }\n    return 2;\n  }\n\n  // ---------------- species area mods ----------------\n  getSpeciesAreaModsAt(x, y) {\n    const areas = this.data?.speciesAreas || [];\n    if (!areas.length) return null;\n    const pt = this._toUV(x, y);\n    const mods = {};\n    for (const a of areas) {\n      if (!a?.polys?.length || !a.speciesId || !a.mult) continue;\n      const hit = a.polys.some(poly => LocationMgr._pointInPoly(pt, poly));\n      if (hit) mods[a.speciesId] = Math.max(mods[a.speciesId] || 1, a.mult);\n    }\n    return Object.keys(mods).length ? { species: mods } : null;\n  }\n\n  // ---------------- common ----------------\n  get data() {\n    return LOCATIONS.find(l => l.id === (this.current || 'lake')) || null;\n  }\n  getCurrentId(){ return this.current; }\n\n  set(id) {\n    if (!LOCATIONS.some(l => l.id === id)) return;\n    this.current = id;\n    this.applyBackground();\n    this.drawDepthDebug(false);\n    this.toggleCastMaskDebug(false);\n    this._bgTimer?.remove(); this._bgTimer = null;\n\n  }\n\n  _fitCover(img) {\n    if (!img) return;\n    const W = this.s.scale.width, H = this.s.scale.height;\n    const k = Math.max(W / img.width, H / img.height);\n    img.setScale(k).setPosition(Math.round(W/2), Math.round(H/2));\n  }\n\n  // –ø—É–±–ª–∏—á–Ω–æ: –≤–µ—Ä—Ö/–Ω–∏–∑ –≤–æ–¥—ã –≤ –ø–∏–∫—Å–µ–ª—è—Ö\n  getWaterArea(){\n    const { top, shore } = this._waterBounds();\n    return { top, bottom: shore };\n  }\n\n  \n}\n\nexport default LocationMgr;\n","// src/data/shopCatalog.js\n// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –º–∞–≥–∞–∑–∏–Ω–∞. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –ø—Ä–∞–≤–æ–∫ –ª–æ–≥–∏–∫–∏.\n// –í–∞–∂–Ω–æ: –ø–æ–ª—è capKg / pullBoost / control / pack –∏ —Ç.–ø. –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏\n// —Å —Ç–≤–æ–∏–º–∏ —Å–ª–æ—Ç–∞–º–∏/–∏–Ω–≤–µ–Ω—Ç–∞—Ä—ë–º. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (desc, rarity, tags, goldPrice)\n// –±–µ–∑–æ–ø–∞—Å–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º.\n\nexport const ShopCatalog = {\n  categories: ['sets', 'rods', 'reels', 'lines', 'hooks', 'bait'],\n\n  // –æ–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–∞–ª–∞–Ω—Å—É/—Ü–µ–Ω–∞–º:\n  // - —Ü–µ–Ω–∞ —Ä–∞—Å—Ç—ë—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ —Å —É—Ä–æ–≤–Ω–µ–º –º–æ—â–Ω–æ—Å—Ç–∏\n  // - capKg/boost/control —Ä–∞—Å—Ç—É—Ç –ø–ª–∞–≤–Ω–æ; —Å–µ—Ç—ã –¥–µ—à–µ–≤–ª–µ —Å—É–º–º—ã —á–∞—Å—Ç–µ–π –Ω–∞ 8‚Äì15%\n  // - —á–∞—Å—Ç—å —Ç–æ–ø–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å goldPrice (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\n  meta: {\n    version: 1,\n    currency: { coins: '–ú–æ–Ω–µ—Ç—ã', gold: '–ó–æ–ª–æ—Ç–æ' },\n  },\n\n  items: {\n    // ================== –°–ï–¢–´ (–∫–æ–º–±–æ —Å –Ω–µ–±–æ–ª—å—à–æ–π —Å–∫–∏–¥–∫–æ–π) ==================\n    sets: [\n      {\n        id: 'set_wood',\n        name: '–ù–∞–±–æ—Ä ¬´–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π¬ª',\n        level: 1,\n        price: 65, // ~ -10% vs —Å—É–º–º–∞\n        rarity: 'common',\n        contains: [\n          { kind: 'rods',  id: 'rod_wood_1'  },\n          { kind: 'reels', id: 'reel_rusty'  },\n          { kind: 'lines', id: 'line_old_1'  },\n          { kind: 'hooks', id: 'hook_rusty'  },\n          { kind: 'bait',  id: 'worm', qty: 25 }\n        ],\n        note: '–ë—é–¥–∂–µ—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Ç',\n        tags: ['starter','budget']\n      },\n      {\n        id: 'set_birch',\n        name: '–ù–∞–±–æ—Ä ¬´–ë–µ—Ä—ë–∑–æ–≤—ã–π¬ª',\n        level: 3,\n        price: 170,\n        rarity: 'common',\n        contains: [\n          { kind: 'rods',  id: 'rod_birch_2'  },\n          { kind: 'reels', id: 'reel_bronze'  },\n          { kind: 'lines', id: 'line_solid_2' },\n          { kind: 'hooks', id: 'hook_bronze'  },\n          { kind: 'bait',  id: 'worm', qty: 25 }\n        ],\n        note: '–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å —Å–Ω–∞—Å—Ç–µ–π',\n        tags: ['balanced']\n      },\n      {\n        id: 'set_pine',\n        name: '–ù–∞–±–æ—Ä ¬´–°–æ—Å–Ω–æ–≤—ã–π¬ª',\n        level: 5,\n        price: 320,\n        rarity: 'uncommon',\n        contains: [\n          { kind: 'rods',  id: 'rod_pine_3'     },\n          { kind: 'reels', id: 'reel_iron'      },\n          { kind: 'lines', id: 'line_braided_3' },\n          { kind: 'hooks', id: 'hook_steel'     },\n          { kind: 'bait',  id: 'worm', qty: 25  }\n        ],\n        note: '–ü—Ä–∏—è—Ç–Ω—ã–π –±—É—Å—Ç –ø–æ —Ç—è–≥–µ –∏ –∑–∞–ø–∞—Å—É –ø—Ä–æ—á–Ω–æ—Å—Ç–∏',\n        tags: ['power']\n      },\n      {\n        id: 'set_ash',\n        name: '–ù–∞–±–æ—Ä ¬´–Ø—Å–µ–Ω—å¬ª',\n        level: 7,\n        price: 520,\n        rarity: 'uncommon',\n        contains: [\n          { kind: 'rods',  id: 'rod_ash_4'        },\n          { kind: 'reels', id: 'reel_steel'       },\n          { kind: 'lines', id: 'line_braided_4'   },\n          { kind: 'hooks', id: 'hook_tempered'    },\n          { kind: 'bait',  id: 'worm_premium', qty: 25 }\n        ],\n        note: '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö —Ç—Ä–æ—Ñ–µ—è—Ö',\n        tags: ['control','midgame']\n      },\n      {\n        id: 'set_maple',\n        name: '–ù–∞–±–æ—Ä ¬´–ö–ª—ë–Ω¬ª',\n        level: 9,\n        price: 760,\n        rarity: 'rare',\n        contains: [\n          { kind: 'rods',  id: 'rod_maple_5'  },\n          { kind: 'reels', id: 'reel_chrome'  },\n          { kind: 'lines', id: 'line_fluoro_5'},\n          { kind: 'hooks', id: 'hook_chrome'  },\n          { kind: 'bait',  id: 'worm_premium', qty: 25 }\n        ],\n        note: '–¢—è–≥–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–ª—è –∫—Ä—É–ø–Ω—è–∫–∞',\n        tags: ['big-fish','control']\n      },\n      {\n        id: 'set_fiberglass',\n        name: '–ù–∞–±–æ—Ä ¬´–°—Ç–µ–∫–ª–æ–ø–ª–∞—Å—Ç–∏–∫¬ª',\n        level: 11,\n        price: 1040,\n        rarity: 'rare',\n        contains: [\n          { kind: 'rods',  id: 'rod_fiber_6'   },\n          { kind: 'reels', id: 'reel_graphite' },\n          { kind: 'lines', id: 'line_fluoro_6' },\n          { kind: 'hooks', id: 'hook_titanium' },\n          { kind: 'bait',  id: 'worm_premium', qty: 25 }\n        ],\n        note: '–õ—ë–≥–∫–æ—Å—Ç—å –∏ –∑–∞–ø–∞—Å –ø–æ –ø—Ä–æ—á–Ω–æ—Å—Ç–∏',\n        tags: ['light','durable']\n      },\n      {\n        id: 'set_carbon',\n        name: '–ù–∞–±–æ—Ä ¬´Carbon Pro¬ª',\n        level: 14,\n        price: 1420,\n        goldPrice: 2, // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å —Ü–µ–Ω—ã –∑–æ–ª–æ—Ç–æ–º\n        rarity: 'epic',\n        contains: [\n          { kind: 'rods',  id: 'rod_carbon_7'    },\n          { kind: 'reels', id: 'reel_carbonpro'  },\n          { kind: 'lines', id: 'line_ultra_7'    },\n          { kind: 'hooks', id: 'hook_titanium_pro' },\n          { kind: 'bait',  id: 'worm_premium', qty: 25 }\n        ],\n        note: '–ú–∞–∫—Å–∏–º—É–º –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ —Ä—ã–≤–∫–∞',\n        tags: ['endgame','premium']\n      },\n    ],\n\n    // ================== –û–¢–î–ï–õ–¨–ù–´–ï –ü–†–ï–î–ú–ï–¢–´ ==================\n    // ---- –£–¥–∏–ª–∏—â–∞ ----\n    rods: [\n      { id:'rod_wood_1',   name:'–î–µ—Ä–µ–≤—è–Ω–Ω–∞—è —É–¥–æ—á–∫–∞', capKg:1.0, level:1,  price:30,  rarity:'common',   set:'–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π', desc:'–ü—Ä–æ—Å—Ç–æ–π, –Ω–æ —Ä–∞–±–æ—á–∏–π —Å—Ç–∞—Ä—Ç' },\n      { id:'rod_birch_2',  name:'–ë–µ—Ä—ë–∑–æ–≤–∞—è —É–¥–æ—á–∫–∞',  capKg:2.4, level:3,  price:90,  rarity:'common',   set:'–ë–µ—Ä—ë–∑–æ–≤—ã–π',  desc:'–ü–æ–ø—Ä–∞–∫—Ç–∏—á–Ω–µ–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π'   },\n      { id:'rod_pine_3',   name:'–°–æ—Å–Ω–æ–≤–∞—è —É–¥–æ—á–∫–∞',   capKg:3.2, level:5,  price:160, rarity:'uncommon', set:'–°–æ—Å–Ω–æ–≤—ã–π',   desc:'–ë–æ–ª—å—à–µ –∑–∞–ø–∞—Å –ø–æ –∫–∞–ø—É'     },\n      { id:'rod_ash_4',    name:'–Ø—Å–µ–Ω–µ–≤–∞—è —É–¥–æ—á–∫–∞',   capKg:4.4, level:7,  price:260, rarity:'uncommon', set:'–Ø—Å–µ–Ω—å',      desc:'–•–æ—Ä–æ—à–æ –¥–µ—Ä–∂–∏—Ç –Ω–∞—Ç—è–∂–µ–Ω–∏–µ'  },\n      { id:'rod_maple_5',  name:'–ö–ª—ë–Ω–æ–≤–∞—è —É–¥–æ—á–∫–∞',   capKg:5.6, level:9,  price:380, rarity:'rare',     set:'–ö–ª—ë–Ω',       desc:'–î–ª—è —Ç—è–∂—ë–ª—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤'  },\n      { id:'rod_fiber_6',  name:'–°—Ç–µ–∫–ª–æ–ø–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è', capKg:7.0, level:11, price:520, rarity:'rare',     set:'–°—Ç–µ–∫–ª–æ–ø–ª–∞—Å—Ç–∏–∫', desc:'–õ—ë–≥–∫–æ –∏ –∫—Ä–µ–ø–∫–æ'       },\n      { id:'rod_carbon_7', name:'Carbon Pro',        capKg:9.0, level:14, price:700, rarity:'epic',     set:'Carbon',     desc:'–¢–æ–ø–æ–≤—ã–π –∫–∞–ø –∏ –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å' },\n    ],\n\n    // ---- –ö–∞—Ç—É—à–∫–∏ ----\n    reels: [\n      { id:'reel_rusty',     name:'–†–∂–∞–≤–∞—è –∫–∞—Ç—É—à–∫–∞',    pullBoost:0.90, level:1,  price:20,  rarity:'common',   set:'–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π',  desc:'–ß—É—Ç—å —Ö—É–∂–µ –±–∞–∑–æ–≤–æ–π —Ç—è–≥–∏' },\n      { id:'reel_bronze',    name:'–ë—Ä–æ–Ω–∑–æ–≤–∞—è –∫–∞—Ç—É—à–∫–∞', pullBoost:1.10, level:3,  price:70,  rarity:'common',   set:'–ë–µ—Ä—ë–∑–æ–≤—ã–π',   desc:'–ü–ª—é—Å –∫ —Ç—è–≥–µ'            },\n      { id:'reel_iron',      name:'–ñ–µ–ª–µ–∑–Ω–∞—è –∫–∞—Ç—É—à–∫–∞',  pullBoost:1.20, level:5,  price:120, rarity:'uncommon', set:'–°–æ—Å–Ω–æ–≤—ã–π',    desc:'–ù–∞–¥—ë–∂–Ω–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞'      },\n      { id:'reel_steel',     name:'–°—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ç—É—à–∫–∞',  pullBoost:1.35, level:7,  price:200, rarity:'uncommon', set:'–Ø—Å–µ–Ω—å',       desc:'–†–æ–≤–Ω–∞—è —Ç—è–≥–∞'            },\n      { id:'reel_chrome',    name:'–•—Ä–æ–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è',     pullBoost:1.50, level:9,  price:300, rarity:'rare',     set:'–ö–ª—ë–Ω',        desc:'–°–æ–ª–∏–¥–Ω—ã–π –±—É—Å—Ç'          },\n      { id:'reel_graphite',  name:'–ì—Ä–∞—Ñ–∏—Ç–æ–≤–∞—è',        pullBoost:1.65, level:11, price:420, rarity:'rare',     set:'–°—Ç–µ–∫–ª–æ–ø–ª–∞—Å—Ç–∏–∫', desc:'–õ—ë–≥–∫–∞—è, —Ç—è–≥–æ–≤–∏—Ç–∞—è'   },\n      { id:'reel_carbonpro', name:'Carbon Pro Spool',  pullBoost:1.85, level:14, price:560, rarity:'epic',     set:'Carbon',      desc:'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç—è–≥–∞'      },\n    ],\n\n    // ---- –õ–µ—Å–∫–∏ ----\n    lines: [\n      { id:'line_old_1',   name:'–°—Ç–∞—Ä–∞—è –ª–µ—Å–∫–∞',      capKg:1.2, level:1,  price:15,  rarity:'common',   set:'–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π',  desc:'–ë–∞–∑–æ–≤—ã–π –∫–∞–ø'       },\n      { id:'line_solid_2', name:'–ü—Ä–æ—á–Ω–∞—è –ª–µ—Å–∫–∞',     capKg:2.1, level:3,  price:55,  rarity:'common',   set:'–ë–µ—Ä—ë–∑–æ–≤—ã–π',   desc:'–ß—É—Ç—å –∫—Ä–µ–ø—á–µ'       },\n      { id:'line_braided_3', name:'–ü–ª–µ—Ç—ë–Ω–∫–∞ –ú–öIII',  capKg:3.0, level:5,  price:95,  rarity:'uncommon', set:'–°–æ—Å–Ω–æ–≤—ã–π',    desc:'–•–æ—Ä–æ—à–æ –¥–µ—Ä–∂–∏—Ç —Ä—ã–≤–∫–∏' },\n      { id:'line_braided_4', name:'–ü–ª–µ—Ç—ë–Ω–∫–∞ –ú–öIV',   capKg:4.0, level:7,  price:150, rarity:'uncommon', set:'–Ø—Å–µ–Ω—å',       desc:'–°–∏–ª—å–Ω–µ–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ' },\n      { id:'line_fluoro_5',  name:'–§–ª—é–æ—Ä–æ–∫–∞—Ä–±–æ–Ω X5', capKg:5.0, level:9,  price:210, rarity:'rare',     set:'–ö–ª—ë–Ω',        desc:'–ò–∑–Ω–æ—Å–æ—Å—Ç–æ–π–∫–∞—è'     },\n      { id:'line_fluoro_6',  name:'–§–ª—é–æ—Ä–æ–∫–∞—Ä–±–æ–Ω X6', capKg:6.2, level:11, price:280, rarity:'rare',     set:'–°—Ç–µ–∫–ª–æ–ø–ª–∞—Å—Ç–∏–∫', desc:'–¢–æ–ø –¥–ª—è —Ç—è–∂—ë–ª—ã—Ö' },\n      { id:'line_ultra_7',   name:'ULTRA Mono 7',    capKg:7.8, level:14, price:360, rarity:'epic',     set:'Carbon',      desc:'–ó–∞–ø–∞—Å –¥–ª—è —Ç—Ä–æ—Ñ–µ–µ–≤' },\n    ],\n\n    // ---- –ö—Ä—é—á–∫–∏ ----\n    hooks: [\n      { id:'hook_rusty',        name:'–†–∂–∞–≤—ã–π –∫—Ä—é—á–æ–∫',       control:0.90, level:1,  price:10, pack:5, rarity:'common',   set:'–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π',  desc:'–°—Ä—ã–≤—ã —Å–ª—É—á–∞—é—Ç—Å—è' },\n      { id:'hook_bronze',       name:'–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫—Ä—é—á–æ–∫',    control:1.10, level:3,  price:35, pack:5, rarity:'common',   set:'–ë–µ—Ä—ë–∑–æ–≤—ã–π',   desc:'–ü–æ–ø–ª–æ—Ç–Ω–µ–µ –¥–µ—Ä–∂–∏—Ç' },\n      { id:'hook_steel',        name:'–°—Ç–∞–ª—å–Ω–æ–π –∫—Ä—é—á–æ–∫',     control:1.20, level:5,  price:60, pack:5, rarity:'uncommon', set:'–°–æ—Å–Ω–æ–≤—ã–π',    desc:'–ß–∞—â–µ –¥–æ—Å–∞–∂–∏–≤–∞–µ—Ç —Ä—ã–±–µ' },\n      { id:'hook_tempered',     name:'–ó–∞–∫–∞–ª—ë–Ω–Ω—ã–π –∫—Ä—é—á–æ–∫',   control:1.30, level:7,  price:85, pack:5, rarity:'uncommon', set:'–Ø—Å–µ–Ω—å',       desc:'–ù–∞–¥—ë–∂–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è' },\n      { id:'hook_chrome',       name:'–•—Ä–æ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫—Ä—é—á–æ–∫',control:1.42, level:9,  price:115,pack:5, rarity:'rare',     set:'–ö–ª—ë–Ω',        desc:'–ú–µ–Ω—å—à–µ —Å—Ö–æ–¥–æ–≤' },\n      { id:'hook_titanium',     name:'–¢–∏—Ç–∞–Ω–æ–≤—ã–π –∫—Ä—é—á–æ–∫',    control:1.55, level:11, price:160,pack:5, rarity:'rare',     set:'–°—Ç–µ–∫–ª–æ–ø–ª–∞—Å—Ç–∏–∫', desc:'–õ–µ–≥–∫–∏–π –∏ –∑–ª–æ–π' },\n      { id:'hook_titanium_pro', name:'Titan Pro Hook',      control:1.70, level:14, price:220,pack:5, rarity:'epic',     set:'Carbon',      desc:'–ü–æ—á—Ç–∏ ¬´–∫–∞–∫ –Ω–∞ –ª–∏–ø—É—á–∫–µ¬ª' },\n    ],\n\n    // ---- –ù–∞–∂–∏–≤–∫–∞ ----\n    // –í–ù–ò–ú–ê–ù–ò–ï: —Å–µ–π—á–∞—Å —É —Ç–µ–±—è –æ—Å–Ω–∞—Å—Ç–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ worm –∏–∑ gear.inv.bait.\n    // –ü–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–≤–ª—è–µ–º –ª–∏—à—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã —á–µ—Ä–≤–µ–π. –û—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∏–¥—ã ‚Äî –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ.\n    bait: [\n      { id:'worm',          name:'–ß–µ—Ä–≤—å (25 —à—Ç.)',           pack:25, level:1, price:15,  rarity:'common',  desc:'–ë–∞–∑–æ–≤–∞—è –Ω–∞–∂–∏–≤–∫–∞' },\n      { id:'worm_premium',  name:'–ß–µ—Ä–≤—å –ø—Ä–µ–º–∏—É–º (25 —à—Ç.)',   pack:25, level:2, price:25,  rarity:'uncommon',desc:'–î–æ–ª—å—à–µ –∂–∏–≤—ë—Ç'    },\n      // –ø—Ä–∏–º–µ—Ä—ã –Ω–∞ –±—É–¥—É—â–µ–µ (–ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ –ª–æ–≥–∏–∫–µ):\n      // { id:'maggot_pack', name:'–û–ø–∞—Ä—ã—à (30 —à—Ç.)', pack:30, level:2, price:22, rarity:'common' },\n      // { id:'leech_pack',  name:'–ü–∏—è–≤–∫–∞ (10 —à—Ç.)', pack:10, level:6, price:50, rarity:'uncommon' },\n    ],\n  },\n};\n\n// ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n// –•–µ–ª–ø–µ—Ä: –º—è–≥–∫–æ –≤–ª–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ GearDB, —á—Ç–æ–±—ã —Å–ª–æ—Ç—ã –∑–Ω–∞–ª–∏ –ø—Ä–æ –Ω–æ–≤—ã–µ id\nexport function ensureCatalogInGearDB(GearDB){\n  const add = (arrName, obj, key='id') => {\n    GearDB[arrName] = GearDB[arrName] || [];\n    const exists = GearDB[arrName].some(x => x[key] === obj[key]);\n    if (!exists) GearDB[arrName].push(obj);\n  };\n\n  // –í —Å–Ω–∞—Ä—è–≥—É –ª—å—ë–º —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ UI —Å–ª–æ—Ç–æ–≤/–º–µ—Ä–¥–∂–∞:\n  for (const r of ShopCatalog.items.rods)   add('rods',  { id:r.id,  name:r.name,  capKg:r.capKg });\n  for (const r of ShopCatalog.items.lines)  add('lines', { id:r.id,  name:r.name,  capKg:r.capKg });\n  for (const r of ShopCatalog.items.hooks)  add('hooks', { id:r.id,  name:r.name,  control:r.control });\n  for (const r of ShopCatalog.items.reels)  add('reels', { id:r.id,  name:r.name,  pullBoost:r.pullBoost });\n}\n\n// (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –º–∏–Ω–∏-—É—Ç–∏–ª–∏—Ç—ã ‚Äî —É–¥–æ–±–Ω–æ –¥–ª—è –±—É–¥—É—â–µ–≥–æ ShopModal:\nexport function getItemById(kind, id){\n  const list = ShopCatalog.items[kind] || [];\n  return list.find(x => x.id === id) || null;\n}\n\nexport function listByCategory(kind){\n  return [...(ShopCatalog.items[kind] || [])];\n}\n","export default \"__VITE_ASSET__BoA4Vnwu__\"","export default \"__VITE_ASSET__NA9pGCoR__\"","export default \"__VITE_ASSET__D9XT9GJn__\"","export default \"__VITE_ASSET__BxwJvv80__\"","export default \"__VITE_ASSET__Bg$56854__\"","export default \"__VITE_ASSET__DOUiErk6__\"","export default \"__VITE_ASSET__wvjWTDZ5__\"","export default \"__VITE_ASSET__7mrTKABJ__\"","export default \"__VITE_ASSET__iQN3AP2D__\"","export default \"__VITE_ASSET__BJPvzjgc__\"","export default \"__VITE_ASSET__sp$TryU7__\"","export default \"__VITE_ASSET__BqGQKkWH__\"","export default \"__VITE_ASSET__Bfd_1YLD__\"","export default \"__VITE_ASSET__B1lVB_P0__\"","export default \"__VITE_ASSET__E8h7vhDP__\"","export default \"__VITE_ASSET__BZLObJXH__\"","export default \"__VITE_ASSET__Cm2CsfNS__\"","// src/assets/PhotoBank.js\n// –ï–î–ò–ù–´–ô —Ñ–æ—Ç–æ–±–∞–Ω–∫: —Ä—ã–±–∞ (src/assets/fish/*.png) –∏ –ª—É—Ç/–º—É—Å–æ—Ä (src/assets/pick/*.png)\n\nimport { SPAWN_TABLES } from '../data/spawnTables.js';\nimport { FishCatalog } from '../data/fish.js';\nimport { LootCatalog } from '../data/loot.js';\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –£—Ç–∏–ª–∏—Ç—ã –∫–∞—Ç–∞–ª–æ–≥–∞\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction _toIdArray(cat) {\n  const arr = Array.isArray(cat?.items) ? cat.items : (Array.isArray(cat) ? cat : []);\n  return arr.map(x => x?.id).filter(Boolean);\n}\nconst FISH_IDS = new Set(_toIdArray(FishCatalog));\nconst PICK_IDS = new Set(_toIdArray(LootCatalog));\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –ü–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞—Ä–∞–Ω–µ–µ (Vite –¥–æ–±–∞–≤–∏—Ç –∏—Ö –≤ –±–∞–Ω–¥–ª –∏ –≤–µ—Ä–Ω—ë—Ç URL)\n// –ö–õ–Æ–ß –í–ê–ñ–ï–ù: —à–∞–±–ª–æ–Ω—ã –ø—É—Ç–µ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –õ–ò–¢–ï–†–ê–õ–ê–ú–ò\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nconst fishFiles = import.meta.glob('./fish/*.png', { eager: true, import: 'default' });\nconst pickFiles = import.meta.glob('./pick/*.png', { eager: true, import: 'default' });\n\nfunction _toNameUrlMap(obj) {\n  const m = new Map();\n  for (const [path, url] of Object.entries(obj)) {\n    const lastSlash = path.lastIndexOf('/') + 1;\n    const name = path.slice(lastSlash, -4); // –∏–º—è —Ñ–∞–π–ª–∞ –±–µ–∑ .png\n    m.set(name, url);\n  }\n  return m;\n}\nconst FISH_URL = _toNameUrlMap(fishFiles);\nconst PICK_URL = _toNameUrlMap(pickFiles);\n\n// –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å id –∏ –¥—Ä—É–≥–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ ‚Äî –∑–∞–ø–æ–ª–Ω–∏ ALIAS\nconst ALIAS = {\n  fish: {\n    // crucian: 'gold-crucian',\n  },\n  pick: {\n    // rusty_can: 'rusty-can',\n  },\n};\n\n// –ö–µ—à–∏: —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ, —á–µ–≥–æ –Ω–µ—Ç/—á—Ç–æ —É–∂–µ –µ—Å—Ç—å\nconst _MISSING = new Set(); // 'fish_crucian', 'pick_rusty_can', ...\nconst _LOADED  = new Set();\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –ë–∞–∑–æ–≤—ã–µ —Ö–µ–ª–ø–µ—Ä—ã\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction key(kind, id) { return `${kind}_${id}`; }\n\n/** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–∑ –±–∞–Ω–¥–ª–∞ –∏–ª–∏ null, –µ—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç */\nfunction file(kind, id) {\n  const name = (ALIAS[kind]?.[id]) ?? id;\n  const url =\n    kind === 'fish' ? FISH_URL.get(name)\n    : kind === 'pick' ? PICK_URL.get(name)\n    : null;\n\n  if (!url) {\n    console.warn('[photo MISSING in bundle]', kind, name);\n    return null;\n  }\n  return url;\n}\n\nfunction idsForLocation(locId) {\n  const table = SPAWN_TABLES?.[locId] || {};\n  const ids = Object.keys(table);\n  return {\n    fish: ids.filter(id => FISH_IDS.has(id)),\n    pick: ids.filter(id => PICK_IDS.has(id)),\n  };\n}\nfunction fishIdsForLocation(locId) { return idsForLocation(locId).fish; }\nfunction pickIdsForLocation(locId) { return idsForLocation(locId).pick; }\n\nfunction _attachLogsOnce(scene) {\n  if (scene._photoBankLogsAttached) return;\n  scene._photoBankLogsAttached = true;\n\n  scene.load.on('filecomplete', (k, type) => {\n    if (type === 'image' && (k.startsWith('fish_') || k.startsWith('pick_'))) {\n      _MISSING.delete(k);\n      _LOADED.add(k);\n      const kind = k.startsWith('fish_') ? 'fish' : 'pick';\n      console.log(`[${kind} photo OK]`, k);\n    }\n  });\n\n  scene.load.on('loaderror', (file) => {\n    const k = file?.key ?? '';\n    if (file?.type === 'image' && (k.startsWith('fish_') || k.startsWith('pick_'))) {\n      _MISSING.add(k);\n      console.warn('[photo LOAD ERROR]', k, file?.src);\n    }\n  });\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –ü—É–±–ª–∏—á–Ω—ã–µ API\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n/**\n * –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å –∑–∞–≥—Ä—É–∑–∫—É –∫–∞—Ä—Ç–∏–Ω–æ–∫ –¥–ª—è –ª–æ–∫–∞—Ü–∏–∏.\n * @param {Phaser.Scene} scene\n * @param {string} locId\n * @param {{fish?:boolean, pick?:boolean}=} opts ‚Äî —Ñ–∏–ª—å—Ç—Ä (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–±–∞ true)\n */\nfunction queueForScene(scene, locId, opts = { fish: true, pick: true }) {\n  const lists = idsForLocation(locId);\n  const doFish = opts.fish !== false;\n  const doPick = opts.pick !== false;\n\n  const oldPath = scene.load.path;\n  scene.load.setPath(''); // –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ–º —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º base path\n\n  let enqFish = 0, enqPick = 0;\n\n  if (doFish) {\n    for (const id of lists.fish) {\n      const k = key('fish', id);\n      if (scene.textures.exists(k) || _LOADED.has(k) || _MISSING.has(k)) continue;\n      const url = file('fish', id);\n      if (!url) { _MISSING.add(k); continue; }\n      scene.load.image(k, url);\n      enqFish++;\n    }\n  }\n\n  if (doPick) {\n    for (const id of lists.pick) {\n      const k = key('pick', id);\n      if (scene.textures.exists(k) || _LOADED.has(k) || _MISSING.has(k)) continue;\n      const url = file('pick', id);\n      if (!url) { _MISSING.add(k); continue; }\n      scene.load.image(k, url);\n      enqPick++;\n    }\n  }\n\n  scene.load.setPath(oldPath);\n  _attachLogsOnce(scene);\n\n  return { fish: enqFish, pick: enqPick };\n}\n\n/**\n * –î–æ–≥—Ä—É–∂–∞–µ—Ç –æ–¥–Ω—É –∫–∞—Ä—Ç–∏–Ω–∫—É –Ω—É–∂–Ω–æ–≥–æ —Ç–∏–ø–∞.\n * @param {Phaser.Scene} scene\n * @param {'fish'|'pick'} kind\n * @param {string} id\n * @returns {Promise<string|null>} –∫–ª—é—á —Ç–µ–∫—Å—Ç—É—Ä—ã –∏–ª–∏ null, –µ—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç\n */\nfunction ensureOne(scene, kind, id) {\n  const k = key(kind, id);\n  if (scene.textures.exists(k)) return Promise.resolve(k);\n  if (_MISSING.has(k))         return Promise.resolve(null);\n\n  const url = file(kind, id);\n  if (!url) { _MISSING.add(k); return Promise.resolve(null); }\n\n  return new Promise((resolve) => {\n    _attachLogsOnce(scene);\n\n    const onDone = (doneKey, type) => {\n      if (doneKey === k && type === 'image') {\n        scene.load.off('filecomplete', onDone);\n        resolve(k);\n      }\n    };\n\n    scene.load.on('filecomplete', onDone);\n    scene.load.image(k, url);\n    scene.load.start();\n  });\n}\n\n// –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º —Å FishPhotos/PickPhotos\nexport default {\n  // –∫–ª—é—á–∏/–ø—É—Ç–∏\n  key, file,\n  keyFor: key,\n  fileFor: file,\n  keyForFish: (id) => key('fish', id),\n  keyForPick: (id) => key('pick', id),\n\n  // –≤—ã–±–æ—Ä –ø–æ –ª–æ–∫–∞—Ü–∏–∏\n  idsForLocation,\n  fishIdsForLocation,\n  pickIdsForLocation,\n\n  // –∑–∞–≥—Ä—É–∑–∫–∞\n  queueForScene,\n  ensureOne,\n};\n","// src/ui/CatchModals.js\nimport PhotoBank from '../assets/PhotoBank.js';\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –•–µ–ª–ø–µ—Ä—ã\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction _fmtKg(n){ return (n ?? 0).toFixed(3) + ' –∫–≥'; }\nfunction _fmtG(n){ return (n ?? 0).toFixed(0) + ' –≥'; }\n\nfunction _drawImage(scene, keyOrFrame, box, depth){\n  if (keyOrFrame && typeof keyOrFrame === 'object'){\n    const { key, frame } = keyOrFrame;\n    if (key && scene.textures?.exists(key)){\n      const im = scene.add.image(box.x, box.y, key, frame ?? undefined).setDepth(depth);\n      const k = Math.min((box.w - 24) / im.width, (box.h - 24) / im.height);\n      im.setScale(k); return im;\n    }\n  }\n  const key = (typeof keyOrFrame === 'string') ? keyOrFrame : null;\n  if (key && scene.textures?.exists(key)){\n    const im = scene.add.image(box.x, box.y, key).setDepth(depth);\n    const k = Math.min((box.w - 24) / im.width, (box.h - 24) / im.height);\n    im.setScale(k); return im;\n  }\n  const g = scene.add.graphics().setDepth(depth);\n  g.lineStyle(2, 0x6bd1ff, 0.9)\n    .strokeRect(box.x - box.w/2 + 8, box.y - box.h/2 + 8, box.w - 16, box.h - 16);\n  const left = box.x - box.w/2 + 16, top = box.y - 6;\n  g.beginPath();\n  for (let i = 0; i < 6; i++){\n    const px = left + i * ((box.w - 32) / 5);\n    const py = top + (i % 2 ? -16 : 16);\n    if (i === 0) g.moveTo(px, py); else g.lineTo(px, py);\n  }\n  g.strokePath();\n  return g;\n}\n\nfunction _statLine(scene, x, y, label, value, depth){\n  const t1 = scene.add.text(x, y, label, {\n    fontFamily:'Arial, sans-serif', fontSize:'15px', color:'#c9d3e7'\n  }).setOrigin(0,0).setDepth(depth);\n  const t2 = scene.add.text(x, y + 18, value, {\n    fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n  }).setOrigin(0,0).setDepth(depth);\n  return [t1, t2];\n}\n\nfunction _badge(scene, x, y, text, color, depth){\n  const w = Math.max(60, Math.round(text.length * 10 + 22)), h = 24;\n  const r = scene.add.rectangle(x, y, w, h, color, 1).setOrigin(0,0.5)\n    .setStrokeStyle(2, 0xffffff, 0.16).setDepth(depth);\n  const t = scene.add.text(x + 10, y, text, {\n    fontFamily:'Arial, sans-serif', fontSize:'13px', color:'#ffffff'\n  }).setOrigin(0,0.5).setDepth(depth + 1);\n  return [r, t];\n}\n\nfunction _triangleBtn(scene, x, y, dir, depth, size){\n  const s = size ?? 40;\n  const r = scene.add.rectangle(x, y, s, s, 0x0f141d, 1)\n    .setStrokeStyle(2, 0xffffff, 0.12)\n    .setDepth(depth).setInteractive({ useHandCursor: true });\n  const g = scene.add.graphics().setDepth(depth + 1);\n  g.lineStyle(2, 0xffffff, 1);\n  const a = Math.round(s * 0.22);\n  g.beginPath();\n  if (dir === 'left'){ g.moveTo(x + 6, y - a); g.lineTo(x - 6, y); g.lineTo(x + 6, y + a); }\n  else               { g.moveTo(x - 6, y - a); g.lineTo(x + 6, y); g.lineTo(x - 6, y + a); }\n  g.strokePath();\n  r.on('pointerover', ()=> r.setFillStyle(0x172033,1));\n  r.on('pointerout',  ()=> r.setFillStyle(0x0f141d,1));\n  return [r, g];\n}\n\nfunction _button(scene, x, y, w, label, color, depth, onClick, disabled=false, opts={}){\n  const h = opts.h ?? 40, fontSize = opts.fontSize ?? 16;\n  const r = scene.add.rectangle(x, y, w, h, color, 1).setOrigin(0.5)\n    .setStrokeStyle(2, 0xffffff, 0.18).setDepth(depth);\n  const t = scene.add.text(x, y, label, {\n    fontFamily:'Arial, sans-serif', fontSize:String(fontSize)+'px', color:'#ffffff'\n  }).setOrigin(0.5).setDepth(depth + 1);\n  if (!disabled){\n    r.setInteractive({ useHandCursor:true })\n      .on('pointerover', ()=> {\n        const c = Phaser.Display.Color.IntegerToColor(color).darken(10).color;\n        r.setFillStyle(c, 1);\n      })\n      .on('pointerout', ()=> r.setFillStyle(color, 1))\n      .on('pointerdown', onClick);\n  } else {\n    r.setFillStyle(0x4b5568,1).disableInteractive(); t.setColor('#c7c7c7');\n  }\n  return [r, t];\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –û–±—â–∏–π —Ä–µ–Ω–¥–µ—Ä –º–æ–¥–∞–ª–∫–∏\n// entry: { title, name, imageKey, badges[], stats[], info?, actions[], onAction(id), onEsc?(), escAction?, closeDelayMs? }\n// idxInfo?: { index,total,onPrev,onNext }\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction _renderEntry(scene, ui, api, entry, idxInfo){\n  const W = scene.scale.width, H = scene.scale.height;\n  const PAD = 18, D = 4300;\n  const cx = (W/2)|0, cy = (H/2)|0;\n\n  const SCALE = 0.66;\n  const PW = Math.min(Math.round(860 * SCALE), W - 80);\n  const PH = Math.min(Math.round(520 * SCALE), H - 80);\n\n  const SZ = {\n    btnW:     Math.max(120, Math.round(180 * SCALE)),\n    btnH:     Math.max(30,  Math.round(40  * SCALE)),\n    btnFont:  Math.max(13,  Math.round(16  * SCALE)),\n    arrow:    Math.max(28,  Math.round(40  * SCALE)),\n    pageFont: Math.max(14,  Math.round(20  * SCALE)),\n  };\n\n  const CLOSE_DELAY_MS = entry.closeDelayMs ?? 0;\n  let canClose = CLOSE_DELAY_MS <= 0;\n  if (!canClose) scene.time.delayedCall(CLOSE_DELAY_MS, ()=> { canClose = true; });\n\n  const tryClose = ()=> { if (!canClose) return; (entry.onEsc ? entry.onEsc() : api.close()); };\n\n  // overlay\n  const overlay = scene.add.rectangle(0,0,W,H,0x000000,0)\n    .setOrigin(0,0).setDepth(D).setScrollFactor(0).setInteractive();\n  // –†–∞–Ω—å—à–µ –±—ã–ª–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ bottom-120px ‚Äî —É–±–∏—Ä–∞–µ–º, —á—Ç–æ–±—ã –≤–µ–∑–¥–µ –≤–Ω–µ –ø–∞–Ω–µ–ª–∏ –∑–∞–∫—Ä—ã–≤–∞–ª–æ\n  overlay.on('pointerdown', () => { if (canClose) tryClose(); });\n\n  // panel (–∫–∞–∫ –±—ã–ª–æ)\n  const shadow = scene.add.rectangle(cx+2, cy+3, PW, PH, 0x000000, 0.22).setDepth(D+1);\n  const panel  = scene.add.rectangle(cx, cy, PW, PH, 0x1f2433, 1)\n    .setStrokeStyle(2, 0xffffff, 0.22).setDepth(D+1).setInteractive();\n  // –í–∞–∂–Ω–æ: –∫–ª–∏–∫–∏ –ø–æ –ø–∞–Ω–µ–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –≤ overlay\n  panel.on('pointerdown', (_, __, ___, e)=> e?.stopPropagation());\n\n    // ...–ø–æ—Å–ª–µ panel.on('pointerdown', ...)\n\n  // –ì–µ–æ–º–µ—Ç—Ä–∏—è –ø–∞–Ω–µ–ª–∏ (–¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–∫–∞)\n  const panelRect = {\n    left:  Math.round(cx - PW/2),\n    right: Math.round(cx + PW/2),\n    top:   Math.round(cy - PH/2),\n    bottom:Math.round(cy + PH/2),\n  };\n  const isInsidePanel = (x, y) =>\n    x >= panelRect.left && x <= panelRect.right && y >= panelRect.top && y <= panelRect.bottom;\n\n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–æ–≤–µ—Ü –∫–ª–∏–∫–∞: –µ—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –í–ù–ï –ø–∞–Ω–µ–ª–∏ ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º (–∫–∞–∫ overlay)\n  const onGlobalPointerDown = (pointer) => {\n    if (!canClose) return;\n    if (!isInsidePanel(pointer.worldX, pointer.worldY)) tryClose();\n  };\n  scene.input.on('pointerdown', onGlobalPointerDown);\n\n  // –°–Ω–∏–º–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏\n  const detach = () => { scene.input.off('pointerdown', onGlobalPointerDown); };\n  // –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –∑–æ–≤—ë—Ç onEsc (–≤ —Ç.—á. Esc/–∫—Ä–µ—Å—Ç–∏–∫/overlay), —Å–Ω–∏–º–µ–º –∏ —Ç–∞–º\n  const prevEsc = entry.onEsc;\n  entry.onEsc = () => { try { detach(); } catch {} ; prevEsc ? prevEsc() : api.close(); };\n  api.onEsc(() => { try { detach(); } catch {} ; tryClose(); });\n\n\n  // title + close (‚úï)\n  const title = scene.add.text(cx, cy - PH/2 + 16, entry.title || '', {\n    fontFamily:'Arial, sans-serif', fontSize:'26px', color:'#ffffff'\n  }).setOrigin(0.5,0).setDepth(D+2);\n\n  const btnClose = scene.add.text(cx + PW/2 - 14, cy - PH/2 + 6, '‚úï', {\n    fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n  })\n    .setOrigin(1,0)\n    .setDepth(D+3)\n    .setInteractive({ useHandCursor:true })\n    // –ù–µ –¥–∞—ë–º –∫–ª–∏–∫—É —É–π—Ç–∏ –≤ panel/overlay, —Å—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–µ–º\n    .on('pointerdown', (pointer, lx, ly, ev) => { ev?.stopPropagation(); tryClose(); });\n\n  ui.add([overlay, shadow, panel, title, btnClose]);\n\n\n  // —Å–µ—Ç–∫–∞\n  const innerTop = title.y + 44;\n  const innerH   = PH - (innerTop - (cy - PH/2)) - 64;\n  const colGap   = 16, leftW = Math.floor((PW - PAD*2 - colGap) * 0.42);\n  const rightW   = PW - PAD*2 - colGap - leftW;\n  const leftX    = cx - PW/2 + PAD + leftW/2;\n  const rightX   = leftX + leftW/2 + colGap + rightW/2;\n\n  const imgBox = { x:leftX, y:Math.round(innerTop + innerH/2) - 8, w:leftW, h:innerH - 12 };\n  const imgFrame = scene.add.rectangle(imgBox.x, imgBox.y, imgBox.w, imgBox.h, 0x0f141d, 1)\n    .setStrokeStyle(2, 0xffffff, 0.12).setDepth(D+2);\n  const imgObj = _drawImage(scene, entry.imageKey, imgBox, D+3);\n  ui.add([imgFrame, imgObj]);\n\n  // –ø–∞–≥–∏–Ω–∞—Ü–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)\n  if (idxInfo && idxInfo.total > 1){\n    const [lR, lG] = _triangleBtn(scene,\n      imgBox.x - imgBox.w/2 + 22, imgBox.y + imgBox.h/2 + 34, 'left', D+3, SZ.arrow);\n    const [rR, rG] = _triangleBtn(scene,\n      imgBox.x + imgBox.w/2 - 22, imgBox.y + imgBox.h/2 + 34, 'right', D+3, SZ.arrow);\n    const pageText = scene.add.text(imgBox.x, imgBox.y + imgBox.h/2 + 34,\n      `${idxInfo.index+1}/${idxInfo.total}`, {\n      fontFamily:'Arial, sans-serif', fontSize:String(SZ.pageFont)+'px', color:'#ffffff'\n    }).setOrigin(0.5).setDepth(D+3);\n    ui.add([lR, lG, rR, rG, pageText]);\n    lR.on('pointerdown', ()=> idxInfo.onPrev && idxInfo.onPrev());\n    rR.on('pointerdown', ()=> idxInfo.onNext && idxInfo.onNext());\n  }\n\n  // –ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å\n  const rFrame = scene.add.rectangle(rightX, imgBox.y, rightW, imgBox.h, 0x0f141d, 1)\n    .setStrokeStyle(2, 0xffffff, 0.12).setDepth(D+2);\n  ui.add(rFrame);\n\n  const rx0 = Math.round(rightX - rightW/2) + 16;\n  let ry = Math.round(imgBox.y - imgBox.h/2) + 10;\n\n  const nameT = scene.add.text(rx0, ry, entry.name || '', {\n    fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n  }).setOrigin(0,0).setDepth(D+3);\n  ui.add(nameT); ry += nameT.height + 6;\n\n  (entry.badges || []).forEach((b, i)=> ui.add(_badge(scene, rx0 + i*130, ry + 12, b.text, b.color, D+3)));\n  if ((entry.badges || []).length) ry += 38;\n\n  (entry.stats || []).forEach(s => { ui.add(_statLine(scene, rx0, ry, s.label, s.value, D+3)); ry += 36; });\n\n// ...–ø–æ—Å–ª–µ –≤—ã–≤–æ–¥–∞ stats\nif (entry.info){\n  const infoStr =\n    (typeof entry.info === 'string')\n      ? entry.info\n      : (entry.info?.bio || entry.info?.text || JSON.stringify(entry.info));\n\n  // –õ–µ–π–±–ª (—Å–µ—Ä—ã–π)\n  const infoLabel = scene.add.text(rx0 - 2, ry + 10, '–û–ø–∏—Å–∞–Ω–∏–µ', {\n    fontFamily: 'Arial, sans-serif',\n    fontSize: '15px',\n    color: '#c9d3e7'\n  })\n  .setOrigin(0, 0)\n  .setDepth(D + 3);\n  ui.add(infoLabel);\n\n  // –ù–µ–±–æ–ª—å—à–æ–π —Å–¥–≤–∏–≥ –≤–ª–µ–≤–æ –¥–ª—è —Å–∞–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞\n  const SHIFT_X = -2; // –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∏–ª—å–Ω–µ–µ/—Å–ª–∞–±–µ–µ ‚Äî –ø–æ–º–µ–Ω—è–π —ç—Ç–æ —á–∏—Å–ª–æ\n  const wrapW = (rightW - 32) + Math.min(0, SHIFT_X); // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∞–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É\n\n  // –û–ø–∏—Å–∞–Ω–∏–µ (—è—Ä–∫–æ –±–µ–ª—ã–π) —Å –ø–µ—Ä–µ–Ω–æ—Å–æ–º\n  const desc = scene.add.text(rx0 + SHIFT_X, infoLabel.y + infoLabel.height + 4, infoStr, {\n    fontFamily: 'Arial, sans-serif',\n    fontSize: '15px',\n    color: '#ffffff',           // –Ω–∞—Å—ã—â–µ–Ω–Ω–æ-–±–µ–ª—ã–π\n    lineSpacing: 2,\n    wordWrap: { width: wrapW, useAdvanced: true }\n  })\n  .setOrigin(0, 0)\n  .setDepth(D + 3);\n\n  // –¥—É–±–ª–∏—Ä—É–µ–º wrap —á–µ—Ä–µ–∑ API (–∏–Ω–æ–≥–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π)\n  desc.setWordWrapWidth(wrapW, true);\n\n  ui.add(desc);\n  ry = desc.y + desc.height + 8;\n}\n\n\n\n  const by = Math.round(cy + PH/2 - Math.max(22, Math.round(SZ.btnH/2) + 6));\n  const GAP = 12;\n  const rightEdge = cx + PW/2 - PAD;\n  const actions = entry.actions || [];\n\n  if (actions.length === 1){\n    const a  = actions[0];\n    const xR = rightEdge - SZ.btnW/2;\n    ui.add(_button(scene, xR, by, SZ.btnW, a.label, a.color ?? 0x3b4662, D+3,\n                   ()=> entry.onAction && entry.onAction(a.id), !!a.disabled,\n                   { h: SZ.btnH, fontSize: SZ.btnFont }));\n  } else if (actions.length >= 2){\n    const aL = actions[0], aR = actions[1];\n    const xR = rightEdge - SZ.btnW/2;\n    const xL = xR - (SZ.btnW + GAP);\n\n    ui.add(_button(scene, xL, by, SZ.btnW, aL.label, aL.color ?? 0x2a9d8f, D+3,\n                   ()=> entry.onAction && entry.onAction(aL.id), !!aL.disabled,\n                   { h: SZ.btnH, fontSize: SZ.btnFont }));\n\n    ui.add(_button(scene, xR, by, SZ.btnW, aR.label, aR.color ?? 0x36425b, D+3,\n                   ()=> entry.onAction && entry.onAction(aR.id), !!aR.disabled,\n                   { h: SZ.btnH, fontSize: SZ.btnFont }));\n  }\n\n  const keyEsc = scene.input.keyboard?.addKey('ESC');\n  keyEsc?.once('down', tryClose);\n  api.onEsc(tryClose);\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ entry\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction _pickInfo(obj){\n  return obj?.info ?? obj?.meta?.info ?? obj?.spec?.info ?? null;\n}\n\nfunction _entryForFish(fish, mode='catch', { keepnetFull=false } = {}){\n  const badges = [];\n  if (fish.isPersonalRecord) badges.push({ text:'–õ–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥', color:0x2a6b3f });\n  if (fish.isWorldRecord)    badges.push({ text:'–ú–∏—Ä–æ–≤–æ–π —Ä–µ–∫–æ—Ä–¥', color:0x7341a9 });\n\n  const stats = [];\n  stats.push({ label:'–í–µ—Å', value:(fish.weightKg != null ? _fmtKg(fish.weightKg) : _fmtG(fish.weightG)) });\n  if (fish.estimatedPrice != null) stats.push({ label:'–û—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è', value:`${fish.estimatedPrice} –º–æ–Ω.` });\n  if (fish.baitName)     stats.push({ label:'–ù–∞–∂–∏–≤–∫–∞',     value: fish.baitName });\n  if (fish.locationName) stats.push({ label:'–ì–¥–µ –ø–æ–π–º–∞–Ω–∞', value: fish.locationName });\n  if (fish.statusText)   stats.push({ label:'–°—Ç–∞—Ç—É—Å',      value: fish.statusText });\n\n  const imageKey =\n    fish.imageKey ||\n    (fish.kind && fish.kind !== 'fish'\n      ? PhotoBank.key('pick', fish.id)\n      : PhotoBank.key('fish', fish.id));\n\n  const info = _pickInfo(fish);\n\n  if (mode === 'catch'){\n    return {\n      title:'–ü–æ–π–º–∞–Ω–∞ —Ä—ã–±–∞!',\n      name: fish.name || '',\n      imageKey, badges, stats, info,\n      actions:[\n        { id:'keep',    label:'–û—Å—Ç–∞–≤–∏—Ç—å (XP)',     color:0x2a9d8f, disabled: keepnetFull },\n        { id:'release', label:'–û—Ç–ø—É—Å—Ç–∏—Ç—å (√ó2 XP)', color:0x36425b }\n      ],\n      escAction:'keep', closeDelayMs:600\n    };\n  }\n  return {\n    title: fish.name || '–°–∞–¥–æ–∫',\n    name: fish.name || '',\n    imageKey, badges, stats, info,\n    actions:[\n      { id:'share',   label:'–•–≤–∞—Å—Ç–∞—Ç—å—Å—è',     color:0x3b4662 },\n      { id:'release', label:'–û—Ç–ø—É—Å—Ç–∏—Ç—å —Ä—ã–±—É', color:0x2a9d8f }\n    ],\n    escAction:'close', closeDelayMs:0\n  };\n}\n\nfunction _entryForLoot(pick, { coins=0 } = {}){\n  const stats = [];\n  if (coins > 0) stats.push({ label:'–ù–∞–≥—Ä–∞–¥–∞', value:`+${coins} –º–æ–Ω–µ—Ç` });\n\n  const imageKey =\n    pick?.tex || pick?.icon || pick?.spriteKey ||\n    (pick?.id ? PhotoBank.key('pick', pick.id) : null);\n\n  const info = _pickInfo(pick);\n\n  return {\n    title: '–£–ª–æ–≤',\n    name: pick?.name ?? '–ù–∞–≥—Ä–∞–¥–∞',\n    imageKey,\n    badges: [],\n    stats,\n    info,\n    actions: [\n      { id:'take', label:(coins>0 ? '–ó–∞–±—Ä–∞—Ç—å' : '–û–∫'), color:0x3b4662 },\n      { id:'drop', label:'–í—ã–±—Ä–æ—Å–∏—Ç—å',                  color:0x2a9d8f }\n    ],\n    escAction: 'take',\n    closeDelayMs: 300\n  };\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –ü—É–±–ª–∏—á–Ω—ã–µ API\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nexport function openFishCatchModal(scene, fish, extra = {}) {\n  return new Promise((resolve) => {\n    // –±–∞–∑–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ (—Å–∞–¥–æ–∫ + —Ç–µ–∫—É—â–∞—è –ø–æ–π–º–∞–Ω–Ω–∞—è)\n    const baseKeepnet = Array.isArray(extra.keepnet)\n      ? extra.keepnet\n      : (Array.isArray(scene.keepnet) ? scene.keepnet : []);\n    const list = baseKeepnet.slice();\n    list.push(fish);\n    let idx = list.length - 1;\n\n    const keepnetFull = !!extra.keepnetFull ||\n      ((scene.keepnet?.length ?? 0) >= (scene.keepnetCap ?? 0));\n\n    scene.modals.open((ui, api) => {\n      let finished = false;\n\n\n      const finish = (v) => {\n        if (finished) return;\n        finished = true;\n        try { ui.iterate?.(c => c.disableInteractive?.()); } catch {}\n        try { resolve(v); } catch {}\n        scene.time.delayedCall(0, () => api.close());\n      };\n\n      const rerender = () => {\n        ui.removeAll?.(true);\n        const cur = list[idx];\n        const isCatch = (idx === list.length - 1);\n        const entry = _entryForFish(cur, isCatch ? 'catch' : 'keepnet', { keepnetFull });\n\n        entry.onAction = (id) => {\n          if (isCatch) {\n            if (id === 'keep') finish('keep');\n            else if (id === 'release') finish('release');\n          } else {\n            if (id === 'share') {\n              scene.showToast?.('–°–∫–æ—Ä–æ: –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Ç—Ä–æ—Ñ–µ–µ–º');\n            } else if (id === 'release') {\n              const removed = baseKeepnet.splice(idx, 1);\n              if (removed.length) {\n                const iLocal = list.indexOf(removed[0]);\n                if (iLocal >= 0) list.splice(iLocal, 1);\n              }\n              if (idx >= list.length) idx = Math.max(0, list.length - 1);\n              scene.keepnet = baseKeepnet;\n              scene.keepnetBadge?.set(baseKeepnet.length, scene.keepnetCap ?? 25);\n              rerender();\n            }\n          }\n        };\n\n        entry.onEsc = () => finish(isCatch ? 'keep' : 'close');\n\n        _renderEntry(scene, ui, api, entry, {\n          index: idx,\n          total: list.length,\n          onPrev: () => { idx = (idx - 1 + list.length) % list.length; rerender(); },\n          onNext: () => { idx = (idx + 1) % list.length; rerender(); }\n        });\n      };\n\n      rerender();\n    });\n  });\n}\n\n\nexport function openKeepnetModal(scene, keepnet, startIndex = 0){\n  const list = Array.isArray(keepnet) ? keepnet : [];\n  let idx = Math.max(0, Math.min(startIndex|0, Math.max(0, list.length-1)));\n\n  return new Promise((resolve) => {\n    scene.modals.open((ui, api) => {\n      let finished = false;\n      const finish = (v) => {\n        if (finished) return; finished = true;\n        try { ui.iterate?.(c => c.disableInteractive?.()); } catch {}\n        resolve(v);\n        scene.time.delayedCall(0, ()=> api.close());\n      };\n\n      const rerender = () => {\n        ui.removeAll?.(true);\n        const fish = list[idx] || {};\n        const e = _entryForFish(fish, 'keepnet');\n\n        e.onAction = (id) => {\n          if (id === 'release'){\n            const removed = list.splice(idx,1);\n            if (removed.length){\n              const orig = scene.keepnet || keepnet;\n              const iGlobal = orig.indexOf(removed[0]);\n              if (iGlobal >= 0) orig.splice(iGlobal,1);\n            }\n            if (!list.length){ finish({ action:'release', index: idx }); return; }\n            if (idx >= list.length) idx = list.length - 1;\n            scene.keepnetBadge?.set(list.length, scene.keepnetCap ?? 25);\n            rerender();\n          } else if (id === 'share'){\n            scene.showToast?.('–°–∫–æ—Ä–æ: –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Ç—Ä–æ—Ñ–µ–µ–º');\n          }\n        };\n        e.onEsc = () => finish({ action:'close', index: idx });\n\n        _renderEntry(scene, ui, api, e, {\n          index: idx,\n          total: list.length,\n          onPrev: () => { idx = (idx - 1 + list.length) % list.length; rerender(); },\n          onNext: () => { idx = (idx + 1) % list.length; rerender(); }\n        });\n      };\n      rerender();\n    });\n  });\n}\n\nexport function openLootModal(scene, pick, { coins = 0 } = {}) {\n  return new Promise((resolve) => {\n    scene.modals.open((ui, api) => {\n      let finished = false;\n\n\n      const finish = (value) => {\n        if (finished) return;\n        finished = true;\n        try { ui.iterate?.(c => c.disableInteractive?.()); } catch {}\n        try { resolve(value); } catch {}\n        scene.time.delayedCall(0, () => api.close?.());\n      };\n\n      const entry = _entryForLoot(pick, { coins });\n      entry.onAction = (id) => { if (id === 'take' || id === 'drop') finish(id); };\n      entry.onEsc = () => finish(entry.escAction || 'take');\n\n      ui.removeAll?.(true);\n      _renderEntry(scene, ui, api, entry, null);\n    });\n  });\n}\n\n\n\n","// src/ui/KeepnetBadge.js\nexport class KeepnetBadge {\n  constructor(scene, capacity = 25, onClick = null) {\n    this.scene = scene;\n    this.capacity = capacity;\n    this.count = 0;\n    this.onClick = onClick;\n\n    const W = scene.scale.width;\n    const M = 12;\n\n    this.w = 108; this.h = 64;\n    this.x = W - M - this.w;\n    this.y = M;\n\n    this.bg = scene.add.graphics().setDepth(950);\n    this.bg.fillStyle(0x111522, 0.88);\n    this.bg.fillRoundedRect(this.x, this.y, this.w, this.h, 14);\n    this.bg.lineStyle(2, 0xffffff, 0.18);\n    this.bg.strokeRoundedRect(this.x, this.y, this.w, this.h, 14);\n\n    this.icon = scene.add.text(this.x + 18, this.y + this.h/2, 'üß∫', {\n      fontFamily:'Arial, sans-serif', fontSize:'24px', color:'#ffffff'\n    }).setOrigin(0,0.5).setDepth(951);\n\n    this.label = scene.add.text(this.x + this.w - 14, this.y + this.h/2, '0/25', {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#e8f1ff'\n    }).setOrigin(1,0.5).setDepth(951);\n\n    // –∏–Ω—Ç–µ—Ä–∞–∫—Ç\n    this.zone = scene.add.zone(this.x, this.y, this.w, this.h).setOrigin(0,0)\n      .setDepth(952).setInteractive();\n    if (onClick) this.zone.on('pointerdown', onClick);\n  }\n  // –í src/ui/KeepnetBadge.js ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤–Ω—É—Ç—Ä—å –∫–ª–∞—Å—Å–∞:\nsetPosition(x, y){\n  this.x = x|0; this.y = y|0;\n\n  // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —Ñ–æ–Ω –Ω–∞ –Ω–æ–≤—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö\n  this.bg.clear();\n  this.bg.fillStyle(0x111522, 0.88);\n  this.bg.fillRoundedRect(this.x, this.y, this.w, this.h, 14);\n  this.bg.lineStyle(2, 0xffffff, 0.18);\n  this.bg.strokeRoundedRect(this.x, this.y, this.w, this.h, 14);\n\n  // —Å–¥–≤–∏–Ω—É—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã\n  this.icon.setPosition(this.x + 18, this.y + this.h/2);\n  this.label.setPosition(this.x + this.w - 14, this.y + this.h/2);\n  this.zone.setPosition(this.x, this.y);\n}\n\n\n  set(count, capacity = this.capacity){\n    this.count = count; this.capacity = capacity;\n    this.label.setText(`${count}/${capacity}`);\n  }\n\n  setVisible(v){\n    [this.bg,this.icon,this.label,this.zone].forEach(o=>o.setVisible(v));\n    this.zone.setInteractive(v);\n  }\n\n  setOnClick(fn){\n    this.zone.removeAllListeners(); this.onClick = fn;\n    if (fn) this.zone.on('pointerdown', fn);\n  }\n}\n","// src/ui/ClockHUD.js\nexport class ClockHUD {\n  constructor(scene, timeCycle, opts = {}){\n    this.s = scene; this.tc = timeCycle;\n    this.depth = opts.depth ?? 955;\n\n    this.ringR = opts.ringR ?? 14;\n    this.ringTh = opts.ringTh ?? 4;\n    this.padX = 12; this.padY = 8;\n\n    this.colors = {\n      dawn:  { panel: 0x263148, stroke: 0xffffff, strokeA: 0.18, ring: 0xffc76b, time: '#ffffff', sub: '#ffe6b3', icon:'üåÖ', label:'–†–ê–°–°–í–ï–¢' },\n      day:   { panel: 0x2a3144, stroke: 0xffffff, strokeA: 0.18, ring: 0xffd166, time: '#ffffff', sub: '#a7ffeb', icon:'‚òÄ',  label:'–î–ï–ù–¨'    },\n      dusk:  { panel: 0x23293d, stroke: 0xffffff, strokeA: 0.18, ring: 0xff9d66, time: '#ffffff', sub: '#ffc9a1', icon:'üåÜ', label:'–ó–ê–ö–ê–¢'   },\n      night: { panel: 0x1a1f31, stroke: 0xffffff, strokeA: 0.18, ring: 0x87a6ff, time: '#ffffff', sub: '#cfd8dc', icon:'üåô', label:'–ù–û–ß–¨'    },\n    };\n\n    this.root = this.s.add.container(0,0).setDepth(this.depth);\n    this.gPanel = this.s.add.graphics().setDepth(this.depth); this.root.add(this.gPanel);\n    this.gRing  = this.s.add.graphics().setDepth(this.depth+1); this.root.add(this.gRing);\n\n    this.icon   = this.s.add.text(0,0,'‚òÄ',{ fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff' })\n      .setOrigin(0,0.5).setDepth(this.depth+2);\n    this.timeTxt= this.s.add.text(0,0,'00:00',{ fontFamily:'Arial, sans-serif', fontSize:'20px', color:'#ffffff' })\n      .setOrigin(0,0.5).setDepth(this.depth+2);\n    this.subTxt = this.s.add.text(0,0,'–î–ï–ù–¨',{ fontFamily:'Arial, sans-serif', fontSize:'12px', color:'#a7ffeb' })\n      .setOrigin(0,0.5).setDepth(this.depth+2);\n\n    this.root.add([this.icon,this.timeTxt,this.subTxt]);\n\n    this.lastClock=''; this.lastPhase=null; this.w=180; this.h=40;\n    this._applyStyle('day'); this._layout(); this.update(true);\n    scene.scale.on('resize', () => this._redrawPanel());\n  }\n\n  destroy(){ this.gPanel?.destroy(); this.gRing?.destroy(); this.icon?.destroy(); this.timeTxt?.destroy(); this.subTxt?.destroy(); this.root?.destroy(); }\n  setPosition(x,y){ this.root.setPosition(Math.round(x), Math.round(y)); }\n  getBounds(){ return new Phaser.Geom.Rectangle(this.root.x - this.w/2, this.root.y - this.h/2, this.w, this.h); }\n\n  _applyStyle(phase){\n    const C = this.colors[phase] || this.colors.day;\n    this.curStyle = C;\n    this.icon.setText(C.icon);\n    this.timeTxt.setColor(C.time);\n    this.subTxt.setColor(C.sub);\n    this.subTxt.setText(C.label);\n    this._redrawPanel();\n  }\n  _redrawPanel(){\n    const C = this.curStyle || this.colors.day;\n    const g = this.gPanel; g.clear();\n    g.fillStyle(C.panel, 1); g.lineStyle(2, C.stroke, C.strokeA);\n    g.fillRoundedRect(-this.w/2, -this.h/2, this.w, this.h, 14);\n    g.strokeRoundedRect(-this.w/2, -this.h/2, this.w, this.h, 14);\n  }\n  _layout(){\n    const ringSize = (this.ringR + this.ringTh) * 2;\n    let x = -this.w/2 + this.padX;\n    this.ringX = x + this.ringR + this.ringTh; this.ringY = 0; x += ringSize + 8;\n    this.icon.setPosition(x, 0); x += Math.max(18, this.icon.width) + 8;\n    this.timeTxt.setPosition(x, 0); x += this.timeTxt.width + 10;\n    this.subTxt.setPosition(x, 0);\n\n    const right = this.subTxt.x + this.subTxt.width;\n    const contentW = (right + this.padX) - (-this.w/2);\n    this.w = Math.max(170, Math.ceil(contentW)); this.h = 40;\n    this._redrawPanel();\n  }\n  _drawRing(pct){\n    const C = this.curStyle || this.colors.day;\n    const g = this.gRing; g.clear();\n    g.lineStyle(this.ringTh, 0xffffff, 0.15);\n    g.beginPath(); g.arc(this.ringX, this.ringY, this.ringR, -Math.PI/2, -Math.PI/2 + Math.PI*2, false); g.strokePath();\n    const end = -Math.PI/2 + Math.PI*2 * Phaser.Math.Clamp(pct, 0, 1);\n    g.lineStyle(this.ringTh, C.ring, 1);\n    g.beginPath(); g.arc(this.ringX, this.ringY, this.ringR, -Math.PI/2, end, false); g.strokePath();\n  }\n  update(force=false){\n    if (!this.tc?.getInfo) return;\n    const info = this.tc.getInfo(); // { clock, phase, pct24, ... }\n    if (force || info.clock !== this.lastClock){ this.lastClock = info.clock; this.timeTxt.setText(info.clock); this._layout(); }\n    if (force || info.phase !== this.lastPhase){ this.lastPhase = info.phase; this._applyStyle(info.phase); }\n    this._drawRing(info.pct24);\n  }\n}\n","// –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π HUD ¬´–£—Ä–æ–≤–µ–Ω—å/XP¬ª —Å–ª–µ–≤–∞ —Å–≤–µ—Ä—Ö—É\n\nexport class LevelBadge {\n  constructor(scene, progress) {\n    this.scene = scene;\n    this.progress = progress;\n\n    const M = 12;\n    this.x = M;\n    this.y = M;\n    this.w = 170;\n    this.h = 56;\n\n    this.bg = scene.add.graphics().setDepth(940);\n    this.bg.fillStyle(0x111522, 0.90).fillRoundedRect(this.x, this.y, this.w, this.h, 14);\n    this.bg.lineStyle(2, 0xffffff, 0.18).strokeRoundedRect(this.x, this.y, this.w, this.h, 14);\n\n    this.title = scene.add.text(this.x + 12, this.y + 10, '', {\n      fontFamily: 'Arial, sans-serif', fontSize: '15px', color: '#e8f1ff'\n    }).setDepth(941).setOrigin(0, 0);\n\n    this.bar = scene.add.graphics().setDepth(941);\n\n    this.update();\n  }\n\n// –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ LevelBadge, —Ä—è–¥–æ–º —Å constructor:\nsetProgress(progress){\n  const fallback = {\n    level: 1,\n    xp: 0,\n    xpNeeded: (lvl) => 100,  // –¥–µ—Ñ–æ–ª—Ç, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0\n  };\n  this.progress = (progress && typeof progress.xpNeeded === 'function')\n    ? progress\n    : fallback;\n  return this;\n}\n\n\n  // –í src/ui/LevelBadge.js ‚Äî –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ LevelBadge:\nsetPosition(x, y){\n  this.x = x|0; this.y = y|0;\n\n  // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –±—ç–∫–≥—Ä–∞—É–Ω–¥\n  this.bg.clear();\n  this.bg.fillStyle(0x111522, 0.90).fillRoundedRect(this.x, this.y, this.w, this.h, 14);\n  this.bg.lineStyle(2, 0xffffff, 0.18).strokeRoundedRect(this.x, this.y, this.w, this.h, 14);\n\n  this.title.setPosition(this.x + 12, this.y + 10);\n  this.update(); // –ø–µ—Ä–µ—Ä–∏—Å—É–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å —É—á—ë—Ç–æ–º –Ω–æ–≤—ã—Ö x,y\n}\n\n\nupdate() {\n  const level = this.progress?.level ?? 1;\n  const curRaw = this.progress?.xp ?? 0;\n  const needRaw = (this.progress && typeof this.progress.xpNeeded === 'function')\n    ? this.progress.xpNeeded(level)\n    : 100;\n\n  // –∑–∞—â–∏—Ç–∞ –æ—Ç NaN/0\n  const cur  = Math.max(0, Number(curRaw)  || 0);\n  const need = Math.max(1, Number(needRaw) || 1);\n\n  this.title.setText(`–£—Ä. ${level}  ‚Ä¢  ${cur}/${need} XP`);\n\n  const bx = this.x + 12, by = this.y + 34, bw = this.w - 24, bh = 14;\n  this.bar.clear();\n  this.bar.fillStyle(0x000000, 0.35).fillRoundedRect(bx, by, bw, bh, 8);\n  this.bar.lineStyle(1, 0xffffff, 0.22).strokeRoundedRect(bx, by, bw, bh, 8);\n\n  const fillW = Math.max(0, Math.min(bw, Math.floor((cur / need) * bw)));\n  this.bar.fillStyle(0x5ec27a, 1).fillRoundedRect(bx, by, fillW, bh, 8);\n}\n\n\n  pulse() {\n    this.scene.tweens.add({\n      targets: [this.bg, this.bar, this.title],\n      alpha: { from: 1, to: 0.6 },\n      duration: 200,\n      yoyo: true,\n      repeat: 2,\n      ease: 'Sine.inOut'\n    });\n  }\ngetBounds(){\n  // –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –±–µ–π–¥–∂–∞ —Å–ª–µ–≤–∞ —Å–≤–µ—Ä—Ö—É (—É —Ç–µ–±—è x,y,w,h —É–∂–µ –µ—Å—Ç—å)\n  return new Phaser.Geom.Rectangle(this.x, this.y, this.w, this.h);\n}\n  destroy() {\n    this.bg.destroy(); this.bar.destroy(); this.title.destroy();\n  }\n\n\n\n}\n","// src/ui/DepthSonar.js\nexport class DepthSonar {\n  constructor(scene, { x = 150, y = 118, w = 220, h = 140 } = {}) {\n    this.s = scene;\n    this.size = { w, h };\n    this.pos = { x, y };\n\n    this._fixedY = null;\n\n\n    this.samples = null;\n    this.maxDepth = 0;\n\n    // —Ç–æ—á–∫–∞ –Ω–∞ –æ—Å–∏ –ª–æ–∫–∞—Ç–æ—Ä–∞ (u‚àà[0..1], 0=–±–µ—Ä–µ–≥/–ª–µ–≤–æ, 1=–¥–∞–ª—å/–ø—Ä–∞–≤–æ)\n    this.dotFollowX = false;\n    this.dotXFrac   = 0.82;\n    this._dotXFixed = 0.82;\n\n    // slide\n    this.isCollapsed = false;\n    this._tabW = 22;\n    this._computeSlidePositions();\n\n    // –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–∞–Ω–µ–ª–∏\n    this.c = scene.add.container(this.shownX, y).setDepth(965);\n    this.c.setScrollFactor(0);\n    this.c.input && (this.c.input.alwaysEnabled = true);\n\n    const { w:W, h:H } = this.size;\n    const outer = scene.add.rectangle(0, 0, W, H, 0x10161f, 1)\n      .setStrokeStyle(2, 0x000000, 0.8).setOrigin(0.5);\n    const inner = scene.add.rectangle(0, 0, W - 20, H - 20, 0x183042, 1).setOrigin(0.5);\n\n    this.gProfile = scene.add.graphics().setDepth(966);\n    this.gDot     = scene.add.graphics().setDepth(967);\n\n    this.lblMax = scene.add.text(-W/2 + 18, H/2 - 24, '', {\n      fontFamily: 'Arial, sans-serif', fontSize: '18px', color: '#ffffff', fontStyle: 'bold'\n    }).setOrigin(0, 0.5).setDepth(968);\n\n    // –ª–µ–≤—ã–π ¬´—è–∑—ã—á–æ–∫¬ª\n    const tabX = -W/2 - 8 + this._tabW/2;\n    this.tab = scene.add.rectangle(tabX, 0, this._tabW, 46, 0x243548, 1)\n      .setStrokeStyle(1, 0xffffff, 0.18)\n      .setInteractive({ useHandCursor: true })\n      .on('pointerdown', () => this.toggle());\n    this.arrow = scene.add.text(tabX, 0, '‚óÑ', {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n    }).setOrigin(0.5);\n\n    this.c.add([outer, inner, this.gProfile, this.gDot, this.lblMax, this.tab, this.arrow]);\n\n    // –ø—Ä–∞–≤–∞—è –æ—Ç–∫—Ä—ã–≤–∞–ª–∫–∞ (–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø–∞–Ω–µ–ª—å —Å–ø—Ä—è—Ç–∞–Ω–∞)\n    this._buildRightOpener();\n\n    // –µ–¥–∏–Ω—ã–π —Ä–µ—Å–∞–π–∑\n    this._onResize = () => {\n      if (this.samples) this._drawProfile(); else this._drawIdle();\n      this._computeSlidePositions();\n      this.c.setPosition(this.isCollapsed ? this.hiddenX : this.shownX, this.pos.y);\n      this._placeRightOpener();\n      this._layoutAttached();\n      this._refreshRightOpenerVisibility();\n    };\n    scene.scale.on('resize', this._onResize);\n\n    this._drawIdle();\n\n    this._fightOn = false;\n    this._fishDepth = null;     // —Å–≥–ª–∞–∂–µ–Ω–Ω–∞—è ¬´—Ä—ã–±—å—è¬ª –≥–ª—É–±–∏–Ω–∞ –ø–æ–¥ —Ç–æ—á–∫–æ–π\n    this._fightNoise = Math.random() * Math.PI * 2;\n\n  }\n\n  destroy(){\n    this.s.scale.off('resize', this._onResize);\n    this.c.destroy();\n    this.openBtnR?.destroy();\n    this.openIconR?.destroy();\n  }\n\n  setPosition(x, y) {\n    this.pos = { x, y };\n    this._computeSlidePositions();\n    this.c.setPosition(this.isCollapsed ? this.hiddenX : this.shownX, y);\n    this._placeRightOpener();\n    this._layoutAttached();\n  }\n\n  setDotFollowX(on = true){ this.dotFollowX = !!on; }\n\n  // –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –≤–Ω–µ—à–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª (DepthCtrl) –∫ –Ω–∏–∑—É –ø–∞–Ω–µ–ª–∏\n  attachDepthCtrl(ctrl, gap = 14) {\n    if (!ctrl?.c) return;\n    this._attached = { ctrl, gap };\n    this.c.add(ctrl.c);                      // —Ç–µ–ø–µ—Ä—å –æ–Ω ‚Äî —Ä–µ–±—ë–Ω–æ–∫ –ø–∞–Ω–µ–ª–∏\n    ctrl.c.setDepth(968);\n    ctrl.c.setScrollFactor?.(0);\n    this._layoutAttached();\n  }\n\n  // –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –≤ –∫–æ–ª–æ–Ω–∫–µ –∑–∞–±—Ä–æ—Å–∞, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å X —Ç–æ—á–∫–∏\nshow(castX, castY){\n  const prof = this.s.locationMgr.getDepthProfileForColumn(\n    this.s.locationMgr.getColumnIndexForX(castX), 64\n  );\n  this.samples  = prof.depths;\n  this.maxDepth = prof.max;\n\n  if (castY == null) {\n    const { top, shore } = this.s.locationMgr._waterBounds();\n    castY = Phaser.Math.Clamp(this.s.input.activePointer?.worldY ?? shore, top, shore);\n  }\n  this._fixedY = castY;                 // <‚Äî –∑–∞–ø–æ–º–∏–Ω–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π Y\n  const u0 = this._yToU(castY);\n  this._dotXFixed = u0;                 // –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–∏—è\n  this.dotXFrac   = u0;\n\n  this._drawProfile();\n}\n\n\n  hide(){ this.samples = null; this.maxDepth = 0; this._drawIdle(); }\n\nupdateDot(currentY, opts = {}) {\n  if (!this.samples) return;\n\n  const u = this.dotFollowX ? this._yToU(currentY)\n                            : this._yToU(this._fixedY ?? currentY);\n  this.dotXFrac = u;\n\n  const S = Math.max(1, this.samples.length - 1);\n  const t = 1 - u; // 0 = –¥–∞–ª—å/–ø—Ä–∞–≤–æ, 1 = –±–µ—Ä–µ–≥/–ª–µ–≤–æ\n  const xIdx = Phaser.Math.Clamp(t * S, 0, S);\n  const i0 = Math.floor(xIdx), i1 = Math.min(i0 + 1, S), frac = xIdx - i0;\n  const bottomDepth = this.samples[i0]*(1-frac) + this.samples[i1]*frac;\n\n  const rig = Math.max(0, this.s.rigDepthM ?? 0);\n  const baitDepth = Math.min(rig, bottomDepth);\n\n// --- –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è ¬´–∂–∏–∑–Ω—å¬ª –≤ –±–æ—é ---\nlet dotDepth = baitDepth;\nif (this._fightOn) {\n  const tension = Phaser.Math.Clamp(opts.tension ?? 0, 0, 1);\n  const reeling = !!opts.reeling;\n\n  this._fightNoise += 0.035 + 0.02 * tension;\n  const noiseAmp = (0.08 + 0.12 * tension) * bottomDepth; // 8‚Äì20% –æ—Ç –¥–Ω–∞\n  const noise = Math.sin(this._fightNoise) * noiseAmp;\n\n  const diveFactor = (reeling ? 0.25 : 0.8);\n  const wantDive = diveFactor * tension * bottomDepth;\n\n  const target = Phaser.Math.Clamp(baitDepth + wantDive + noise, 0, bottomDepth);\n\n  if (this._fishDepth == null) this._fishDepth = baitDepth;\n  this._fishDepth = Phaser.Math.Linear(this._fishDepth, target, 0.08);\n\n  dotDepth = this._fishDepth;\n}\n\n  // ------------------------------------\n\n  const { w, h } = this.size, pad = 18;\n  const L = -w/2 + pad, T = -h/2 + pad, VW = w - pad*2, VH = h - pad*2;\n  const range = Math.max(0.1, this.maxDepth * 1.1);\n\n  const mx = Math.round(L + u * VW) + 0.5;\n  const my = Math.round(T + (dotDepth / range) * VH) + 0.5; // <<< —Ç—É—Ç dotDepth\n\n  this.gDot.clear();\n  this.gDot.lineStyle(1, 0xffffff, 0.18).beginPath();\n  this.gDot.moveTo(L, my); this.gDot.lineTo(L + VW, my); this.gDot.strokePath();\n  this.gDot.fillStyle(0xff3b3b, 1).fillCircle(mx, my, 3);\n\n  // –ª—ë–≥–∫–∏–π X-–¥—Ä–µ–π—Ñ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º X\n  if (this._fightOn && !this.dotFollowX && (opts.allowXDrift ?? false)) {\n    const drift = (0.003 + 0.01 * (opts.tension ?? 0)) * Math.sin(this._fightNoise * 0.5);\n    this._dotXFixed = Phaser.Math.Clamp(this._dotXFixed + drift, 0, 1);\n  }\n}\n\n  \n  //—É—Ö–æ–¥–∏—Ç –Ω–∞ –≥–ª—É–±–∏–Ω—É \n  setFight(on = true){\n  this._fightOn = !!on;\n  this._fishDepth = null;              // –ø–µ—Ä–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–º—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ/—Å—Ç–æ–ø–µ\n  this._fightNoise = Math.random() * Math.PI * 2;\n}\n\nisFightOn(){ return this._fightOn; }\n\n\n  // --- internal ---\n_yToU(y){\n  const lm = this.s.locationMgr;\n  if (lm?.getCastDistanceRatio) return lm.getCastDistanceRatio(y);\n  if (lm?.getShoreDistanceRatio) return lm.getShoreDistanceRatio(y);\n  // —Å–æ–≤—Å–µ–º —É–∂ –±—ç–∫–∞–ø, –µ—Å–ª–∏ LM –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤:\n  const H = this.s.scale.height;\n  const t = Phaser.Math.Clamp(y / Math.max(1, H), 0, 1);\n  return 1 - t;\n}\n\n\n  _computeSlidePositions() {\n    const overhang = 8;\n    const shift = (this.size.w - this._tabW) + overhang;\n    this.shownX  = this.pos.x;\n    this.hiddenX = this.pos.x - shift;\n  }\n\n  toggle() {\n    if (this._tween) this._tween.stop();\n    this.isCollapsed = !this.isCollapsed;\n    this._tween = this.s.tweens.add({\n      targets: this.c,\n      x: this.isCollapsed ? this.hiddenX : this.shownX,\n      duration: 220, ease: 'Sine.inOut',\n      onUpdate: () => { this._placeRightOpener(); this._refreshRightOpenerVisibility(); },\n      onComplete: () => this._refreshRightOpenerVisibility()\n    });\n    this.arrow.setText(this.isCollapsed ? '‚ñ∫' : '‚óÑ');\n    this._refreshRightOpenerVisibility();\n  }\n\n  _drawIdle() {\n    this.gProfile.clear(); this.gDot.clear();\n    const { w, h } = this.size, pad = 10, rW = w - 20, rH = h - 20;\n    this.gProfile.fillStyle(0x1a394c, 1);\n    this.gProfile.fillRect(-rW/2 + pad, -rH/2 + pad, rW - pad*2, rH - pad*2);\n    this.lblMax.setText('');\n  }\n\n  _drawProfile(){\n    if (!this.samples) { this._drawIdle(); return; }\n\n    const { w, h } = this.size, pad = 18;\n    const L = -w/2 + pad, T = -h/2 + pad, VW = w - pad*2, VH = h - pad*2;\n    const range = Math.max(0.1, this.maxDepth * 1.1);\n\n    this.gProfile.clear();\n    this.gProfile.fillStyle(0x0f2a3b, 1);\n    this.gProfile.fillRect(L, T, VW, VH);\n\n    const toXY = (i) => {\n      const t = i / (this.samples.length - 1); // 0=–¥–∞–ª—å/–ø—Ä–∞–≤–æ,1=–±–µ—Ä–µ–≥/–ª–µ–≤–æ\n      const u = 1 - t;\n      const d = this.samples[i];\n      const px = Math.round(L + u * VW) + 0.5;\n      const py = Math.round(T + (d / range) * VH) + 0.5;\n      return { x:px, y:py };\n    };\n\n    this.gProfile.fillStyle(0x213e54, 1).beginPath();\n    let p = toXY(0);\n    this.gProfile.moveTo(p.x, p.y);\n    for (let i = 1; i < this.samples.length; i++) {\n      p = toXY(i);\n      this.gProfile.lineTo(p.x, p.y);\n    }\n    const BRX = L + VW, BRY = T + VH;\n    this.gProfile.lineTo(L, BRY);\n    this.gProfile.lineTo(BRX, BRY);\n    this.gProfile.closePath();\n    this.gProfile.fillPath();\n\n    this.lblMax.setText(`${this.maxDepth.toFixed(2)}m`);\n    this.gDot.clear();\n  }\n\n  _buildRightOpener(){\n    const z = 969;\n    this.openBtnR = this.s.add.rectangle(0, 0, this._tabW, 46, 0x243548, 1)\n      .setStrokeStyle(1, 0xffffff, 0.18)\n      .setDepth(z)\n      .setScrollFactor(0)\n      .setInteractive({ useHandCursor: true })\n      .on('pointerdown', () => { if (this.isCollapsed) this.toggle(); });\n    this.openIconR = this.s.add.text(0, 0, '‚ñ∫', {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n    }).setOrigin(0.5).setDepth(z+1).setScrollFactor(0);\n\n    this._placeRightOpener();\n    this._refreshRightOpenerVisibility();\n  }\n\n  _placeRightOpener(){\n    const x = this.c.x + (this.size.w/2) + 8 - this._tabW/2;\n    const y = this.pos.y;\n    this.openBtnR?.setPosition(x, y);\n    this.openIconR?.setPosition(x, y);\n  }\n\n  _refreshRightOpenerVisibility(){\n    const v = !!this.isCollapsed;\n    this.openBtnR?.setVisible(v).setInteractive(v);\n    this.openIconR?.setVisible(v);\n  }\n\n  _layoutAttached(){\n    if (!this._attached) return;\n    const { ctrl, gap } = this._attached;\n    ctrl.c.setPosition(0, (this.size.h/2) + gap);\n  }\n}\n\nexport default DepthSonar;\n","// src/ui/DepthCtrl.js\nexport class DepthCtrl {\n  constructor(scene, initValueM = 1.2, pos = { x: 64, y: 64 }, onChange = ()=>{}, opts = {}) {\n    this.s = scene;\n\n    // --- –µ–¥–∏–Ω–∏—Ü—ã: —Ä–∞–±–æ—Ç–∞–µ–º –≤–Ω—É—Ç—Ä–∏ –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö (—Ü–µ–ª–æ–µ), –Ω–∞—Ä—É–∂—É –æ—Ç–¥–∞—ë–º –º–µ—Ç—Ä—ã ---\n    this._prec = 100;                   // 1 –º = 100 \"—Ç–∏–∫\" (—Å–º)\n    this.minM = opts.min ?? 0.20;\n    this.maxM = opts.max ?? 8.00;\n    this.stepM = opts.step ?? 0.01;     // —à–∞–≥ –°–õ–ê–ô–î–ï–†–ê –≤ –º–µ—Ç—Ä–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1—Å–º)\n\n    this.minCm  = Math.round(this.minM  * this._prec);\n    this.maxCm  = Math.round(this.maxM  * this._prec);\n    this.stepCm = Math.max(1, Math.round(this.stepM * this._prec)); // ‚â•1—Å–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ\n\n    this._valueCm = Phaser.Math.Clamp(Math.round(initValueM * this._prec), this.minCm, this.maxCm);\n    this.value    = this._valueCm / this._prec;     // –ø—É–±–ª–∏—á–Ω–æ–µ –ø–æ–ª–µ (–º–µ—Ç—Ä—ã)\n    this.onChange = onChange;\n\n    this.modalOpen = false;\n    this._modal = null;\n    this._hostRef = null;\n    this._applyRequested = false;\n    this.useHost = !!opts.useHost;\n\n    // -------- –õ–æ–Ω—á–µ—Ä-–∫–Ω–æ–ø–∫–∞ (–æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –ª–æ–∫–∞—Ç–æ—Ä–∞) --------\n    this.c = scene.add.container(pos.x, pos.y).setDepth(980);\n    const bw = 132, bh = 28;\n\n    this.btn = scene.add.rectangle(0, 0, bw, bh, 0x2b334a, 1)\n      .setStrokeStyle(2, 0xffffff, 0.18).setInteractive({ useHandCursor: true });\n    this.btnLbl = scene.add.text(0, 0, this._label(), {\n      fontFamily:'Arial, sans-serif', fontSize:'13px', color:'#ffffff'\n    }).setOrigin(0.5);\n    this.c.add([this.btn, this.btnLbl]);\n\n    this.btn.on('pointerover', ()=> this.btn.setFillStyle(0x323c58,1));\n    this.btn.on('pointerout',  ()=> this.btn.setFillStyle(0x2b334a,1));\n    this.btn.on('pointerdown', ()=> this._openModal());\n  }\n\n  // ====== helpers ======\n  _label(){ return `–ì–ª—É–±–∏–Ω–∞: ${this.value.toFixed(2)}–º`; }\n\n  _applyCm(newCm, silent=false){\n    const clamped = Phaser.Math.Clamp(Math.round(newCm), this.minCm, this.maxCm);\n    this._valueCm = clamped;\n    this.value = clamped / this._prec;\n    this.btnLbl?.setText(this._label());\n    if (!silent) this.onChange?.(this.value);\n\n    // –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç –º–æ–¥–∞–ª ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—É—á–∫—É/–ø—Ä–æ–≥—Ä–µ—Å—Å\n    if (this._handle && this._prog && this._toX) {\n      const nx = this._toX(this.value);\n      this._handle.x = nx;\n      this._prog.width = Math.max(2, nx - this._x0);\n      this._num?.setText(this._label());\n    }\n  }\n\n  _bump(deltaCm, silent=false){ this._applyCm(this._valueCm + deltaCm, silent); }\n\n  setPosition(x, y){ this.c?.setPosition(x, y); }\n\n  // –ø—É–±–ª–∏—á–Ω—ã–π API ¬´—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –º–µ—Ç—Ä–∞—Ö¬ª (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)\n  setValue(vMeters, silent=false){\n    const rawCm = Math.round(Phaser.Math.Clamp(vMeters, this.minM, this.maxM) * this._prec);\n    // —Å–Ω–∞–ø –ø–æ —à–∞–≥—É —Å–ª–∞–π–¥–µ—Ä–∞ (–≤ —Å–º)\n    const snappedCm = Math.round(rawCm / this.stepCm) * this.stepCm;\n    this._applyCm(snappedCm, silent);\n  }\n\n  destroy(){\n    this._closeModal(false, /*force*/true);\n    this.c?.destroy();\n  }\n\n  // =================== MODAL ===================\n  _buildUI(root, { W, H, cx, cy, PW, PH, withOverlay }) {\n    if (withOverlay) {\n      const ovr = this.s.add.rectangle(0, 0, W, H, 0x000000, 0.5)\n        .setOrigin(0,0).setScrollFactor(0).setInteractive();\n      root.add(ovr);\n    }\n\n    const shadow = this.s.add.rectangle(cx+2, cy+3, PW, PH, 0x000000, 0.22);\n    const panel  = this.s.add.rectangle(cx, cy, PW, PH, 0x1f2433, 1)\n      .setStrokeStyle(2, 0xffffff, 0.22);\n    root.add([shadow, panel]);\n\n    const title = this.s.add.text(cx, cy - PH/2 + 16, '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–ª—É–±–∏–Ω—ã –æ—Å–Ω–∞—Å—Ç–∫–∏', {\n      fontFamily:'Arial, sans-serif', fontSize:'20px', color:'#ffffff'\n    }).setOrigin(0.5,0);\n    const closeX = this.s.add.text(cx + PW/2 - 22, cy - PH/2 + 6, '‚úï', {\n      fontFamily:'Arial, sans-serif', fontSize:'20px', color:'#ffffff'\n    }).setOrigin(0.5,0).setInteractive({ useHandCursor:true });\n    root.add([title, closeX]);\n\n    // readout\n    this._num = this.s.add.text(cx, title.y + 36, this._label(), {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#cfd8ff'\n    }).setOrigin(0.5,0);\n    root.add(this._num);\n\n    // slider\n    const trackW = Math.min(360, PW - 80);\n    const trackY = cy + 16;\n    const x0 = cx - trackW/2, x1 = cx + trackW/2;\n    this._x0 = x0; this._x1 = x1;\n\n    const track = this.s.add.rectangle(cx, trackY, trackW, 6, 0x3a4760, 1)\n      .setStrokeStyle(1, 0xffffff, 0.15).setInteractive();\n    root.add(track);\n\n    // u ‚Üî –º–µ—Ç—Ä—ã\n    const toX = (vMeters)=> x0 + ((vMeters - this.minM)/(this.maxM - this.minM)) * trackW;\n    this._toX = toX;\n\n    this._prog = this.s.add.rectangle(x0, trackY, Math.max(2, toX(this.value) - x0), 6, 0x5aa6ff, 1)\n      .setOrigin(0,0.5);\n    root.add(this._prog);\n\n    // —Ç–∏–∫–∏ (–∫–∞–∂–¥—ã–µ 0.5–º) + –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ —Ü–µ–ª—ã—Ö –º–µ—Ç—Ä–∞—Ö\n    const ticksG = this.s.add.graphics();\n    ticksG.lineStyle(1, 0xffffff, 0.18);\n    const stepTick = 0.5;\n    for (let v = this.minM; v <= this.maxM + 1e-6; v += stepTick){\n      const tx = toX(v);\n      ticksG.beginPath();\n      ticksG.moveTo(tx, trackY - 5);\n      ticksG.lineTo(tx, trackY + 5);\n      ticksG.strokePath();\n\n      if (Math.abs(v - Math.round(v)) < 1e-6){\n        const t = this.s.add.text(tx, trackY + 12, `${Math.round(v)}–º`, {\n          fontFamily:'Arial, sans-serif', fontSize:'12px', color:'#9fb1db'\n        }).setOrigin(0.5,0);\n        root.add(t);\n      }\n    }\n    root.add(ticksG);\n\n    // handle\n    this._handle = this.s.add.circle(toX(this.value), trackY, 10, 0xeaeaea, 1)\n      .setStrokeStyle(2, 0x0f1116, 0.6).setInteractive({ draggable:true, useHandCursor:true });\n    root.add(this._handle);\n\n    const dragTo = (px)=>{\n      const nx = Phaser.Math.Clamp(px, x0, x1);\n      this._handle.x = nx;\n      // –æ–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ X -> –º–µ—Ç—Ä—ã -> —Å–º —Å–æ —Å–Ω–∞–ø–æ–º –ø–æ stepCm\n      const frac = (nx - x0) / trackW;\n      const rawM = this.minM + frac * (this.maxM - this.minM);\n      const rawCm = Math.round(rawM * this._prec);\n      const vCm = Math.round(rawCm / this.stepCm) * this.stepCm;\n      this._applyCm(vCm, false);\n      this._prog.width = Math.max(2, nx - x0);\n    };\n    this.s.input.setDraggable(this._handle, true);\n    this._handle.on('drag', (_p, dragX)=> dragTo(dragX));\n    track.on('pointerdown', (p)=> dragTo(p.worldX));\n\n    // +/- buttons (¬±1—Å–º, Shift=¬±5—Å–º, Ctrl/Meta=¬±10—Å–º)\n    const makeBtn = (x, txt, dir) => {\n      const r = this.s.add.rectangle(x, trackY + 40, 40, 28, 0x3b4662, 1)\n        .setStrokeStyle(2, 0xffffff, 0.18).setInteractive({ useHandCursor:true });\n      const l = this.s.add.text(x, trackY + 40, txt, {\n        fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n      }).setOrigin(0.5);\n      r.on('pointerover', ()=> r.setFillStyle(0x435074,1));\n      r.on('pointerout',  ()=> r.setFillStyle(0x3b4662,1));\n      r.on('pointerdown', (pointer)=> {\n        const ev = pointer?.event;\n        const mult = ev?.ctrlKey || ev?.metaKey ? 10 : (ev?.shiftKey ? 5 : 1);\n        this._bump(dir * mult);\n      });\n\n      // // (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∞–≤—Ç–æ-–ø–æ–≤—Ç–æ—Ä –ø—Ä–∏ —É–¥–µ—Ä–∂–∞–Ω–∏–∏:\n      // let rep = null;\n      // r.on('pointerdown', (p)=> {\n      //   const start = ()=> this._bump(dir * (p.event?.ctrlKey||p.event?.metaKey ? 10 : (p.event?.shiftKey?5:1)));\n      //   start();\n      //   rep = this.s.time.addEvent({ delay: 110, loop: true, callback: start });\n      // });\n      // r.on('pointerup',   ()=> rep?.remove());\n      // r.on('pointerout',  ()=> rep?.remove());\n\n      root.add([r,l]);\n      return r;\n    };\n    makeBtn(cx - 80, '‚àí', -1);\n    makeBtn(cx + 80, '+', +1);\n\n    // OK / Cancel\n    const ok = this.s.add.rectangle(cx - 60, cy + PH/2 - 24, 120, 34, 0x2e7d32, 1)\n      .setStrokeStyle(2, 0xffffff, 0.18).setInteractive({ useHandCursor:true });\n    const okLbl = this.s.add.text(ok.x, ok.y, '–ì–æ—Ç–æ–≤–æ', {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#ffffff'\n    }).setOrigin(0.5);\n\n    const cancel = this.s.add.rectangle(cx + 60, cy + PH/2 - 24, 120, 34, 0x36425b, 1)\n      .setStrokeStyle(2, 0xffffff, 0.18).setInteractive({ useHandCursor:true });\n    const cancelLbl = this.s.add.text(cancel.x, cancel.y, '–û—Ç–º–µ–Ω–∞', {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#ffffff'\n    }).setOrigin(0.5);\n\n    root.add([ok, okLbl, cancel, cancelLbl]);\n\n    closeX.on('pointerdown', ()=> this._closeModal(true));\n    ok.on('pointerdown',     ()=> this._closeModal(true));\n    cancel.on('pointerdown', ()=> { this._applyCm(this._beforeCm, true); this._closeModal(false); });\n\n    return { ok, cancel, closeX };\n  }\n\n  _openModal(){\n    if (this.modalOpen) return;\n    this.modalOpen = true;\n    this._applyRequested = false;\n    this._beforeCm = this._valueCm;\n\n    // –±–ª–æ–∫–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –≤ –∏–≥—Ä–µ, –µ—Å–ª–∏ –µ—Å—Ç—å —Ñ–ª–∞–≥ –≤ —Å—Ü–µ–Ω–µ\n    this._hadUiLock = ('uiLock' in this.s) ? this.s.uiLock : undefined;\n    if ('uiLock' in this.s) this.s.uiLock = true;\n\n    const W = this.s.scale.width, H = this.s.scale.height;\n    const cx = Math.round(W/2), cy = Math.round(H/2);\n    const PW = Math.min(520, W - 80), PH = 210;\n\n    if (this.useHost && this.s.modals) {\n      const hostRoot = this.s.add.container(0,0);\n      this._hostRef = hostRoot;\n\n      hostRoot.once('destroy', () => {\n        if (!this._applyRequested) this._applyCm(this._beforeCm, true);\n        this._finalizeClose();\n      });\n\n      if (this.s.modals.root) this.s.modals.root.add(hostRoot);\n      if (typeof this.s.modals.open === 'function') this.s.modals.open(()=>{}, 1);\n\n      this._buildUI(hostRoot, { W, H, cx, cy, PW, PH, withOverlay:false });\n\n      // ESC = –æ—Ç–º–µ–Ω–∞\n      this.s.input.keyboard?.once('keydown-ESC', ()=> {\n        if (!this.modalOpen) return;\n        this._applyCm(this._beforeCm, true);\n        if (hostRoot && !hostRoot.destroyed) hostRoot.destroy(true);\n      });\n      return;\n    }\n\n    // –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ä–µ–∂–∏–º\n    this._modal = this.s.add.container(0, 0).setDepth(1400);\n    this._buildUI(this._modal, { W, H, cx, cy, PW, PH, withOverlay:true });\n\n    // ESC = –æ—Ç–º–µ–Ω–∞\n    this.s.input.keyboard?.once('keydown-ESC', ()=> {\n      if (!this.modalOpen) return;\n      this._applyCm(this._beforeCm, true);\n      this._closeModal(false);\n    });\n  }\n\n  _finalizeClose() {\n    this.modalOpen = false;\n\n    if (this._hadUiLock !== undefined) this.s.uiLock = this._hadUiLock;\n    this.btnLbl?.setText(this._label());\n    if (this._applyRequested) this.onChange?.(this.value);\n\n    this._modal = null;\n    this._hostRef = null;\n    this._handle = null; this._prog = null; this._num = null;\n    this._toX = null;\n  }\n\n  _closeModal(apply=false, force=false){\n    if (!this.modalOpen && !force) return;\n    this._applyRequested = !!apply;\n\n    if (this._hostRef) {\n      if (!this._hostRef.destroyed) this._hostRef.destroy(true);\n      return;\n    }\n    if (this._modal && !this._modal.destroyed) this._modal.destroy(true);\n    this._finalizeClose();\n  }\n}\n\nexport default DepthCtrl;\n","// src/ui/MapModal.js\nimport UI from '../ui/theme.js';\nimport { LOCATIONS } from '../data/locations.js';\n\nexport function openMapModal(scene, onPick) {\n  const viaHost = !!scene.modalHost?.open;\n\n  if (viaHost) {\n    return scene.modalHost.open((c, api) => buildMapUI(scene, onPick, { container:c, onClose: api.close }));\n  }\n\n  // fallback –±–µ–∑ ModalHost\n  const { width: W, height: H } = scene.scale;\n  const overlay = scene.add.rectangle(0,0,W,H,0x000000,0.6)\n    .setOrigin(0,0).setInteractive().setDepth(UI.z.map);\n\n  const cleanup = () => {\n    overlay.destroy();\n    panel?.destroy(); title?.destroy(); maskG?.destroy(); list?.destroy();\n  };\n\n  let panel, title, maskG, list;\n  ({ panel, title, maskG, list } = buildMapUI(scene, onPick, { onClose: cleanup, depthBase: UI.z.map+1 }));\n\n  scene.scale.on('resize', onResize);\n  overlay.once('destroy', () => scene.scale.off('resize', onResize));\n  overlay.once('pointerdown', cleanup);\n\n  function onResize() {\n    const W2 = scene.scale.width, H2 = scene.scale.height;\n    overlay.setSize(W2, H2);\n  }\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–±–æ—Ä–∫–∞ UI. –†–∞–±–æ—Ç–∞–µ—Ç –∏ —Å ModalHost (—á–µ—Ä–µ–∑ container), –∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ.\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction buildMapUI(scene, onPick, { container=null, onClose=()=>{}, depthBase=UI.z.modal } = {}) {\n  const { width: W, height: H } = scene.scale;\n  const PW = Math.min(680, W - 80), PH = Math.min(480, H - 80);\n\n  const add = (go) => {\n    if (container) container.add(go);\n    return go;\n  };\n\n  const panel = add(\n    scene.add.rectangle(W/2, H/2, PW, PH, 0x1f2433, 1)\n      .setStrokeStyle(2, 0xffffff, 0.25).setDepth(depthBase)\n  );\n\n  const title = add(\n    scene.add.text(W/2, panel.y - PH/2 + 18, '–≠–∫—Å–ø–µ–¥–∏—Ü–∏—è ‚Äî –≤—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é', {\n      fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n    }).setOrigin(0.5,0).setDepth(depthBase+1)\n  );\n\n  // —Å–ø–∏—Å–æ–∫ (—Å–∫—Ä–æ–ª–ª + –º–∞—Å–∫–∞)\n  const listPad = 18;\n  const listH = PH - 86;\n  const listY = title.y + 40;\n  const list = add(scene.add.container(panel.x - PW/2 + listPad, listY).setDepth(depthBase+1));\n\n  const maskG = add(scene.add.graphics().setVisible(false).setDepth(depthBase+1));\n  maskG.fillRect(panel.x - PW/2 + listPad, listY, PW - listPad*2, listH);\n  const mask = maskG.createGeometryMask();\n  list.setMask(mask);\n\n  const twoCols = (PW >= 520);\n  const itemW = twoCols ? (PW - listPad*2 - 10) / 2 : (PW - listPad*2);\n  const itemH = 44, gap = 10;\n\n  LOCATIONS.forEach((loc, i) => {\n    const col = twoCols ? (i % 2) : 0;\n    const row = twoCols ? Math.floor(i / 2) : i;\n    const x = col * (itemW + 10);\n    const y = row * (itemH + gap);\n\n    const r = add(\n      scene.add.rectangle(x + itemW/2, y + itemH/2, itemW, itemH, 0x36425b, 1)\n        .setStrokeStyle(2, 0xffffff, 0.15)\n        .setInteractive()\n        .setDepth(depthBase+1)\n    );\n    const t = add(\n      scene.add.text(r.x, r.y, loc.title, {\n        fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n      }).setOrigin(0.5).setDepth(depthBase+1)\n    );\n\n    r.on('pointerover', () => r.setFillStyle(0x3c4a66,1));\n    r.on('pointerout',  () => r.setFillStyle(0x36425b,1));\n    r.on('pointerdown', () => { onClose(); onPick?.(loc.id); });\n\n    list.add([r, t]);\n  });\n\n  // —Å–∫—Ä–æ–ª–ª –∫–æ–ª–µ—Å–æ–º –∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ–º (—á–µ—Ä–µ–∑ –æ–∫–Ω–æ —Å—Ü–µ–Ω—ã)\n  let ty = 0;\n  const minY = Math.min(0, listH - list.getBounds().height - 8);\n  const clamp = v => Phaser.Math.Clamp(v, minY, 0);\n\n  scene.input.on('wheel', onWheel, this);\n  scene.input.on('pointermove', onDragMove, this);\n  scene.input.on('pointerup', onDragUp, this);\n\n  let dragging = false, lastY = 0;\n  function onWheel(_p, _dx, dy) { ty = clamp(ty - dy * 0.8); list.y = listY + ty; }\n  function onDragMove(p) { if (!dragging) return; ty = clamp(ty + (p.y - lastY)); lastY = p.y; list.y = listY + ty; }\n  function onDragUp() { dragging = false; }\n  scene.input.on('pointerdown', (p)=>{ \n    // –ø—Ä–æ–≤–µ—Ä–∏–º, –ø–æ–ø–∞–ª–∏ –ª–∏ –≤–Ω—É—Ç—Ä—å —Å–ø–∏—Å–∫–∞\n    const b = new Phaser.Geom.Rectangle(panel.x - PW/2 + listPad, listY, PW - listPad*2, listH);\n    if (Phaser.Geom.Rectangle.Contains(b, p.x, p.y)) { dragging = true; lastY = p.y; }\n  });\n\n  // ESC –∑–∞–∫—Ä—ã–≤–∞–µ—Ç\n  scene.input.keyboard?.once('keydown-ESC', onClose);\n\n  // –≤–µ—Ä–Ω—É—Ç—å —Ä—É—á–∫–∏ –¥–ª—è fallback-—á–∏—Å—Ç–∫–∏\n  return { panel, title, maskG, list };\n}\n","// src/ui/ActionDock.js\nimport UI from './theme.js';\nimport { openMapModal } from './MapModal.js';\n\nexport class ActionDock {\n  /**\n   * @param {Phaser.Scene} scene\n   * @param {{\n   *   onBase?: ()=>void,\n   *   onLocationPick?: (locId:string)=>void,\n   *   wallet?: {coins:number,gold:number,perks?:number},\n   *   showPerks?: boolean\n   * }} opts\n   */\n  constructor(scene, { onBase, onLocationPick, wallet, showPerks = true } = {}) {\n    this.s = scene;\n    this.onBase = onBase;\n    this.onLocationPick = onLocationPick;\n    this.showPerks = showPerks;\n\n    // –¥–∏–∑–∞–π–Ω-—Ç–æ–∫–µ–Ω—ã\n    this.padX = UI.rem(scene, 12);\n    this.padY = UI.rem(scene, 6);\n    this.gap  = UI.rem(scene, 10);\n    this.radius = Math.max(10, Math.round(UI.rem(scene, 10)));\n    this.bgColor = 0x2a3144;\n    this.bgAlpha = 0.95;\n    this.strokeColor = 0xffffff;\n    this.strokeAlpha = 0.18;\n\n    this.container = scene.add.container(0, 0).setDepth((UI.z.keepnet ?? 950) + 2);\n    this.bg = scene.add.graphics();\n    this.container.add(this.bg);\n\n    // --- –∫–Ω–æ–ø–∫–∏\n    this.btnBase = this._makeTextBtn('üè†  –ë–∞–∑–∞', () => this.onBase?.());\n    this.btnExp  = this._makeTextBtn('üó∫Ô∏è  –≠–∫—Å–ø–µ–¥–∏—Ü–∏—è', () => {\n      openMapModal(this.s, (locId) => this.onLocationPick?.(locId));\n    });\n\n    // --- –º–∏–Ω–∏-–∫–æ—à–µ–ª—ë–∫ (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ ¬´—á–∏–ø—ã¬ª –±–µ–∑ –ø–æ–¥–ø–∏—Å–µ–π)\n    const w = wallet || { coins: 0, gold: 0, perks: 0 };\n    this.chipCoins = this._makeChip(this._icCoin.bind(this));\n    this.chipGold  = this._makeChip(this._icGold.bind(this));\n    this.container.add([this.btnBase, this.btnExp, this.chipCoins, this.chipGold]);\n\n    if (this.showPerks){\n      this.chipPerks = this._makeChip(this._icPerk.bind(this));\n      this.container.add(this.chipPerks);\n    }\n\n    // —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏\n    this.divA = scene.add.rectangle(0, 0, 2, 22, 0xffffff, 0.16);\n    this.divB = scene.add.rectangle(0, 0, 2, 22, 0xffffff, 0.16);\n    this.container.add([this.divA, this.divB]);\n\n    // –∑–Ω–∞—á–µ–Ω–∏—è\n    this.setWallet(w.coins|0, w.gold|0, w.perks|0);\n\n    this.layoutInternal();\n  }\n\n  // ‚Äî‚Äî‚Äî –ø—É–±–ª–∏—á–Ω–æ–µ API\n  setPosition(x, y){ this.container.setPosition(x, y); }\n  setDepth(z){ this.container.setDepth(z); }\n  getBounds(){ return new Phaser.Geom.Rectangle(this.container.x - this.w/2, this.container.y - this.h/2, this.w, this.h); }\n  setWallet(coins, gold, perks=0){\n    this._setChipValue(this.chipCoins, coins);\n    this._setChipValue(this.chipGold,  gold);\n    if (this.chipPerks) this._setChipValue(this.chipPerks, perks);\n    this.layoutInternal();\n  }\n\n  // ‚Äî‚Äî‚Äî –≤—ë—Ä—Å—Ç–∫–∞ –≤–Ω—É—Ç—Ä–∏ –ø–∏–ª—é–ª–∏\n  layoutInternal(){\n    // —Ä–∞–∑–º–µ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤\n    const bH = Math.max(this.btnBase.hit.height, this.btnExp.hit.height);\n    const chipH = 28; // –≤—ã—Å–æ—Ç–∞ —á–∏–ø–∞\n    const contentH = Math.max(bH, chipH);\n\n    // —à–∏—Ä–∏–Ω—ã\n    const wBase = this.btnBase.hit.width;\n    const wExp  = this.btnExp.hit.width;\n    const wChip = (chip) => chip.bg.width;\n    const coinsW = wChip(this.chipCoins);\n    const goldW  = wChip(this.chipGold);\n    const perksW = this.chipPerks ? wChip(this.chipPerks) : 0;\n\n    // –æ–±—â–∞—è —à–∏—Ä–∏–Ω–∞\n    const chipGroupW = coinsW + this.gap + goldW + (this.chipPerks ? (this.gap + perksW) : 0);\n    this.w = this.padX + wBase + this.gap + 2 + this.gap + wExp + this.gap + 2 + this.gap + chipGroupW + this.padX;\n    this.h = this.padY*2 + contentH;\n\n    // —Ñ–æ–Ω-–ø–∏–ª—é–ª—è\n    this.bg.clear();\n    this.bg.fillStyle(this.bgColor, this.bgAlpha);\n    this.bg.lineStyle(2, this.strokeColor, this.strokeAlpha);\n    this.bg.fillRoundedRect(-this.w/2, -this.h/2, this.w, this.h, this.radius);\n    this.bg.strokeRoundedRect(-this.w/2, -this.h/2, this.w, this.h, this.radius);\n\n    // –ø–æ–∑–∏—Ü–∏–∏\n    let x = -this.w/2 + this.padX;\n\n    // –ë–∞–∑–∞\n    this.btnBase.setPosition(x + wBase/2, 0);\n    x += wBase + this.gap;\n\n    // —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å A\n    this.divA.setPosition(x + 1, 0);\n    x += 2 + this.gap;\n\n    // –≠–∫—Å–ø–µ–¥–∏—Ü–∏—è\n    this.btnExp.setPosition(x + wExp/2, 0);\n    x += wExp + this.gap;\n\n    // —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å B\n    this.divB.setPosition(x + 1, 0);\n    x += 2 + this.gap;\n\n    // —á–∏–ø—ã\n    const cy = 0;\n    this._placeChip(this.chipCoins, x, cy); x += coinsW + this.gap;\n    this._placeChip(this.chipGold,  x, cy); x += goldW  + (this.chipPerks ? this.gap : 0);\n    if (this.chipPerks) this._placeChip(this.chipPerks, x, cy);\n  }\n\n  // ‚Äî‚Äî‚Äî –∫–Ω–æ–ø–∫–∞-—Ç–µ–∫—Å—Ç\n  _makeTextBtn(label, onClick){\n    const g = this.s.add.container(0,0);\n\n    const t = this.s.add.text(0,0, label, {\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '18px',\n      color: '#ffffff'\n    }).setOrigin(0.5);\n\n    const hitW = t.width + UI.rem(this.s, 24);\n    const hitH = Math.max(36, t.height + UI.rem(this.s, 8));\n    const hit = this.s.add.rectangle(0, 0, hitW, hitH, 0x000000, 0)\n      .setInteractive({ useHandCursor: true });\n\n    hit.on('pointerover', ()=> t.setAlpha(0.9));\n    hit.on('pointerout',  ()=> t.setAlpha(1));\n    hit.on('pointerdown', ()=> onClick?.());\n\n    g.t = t; g.hit = hit;\n    g.add([t, hit]);\n    return g;\n  }\n\n  // ‚Äî‚Äî‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π ¬´—á–∏–ø¬ª –≤–∞–ª—é—Ç—ã\n  _makeChip(drawIcon){\n    const c = this.s.add.container(0,0);\n    const w = 76; const h = 28;\n    const bg = this.s.add.rectangle(0,0,w,h,0x1e2636,1)\n      .setOrigin(0.5)\n      .setStrokeStyle(2, 0xffffff, 0.12);\n    const ic = this.s.add.graphics({ x: -w/2 + 10, y: 0 });\n    drawIcon(ic, 0, 0);\n\n    const val = this.s.add.text(ic.x + 16, 0, '0', {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#eaf2ff'\n    }).setOrigin(0,0.5);\n\n    c.bg = bg; c.val = val;\n    c.add([bg, ic, val]);\n    return c;\n  }\n  _placeChip(chip, leftX, cy){\n    chip.setPosition(leftX + chip.bg.width/2, cy);\n  }\n  _setChipValue(chip, v){\n    const txt = String(v|0);\n    chip.val.setText(txt);\n    // –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä—è–µ–º, –µ—Å–ª–∏ —á–∏—Å–ª–æ —à–∏—Ä–æ–∫–æ–µ\n    const minW = 64;\n    const needW = Math.max(minW, chip.val.width + 28);\n    chip.bg.width = needW;\n    chip.bg.setSize(needW, chip.bg.height);\n  }\n\n  // ‚Äî‚Äî‚Äî –∏–∫–æ–Ω–∫–∏\n  _icCoin(g,x,y){ g.fillStyle(0xf6d463,1).fillCircle(x,y,7); g.fillStyle(0xffffff,0.6).fillCircle(x-2.5,y-2.5,2); g.lineStyle(2,0xffffff,0.18).strokeCircle(x,y,7); }\n  _icGold(g,x,y){\n    const R1=7,R2=3.2,pts=[]; for(let i=0;i<10;i++){const a=-Math.PI/2+i*Math.PI/5,r=i%2?R2:R1;pts.push({x:x+Math.cos(a)*r,y:y+Math.sin(a)*r});}\n    g.fillStyle(0xffe47a,1).fillPoints(pts,true); g.lineStyle(2,0xffffff,0.18).strokePoints(pts,true);\n  }\n  _icPerk(g,x,y){ g.lineStyle(2,0xb9d7ff,1); g.strokeCircle(x,y,7); g.beginPath(); g.moveTo(x-5,y); g.lineTo(x+5,y); g.moveTo(x,y-5); g.lineTo(x,y+5); g.strokePath(); }\n}\n\nexport default ActionDock;\n","// src/ui/PagedGrid.js\n// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π –≥—Ä–∏–¥  (–±–µ–∑ –º–∞—Å–æ–∫ –∏ –±–µ–∑ –∑–∞–≤—è–∑–∫–∏ –Ω–∞ —Ç–µ–º—É/–∫–≤–µ—Å—Ç—ã)\n//\n// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n//   const grid = new PagedGrid(scene, {\n//     x, y,\n//     cols: 3, rows: 2, cellW: 180, cellH: 208, gap: 16,\n//     showFrame: true,\n//     makeCell: (item, w, h, idx) => makeQuestCard(item, w, h),\n//     makeStub: (w,h) => makeEmptySlot(w,h)   // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ\n//   });\n//   grid.setItems(npcArray);\n//\n// –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã:\n//   setItems(items)\n//   goTo(pageIndex, instant=false)\n//   next(), prev()\n//   setPosition(x,y), setDepth(d)\n//   enableWheel(boolean)\n//   destroy()\n\nexport default class PagedGrid {\n  /** @param {Phaser.Scene} s\n   *  @param {{\n   *    x?:number, y?:number,\n   *    cols:number, rows:number, cellW:number, cellH:number, gap?:number,\n   *    showFrame?:boolean,\n   *    makeCell:(item:any,w:number,h:number,globalIndex:number)=>Phaser.GameObjects.Container,\n   *    makeStub?:(w:number,h:number)=>Phaser.GameObjects.Container,\n   *    textStyle?:Phaser.Types.GameObjects.Text.TextStyle,\n   *    bgColor?:number, strokeColor?:number\n   *  }} opts\n   */\n  constructor(s, opts){\n    this.s = s;\n    this.opts = opts || {};\n    this.x = opts.x|0; this.y = opts.y|0;\n\n    this.cols   = Math.max(1, opts.cols|0);\n    this.rows   = Math.max(1, opts.rows|0);\n    this.cellW  = Math.max(8, opts.cellW|0);\n    this.cellH  = Math.max(8, opts.cellH|0);\n    this.gap    = (opts.gap ?? 16)|0;\n\n    this.pageSize   = this.cols * this.rows;\n    this.items      = [];\n    this.pageIndex  = 0;\n    this._pages     = [];     // –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã-—Å—Ç—Ä–∞–Ω–∏—Ü—ã\n    this._dots      = [];\n    this._wheelOn   = true;\n\n    // —Ä–∞–∑–º–µ—Ä—ã –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏ (–±–µ–∑ –º–∞—Å–∫–∏)\n    this.vw = this.cols*this.cellW + this.gap*(this.cols-1);\n    this.vh = this.rows*this.cellH + this.gap*(this.rows-1);\n\n    // –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏/—Ü–≤–µ—Ç–∞ (–±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç theme.js)\n    this.textStyle = Object.assign({\n      fontFamily: 'Inter, Arial, sans-serif',\n      fontSize: '18px',\n      color: '#c8cfdd'\n    }, opts.textStyle || {});\n    this.bgColor     = (opts.bgColor ?? 0x121722);\n    this.strokeColor = (opts.strokeColor ?? 0x2b3344);\n\n    // –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä\n    this.root = s.add.container(this.x, this.y).setSize(this.vw, this.vh + 28);\n\n    // —Ñ–æ–Ω/—Ä–∞–º–∫–∞ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)\n    if (opts.showFrame !== false){\n      const frame = s.add.graphics();\n      frame.fillStyle(this.bgColor, 1).fillRoundedRect(0,0,this.vw,this.vh,14);\n      frame.lineStyle(2, this.strokeColor, 1).strokeRoundedRect(0,0,this.vw,this.vh,14);\n      this.root.add(frame);\n    }\n\n    // –æ–±–ª–∞—Å—Ç—å –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü\n    this.wrap = s.add.container(0,0).setSize(this.vw, this.vh);\n    this.root.add(this.wrap);\n\n    // —Å—Ç—Ä–µ–ª–∫–∏\n    this.leftArrow  = s.add.text(-12, this.vh/2, '‚Äπ', this.textStyle).setOrigin(1,0.5)\n      .setInteractive({useHandCursor:true}).on('pointerup', ()=> this.prev());\n    this.rightArrow = s.add.text(this.vw+12, this.vh/2, '‚Ä∫', this.textStyle).setOrigin(0,0.5)\n      .setInteractive({useHandCursor:true}).on('pointerup', ()=> this.next());\n    this.root.add(this.leftArrow);\n    this.root.add(this.rightArrow);\n\n    // wheel –ø–æ –æ–±–ª–∞—Å—Ç–∏ –≥—Ä–∏–¥–∞\n    this.wrap.setInteractive(new Phaser.Geom.Rectangle(0,0,this.vw,this.vh), Phaser.Geom.Rectangle.Contains);\n    this.wrap.on('wheel', (_p,_dx,dy)=> { if (!this._wheelOn) return; (dy>0) ? this.next() : this.prev(); });\n\n    // —Ç–æ—á–∫–∏ (–ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—é—Ç—Å—è –≤ _renderDots)\n    this._dotsY = this.vh + 6;\n\n    // –∞–Ω–∏–º–∞—Ü–∏–∏\n    this._fadeIn  = (pg) => this.s.tweens.add({ targets: pg, alpha: 1,  duration: 160, ease: 'Cubic.Out' });\n    this._fadeOut = (pg, cb) => this.s.tweens.add({ targets: pg, alpha: 0, duration: 140, ease: 'Cubic.Out', onComplete: cb });\n  }\n\n  /* ======= Public API ======= */\n  setItems(items){\n    this.items = Array.isArray(items) ? items : [];\n    this.pageIndex = 0;\n    this._buildPages();\n    this._updateArrows();\n    this._renderDots();\n    return this;\n  }\n\n  goTo(index, instant=false){\n    const total = this._pages.length || 1;\n    const next = clamp(index|0, 0, total-1);\n    if (next === this.pageIndex) return this;\n\n    const prevPage = this._pages[this.pageIndex];\n    const nextPage = this._pages[next];\n    nextPage.setVisible(true);\n\n    if (instant){\n      if (prevPage){ prevPage.setVisible(false).setAlpha(0); }\n      nextPage.setAlpha(1);\n    } else {\n      if (prevPage) this._fadeOut(prevPage, () => prevPage.setVisible(false));\n      this._fadeIn(nextPage);\n    }\n\n    this.pageIndex = next;\n    this._updateArrows();\n    this._highlightDots();\n    return this;\n  }\n\n  next(){ return this.goTo(this.pageIndex + 1); }\n  prev(){ return this.goTo(this.pageIndex - 1); }\n\n  setPosition(x,y){ this.x=x|0; this.y=y|0; this.root?.setPosition(this.x,this.y); return this; }\n  setDepth(d){ this.root?.setDepth(d); return this; }\n  enableWheel(v=true){ this._wheelOn = !!v; return this; }\n\n  destroy(){\n    this.wrap?.removeAll(true);\n    this.root?.removeAll(true);\n    this._pages.length = 0;\n    this._dots.length  = 0;\n    this.wrap = null; this.root = null;\n  }\n\n  /* ======= Internals ======= */\n  _buildPages(){\n    // –æ—á–∏—Å—Ç–∫–∞\n    this.wrap.removeAll(true);\n    this._pages.length = 0;\n\n    const totalPages = Math.max(1, Math.ceil(this.items.length / this.pageSize));\n    const makeCell = this.opts.makeCell;\n    const makeStub = this.opts.makeStub || ((w,h)=> {\n      const g = this.s.add.graphics();\n      g.fillStyle(0x0e121b, 1).fillRoundedRect(0,0,this.cellW,this.cellH,12);\n      g.lineStyle(2, this.strokeColor, 1).strokeRoundedRect(0,0,this.cellW,this.cellH,12);\n      const dash = this.s.add.text(this.cellW/2, this.cellH/2, '‚Äî', Object.assign({}, this.textStyle, {color:'#677089'})).setOrigin(0.5);\n      return this.s.add.container(0,0,[g,dash]).setSize(this.cellW,this.cellH);\n    });\n\n    for (let p=0; p<totalPages; p++){\n      const page = this.s.add.container(0,0).setAlpha(0).setVisible(false);\n      this.wrap.add(page);\n      this._pages.push(page);\n\n      for (let i=0; i<this.pageSize; i++){\n        const gi  = p*this.pageSize + i;         // –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å\n        const col = i % this.cols;\n        const row = (i / this.cols) | 0;\n        const x   = col * (this.cellW + this.gap);\n        const y   = row * (this.cellH + this.gap);\n\n        const item = this.items[gi];\n        const node = (item !== undefined)\n          ? makeCell(item, this.cellW, this.cellH, gi)\n          : makeStub(this.cellW, this.cellH);\n\n        node.setPosition(x,y);\n        page.add(node);\n      }\n    }\n\n    // —Å—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞\n    const cur = this._pages[this.pageIndex] || this._pages[0];\n    cur?.setVisible(true).setAlpha(1);\n  }\n\n  _renderDots(){\n    // –æ—á–∏—Å—Ç–∫–∞\n    this._dots.forEach(d=>d.destroy());\n    this._dots.length = 0;\n\n    const total = this._pages.length || 1;\n    const cx = (this.vw/2)|0, gap = 12;\n\n    // ¬´—É–º–Ω—ã–µ¬ª —Ç–æ—á–∫–∏: –≤—Å—ë, –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü ‚â§ 7; –∏–Ω–∞—á–µ ‚Äî 1 ‚Ä¶ –≤–æ–∫—Ä—É–≥ —Ç–µ–∫—É—â–µ–π ‚Ä¶ N\n    const indexes = [];\n    if (total <= 7){\n      for (let i=0;i<total;i++) indexes.push(i);\n    } else {\n      indexes.push(0);\n      if (this.pageIndex > 2) indexes.push('‚Ä¶');\n      for (let i=this.pageIndex-1;i<=this.pageIndex+1;i++){\n        if (i>0 && i<total-1) indexes.push(i);\n      }\n      if (this.pageIndex < total-3) indexes.push('‚Ä¶');\n      indexes.push(total-1);\n    }\n\n    // —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –Ω–∞–±–æ—Ä\n    const n = indexes.length;\n    const startX = cx - ((n-1)*gap)/2;\n\n    indexes.forEach((it, k) => {\n      const x = startX + k*gap;\n      const txt = (it === '‚Ä¶') ? '‚Ä¶' : '‚Ä¢';\n      const color = (it === '‚Ä¶') ? '#677089' : (it===this.pageIndex ? '#ffffff' : '#677089');\n      const dot = this.s.add.text(x, this._dotsY, txt, Object.assign({}, this.textStyle, {color}))\n        .setOrigin(0.5);\n\n      if (it !== '‚Ä¶'){\n        dot.setInteractive({useHandCursor:true}).on('pointerup', ()=> this.goTo(it));\n      }\n      this.root.add(dot);\n      this._dots.push(dot);\n    });\n  }\n\n  _highlightDots(){\n    const total = this._pages.length || 1;\n    // –∫–æ–≥–¥–∞ _renderDots –¥–µ–ª–∞–µ—Ç ¬´—É–º–Ω—ã–µ¬ª —Ç–æ—á–∫–∏, –ø—Ä–æ—â–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å\n    this._renderDots();\n    this._updateArrows();\n  }\n\n  _updateArrows(){\n    const total = this._pages.length || 1;\n    const atFirst = this.pageIndex <= 0;\n    const atLast  = this.pageIndex >= total-1;\n    this.leftArrow?.setAlpha(atFirst ? 0.35 : 1);\n    this.rightArrow?.setAlpha(atLast  ? 0.35 : 1);\n    this.leftArrow?.setInteractive({ useHandCursor: !atFirst });\n    this.rightArrow?.setInteractive({ useHandCursor: !atLast  });\n  }\n}\n\n/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\nfunction clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }\n","// src/data/QuestDB.js\n\n// –¢–∏–ø—ã (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è; –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å TS/JSDoc)\n/**\n * @typedef {{ id:string, kind:string, name:string, params?:any, countGoal?:number }} QuestTask\n * @typedef {{ id:string, name:string, tasks?:QuestTask[], reward?:any }} QuestStage\n * @typedef {{ id:string, name:string, portraitKey?:string, category?:string, stages:QuestStage[] }} NPCQuestline\n */\n\n/** @type {NPCQuestline[]} */\nexport const NPCS = [\n  {\n    id: 'uncle_zhora',\n    name: '–î—è–¥—å–∫–æ –ñ–æ—Ä–∞',\n    portraitKey: 'npc_uncle_zhora',\n    category: 'starter',\n    stages: [\n      // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n      {\n        id: 's1',\n        name: '–ü–µ—Ä—à—ñ –∫—Ä–æ–∫–∏ —Ä–∏–±–∞–ª–∫–∏',\n        tasks: [\n          { id:'t1', kind:'catch_count', name:'–ó–ª–æ–≤–∏ 1 —Ä–∏–±—É',  params:{}, countGoal:1 },\n          { id:'t2', kind:'catch_count', name:'–ó–ª–æ–≤–∏ 5 —Ä–∏–±',   params:{}, countGoal:5 },\n        ],\n        reward: { wallet:{ coins: 100 } }\n      },\n\n      // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n      {\n        id: 's2',\n        name: '–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–∂—É—î—Ç—å—Å—è',\n        tasks: [\n          // id‚Äô—ã –∑–∞–¥–∞—á –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –º–µ–∂–¥—É —Å—Ç–∞–¥—ñ—è–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ\n          // QuestState –æ—á–∏—â–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞—á –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä–∞–¥–∏.\n          { id:'t1', kind:'catch_count', name:'–ó–ª–æ–≤–∏ 10 —Ä–∏–±', params:{}, countGoal:10 },\n        ],\n        reward: { wallet:{ coins: 250 } }\n      },\n\n      // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s3 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n      {\n        id: 's3',\n        name: '–°–ø—Ä–∞–≤–∂–Ω—ñ–π —Ä–∏–±–∞–ª–∫–∞',\n        tasks: [\n          { id:'t1', kind:'catch_count', name:'–ó–ª–æ–≤–∏ 25 —Ä–∏–±', params:{}, countGoal:25 },\n        ],\n        reward: { wallet:{ coins: 500, gold: 1 } }\n      },\n      {\n        id: 's4',\n        name: '–ú–∞–π—Å—Ç–µ—Ä –≤–æ–¥–æ–π–º–∏',\n        tasks: [\n          { id:'t1', kind:'catch_count', name:'–ó–ª–æ–≤–∏ 50 —Ä–∏–±', params:{}, countGoal:50 },\n        ],\n        reward: { wallet:{ coins: 1000 }, items:[{ id:'bait_worm', count:20 }] }\n      }\n    ]\n  },\n\n\n{\n  id: 'weighmaster_pavlo',\n  name: '–ü–∞–≤–ª–æ-–≤–∞–≥–∞—Ä',\n  portraitKey: 'npc_pavlo',\n  category: 'precision',\n  stages: [\n    {\n      id: 's1',\n      name: '–ú—ñ–ª—ñ–≥—Ä–∞–º–∏ –º–∞—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è',\n      tasks: [\n        {\n          id:'t_exact_111',\n          kind:'catch_weight_exact_g',\n          name:'–ó–ª–æ–≤–∏ —Ä–∏–±—É —Ä—ñ–≤–Ω–æ 0.111 –∫–≥ (¬±2 –≥)',\n          params:{ valuesKg:[0.111], toleranceG:2, ignoreZero:true },\n          countGoal: 1\n        },\n        {\n          id:'t_exact_222',\n          kind:'catch_weight_exact_g',\n          name:'–ó–ª–æ–≤–∏ —Ä–∏–±—É —Ä—ñ–≤–Ω–æ 0.222 –∫–≥ (¬±2 –≥)',\n          params:{ valuesKg:[0.222], toleranceG:2, ignoreZero:true },\n          countGoal: 1\n        },\n      ],\n      reward: { wallet:{ coins: 300 } }\n    },\n    {\n      id: 's2',\n      name: '–¢–æ—á–Ω—ñ—Å—Ç—å –º–Ω–æ–∂–∏—Ç—å—Å—è',\n      tasks: [\n        {\n          id:'t_exact_set',\n          kind:'catch_weight_exact_g',\n          name:'0.333, 0.444 –∞–±–æ 0.555 –∫–≥ (–±—É–¥—å-—è–∫–∞, ¬±2 –≥) ‚Äî –¥–≤—ñ—á—ñ',\n          params:{ valuesKg:[0.333,0.444,0.555], toleranceG:2, ignoreZero:true },\n          countGoal: 2\n        },\n        {\n          id:'t_bait_ctrl',\n          kind:'catch_bait_is',\n          name:'–î–æ–≤–µ–¥–∏ –º–∞–π—Å—Ç–µ—Ä–Ω—ñ—Å—Ç—å ‚Äî –∑–ª–æ–≤–∏ 2 —Ä–∏–±–∏ –Ω–∞ —Ö–ª—ñ–±',\n          params:{ bait:'bread' },\n          countGoal: 2\n        },\n      ],\n      reward: { wallet:{ coins: 700 }, items:[{ id:'bait_worm', count:8 }] }\n    },\n    {\n      id: 's3',\n      name: '–¢–æ—á–Ω—ñ—Å—Ç—å —É –≤–µ—á—ñ—Ä–Ω—ñ–π —Ç–∏—à—ñ',\n      tasks: [\n        { id:'t_even', kind:'catch_time_of_day', name:'–õ–æ–≤–∏ –≤–≤–µ—á–µ—Ä—ñ (3 —Ä–∏–±–∏)', params:{ time:'evening' }, countGoal:3 },\n        { id:'t_exact_444', kind:'catch_weight_exact_g', name:'0.444 –∫–≥ (¬±2 –≥)', params:{ valuesKg:[0.444], toleranceG:2 }, countGoal:1 },\n      ],\n      reward: { wallet:{ coins: 1200 }, items:[{ id:'bait_worm', count:12 }] }\n    }\n  ]\n},\n\n{\n  id: 'banker_olena',\n  name: '–û–ª–µ–Ω–∞-–±–∞–Ω–∫—ñ—Ä',\n  portraitKey: 'npc_banker_olena',\n  category: 'economy',\n  stages: [\n    {\n      id:'s1',\n      name:'–§—ñ–Ω–∞–Ω—Å–æ–≤–∞ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞',\n      tasks: [\n        { id:'t_coins_500', kind:'wallet_coins_at_least', name:'–ù–∞–∫–æ–ø–∏—á 500 —Å—Ä—ñ–±–ª–∞', params:{ coins:500 } },\n        { id:'t_loot_once',  kind:'loot_any', name:'–ó–Ω–∞–π–¥–∏ –±—É–¥—å-—è–∫–∏–π –ª—É—Ç', params:{} , countGoal:1 }, // —Å—Ç–∏–º—É–ª—é—î–º–æ —Ä—ñ–∑–Ω—ñ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ\n      ],\n      reward: { wallet:{ coins: 250 } }\n    },\n    {\n      id:'s2',\n      name:'–ó–æ–ª–æ—Ç–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç',\n      tasks: [\n        { id:'t_gold2', kind:'wallet_gold_at_least', name:'–ú–∞–π 2 –∑–æ–ª–æ—Ç–∞', params:{ gold:2 } },\n        { id:'t_coins_2000', kind:'wallet_coins_at_least', name:'–ù–∞–∫–æ–ø–∏—á 2000 —Å—Ä—ñ–±–ª–∞', params:{ coins:2000 } },\n      ],\n      reward: { wallet:{ coins: 800, gold:1 } }\n    },\n    {\n      id:'s3',\n      name:'–§–æ–Ω–¥ —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ',\n      tasks: [\n        { id:'t_coins_5000', kind:'wallet_coins_at_least', name:'–ë–∞–ª–∞–Ω—Å 5000 —Å—Ä—ñ–±–ª–∞', params:{ coins:5000 } },\n      ],\n      reward: { wallet:{ coins: 1500 }, items:[{ id:'bait_worm', count:15 }] }\n    }\n  ]\n},\n{\n  id: 'rodsmith_oleg',\n  name: '–û–ª–µ–≥-–∫–æ–≤–∞–ª—å –≤—É–¥–æ—á–æ–∫',\n  portraitKey: 'npc_rodsmith_oleg',\n  category: 'gear',\n  stages: [\n    {\n      id:'s1',\n      name:'–ü–µ—Ä—à—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n      tasks: [\n        { id:'t_buy_rod_basic', kind:'buy_item_id', name:'–ö—É–ø–∏ –≤—É–¥–∫—É ¬´rod_basic¬ª', params:{ itemId:'rod_basic' } },\n        { id:'t_have_rod2', kind:'own_item_kind_count_at_least', name:'–ú–∞–π 2 –≤—É–¥–∫–∏ —É —ñ–Ω–≤–µ–Ω—Ç–∞—Ä—ñ', params:{ kind:'rod', count:2 } },\n      ],\n      reward: { wallet:{ coins: 300 } }\n    },\n    {\n      id:'s2',\n      name:'–†–∏–±–∞–ª—å—Å—å–∫–∞ –º–∞–π—Å—Ç–µ—Ä–Ω—è',\n      tasks: [\n        { id:'t_buy_reel_basic', kind:'buy_item_id', name:'–ö—É–ø–∏ –∫–æ—Ç—É—à–∫—É ¬´reel_basic¬ª', params:{ itemId:'reel_basic' } },\n        { id:'t_have_line', kind:'own_item_kind_count_at_least', name:'–ú–∞–π 1 –ª—ñ—Å–∫—É', params:{ kind:'line', count:1 } },\n      ],\n      reward: { wallet:{ coins: 600 } }\n    }\n  ]\n},\n{\n  id: 'mentor_ivan',\n  name: '–Ü–≤–∞–Ω-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫',\n  portraitKey: 'npc_mentor_ivan',\n  category: 'progression',\n  stages: [\n    {\n      id:'s1',\n      name:'–°—Ç–∞–Ω—å –∫—Ä–∞—â–∏–º',\n      tasks: [\n        { id:'t_lvl2', kind:'reach_level_at_least', name:'–î–æ—Å—è–≥–Ω–∏ —Ä—ñ–≤–Ω—è 2', params:{ level:2 } },\n      ],\n      reward: { wallet:{ coins: 200 } }\n    },\n    {\n      id:'s2',\n      name:'–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è',\n      tasks: [\n        { id:'t_lvl3', kind:'reach_level_at_least', name:'–î–æ—Å—è–≥–Ω–∏ —Ä—ñ–≤–Ω—è 3', params:{ level:3 } },\n      ],\n      reward: { wallet:{ coins: 400 } }\n    },\n    {\n      id:'s3',\n      name:'–°–ø—Ä–∞–≤–∂–Ω—ñ–π —à–ª—è—Ö',\n      tasks: [\n        { id:'t_lvl5', kind:'reach_level_at_least', name:'–î–æ—Å—è–≥–Ω–∏ —Ä—ñ–≤–Ω—è 5', params:{ level:5 } },\n      ],\n      reward: { wallet:{ coins: 900, gold:1 } }\n    }\n  ]\n},\n\n\n\n\n  // –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —ñ–Ω—à–∏—Ö NPC –Ω–∏–∂—á–µ:\n  // {\n  //   id: 'fisher_katya',\n  //   name: '–ö–∞—Ç—è-—Ä–∏–±–∞—á–∫–∞',\n  //   portraitKey: 'npc_katya',\n  //   stages: [ ... ]\n  // }\n\n  {\n  id: 'fisher_katya',\n  name: '–ö–∞—Ç—è-—Ä–∏–±–∞—á–∫–∞',\n  portraitKey: 'npc_katya',      // —è–∫—â–æ —Ç–µ–∫—Å—Ç—É—Ä–∏ –Ω–µ–º–∞ ‚Äî UI –ø–æ–∫–∞–∂–µ –µ–º–æ–¥–∑—ñ\n  category: 'technique',         // —É–º–æ–≤–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è: ¬´—Ç–µ—Ö–Ω—ñ–∫–∞ –ª–æ–≤—É¬ª\n  stages: [\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    {\n      id: 's1',\n      name: '–õ–µ–≥–∫–∞ —Ä–æ–∑–º–∏–Ω–∫–∞',\n      tasks: [\n        { id:'t_count3', kind:'catch_count', name:'–ó–ª–æ–≤–∏ 3 —Ä–∏–±–∏', params:{}, countGoal:3 },\n        { id:'t_worm2',  kind:'catch_bait_is', name:'–ó–ª–æ–≤–∏ 2 —Ä–∏–±–∏ –Ω–∞ —á–µ—Ä–≤ º—è–∫–∞', params:{ bait:'worm' }, countGoal:2 },\n      ],\n      reward: { wallet:{ coins: 180 } }\n    },\n\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    {\n      id: 's2',\n      name: '–¢–æ—á–Ω–∏–π –≤–∞–≥–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å',\n      tasks: [\n        {\n          id:'t_w100_200',\n          kind:'catch_weight_range_g',\n          name:'–ó–ª–æ–≤–∏ 3 —Ä–∏–±–∏ –≤–∞–≥–æ—é 100‚Äì200 –≥',\n          params:{ weightG:[100,200] },\n          countGoal:3\n        },\n        {\n          id:'t_lake3',\n          kind:'catch_in_location',\n          name:'–ó–ª–æ–≤–∏ 3 —Ä–∏–±–∏ –Ω–∞ –æ–∑–µ—Ä—ñ',\n          params:{ locations:['lake'] },\n          countGoal:3\n        }\n      ],\n      reward: { wallet:{ coins: 420 } }\n    },\n\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s3 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    {\n      id: 's3',\n      name: '–ì–ª–∏–±–∏–Ω–∞ —ñ —á–∞—Å',\n      tasks: [\n        {\n          id:'t_depth_shallow',\n          kind:'catch_depth_range_m',\n          name:'–ó–ª–æ–≤–∏ 4 —Ä–∏–±–∏ –Ω–∞ –≥–ª–∏–±–∏–Ω—ñ 0.5‚Äì1.5 –º',\n          params:{ depthM:[0.5,1.5] },\n          countGoal:4\n        },\n        {\n          id:'t_evening3',\n          kind:'catch_time_of_day',\n          name:'–ó–ª–æ–≤–∏ 3 —Ä–∏–±–∏ –≤–≤–µ—á–µ—Ä—ñ',\n          params:{ time:'evening' },\n          countGoal:3\n        }\n      ],\n      reward: { wallet:{ coins: 650 }, items:[{ id:'bait_worm', count:12 }] }\n    },\n\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ s4 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    {\n      id: 's4',\n      name: '–ú–∞–π—Å—Ç—Ä–∏–Ω—è —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç—Ç—è',\n      tasks: [\n        {\n          id:'t_species_mix',\n          kind:'catch_species',\n          name:'–ó–ª–æ–≤–∏ 2 –∫–∞—Ä–ø–∞ –∞–±–æ –ø–ª–æ—Ç–≤–∏',\n          params:{ species:['carp','roach'] },\n          countGoal:2\n        },\n        {\n          id:'t_loot_any',\n          kind:'loot_any',\n          name:'–î–æ–±—É–¥—å –±—É–¥—å-—è–∫–∏–π –ª—É—Ç',\n          params:{},\n          countGoal:1\n        }\n      ],\n      reward: { wallet:{ coins: 1000, gold:1 } }\n    }\n  ]\n}\n\n];\n\n// –ü—É–±–ª—ñ—á–Ω—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏\nexport function getAllNPC() {\n  return NPCS;\n}\n\nexport function getNPCById(id) {\n  return NPCS.find(n => n.id === id) || null;\n}\n","let _pending = false;\n\nexport function emitQuestProgress(detail = {}) {\n  if (_pending) return;\n  _pending = true;\n  const fire = () => {\n    _pending = false;\n    try { window.dispatchEvent(new CustomEvent('quest-progress', { detail })); } catch {}\n  };\n  if (typeof requestAnimationFrame === 'function') requestAnimationFrame(fire);\n  else setTimeout(fire, 0);\n}\n","// src/quests/QuestState.js\nimport { getAllNPC } from '../data/QuestDB.js';\nimport { emitQuestProgress } from './QuestEvents.js';\n\nconst LS_KEY = 'rf_quest_state_v1';\nlet _state = load() || { npcs: {}, trackedNpcId: null };\n\nfunction load(){ try { return JSON.parse(localStorage.getItem(LS_KEY)); } catch { return null; } }\nfunction save(){ try { localStorage.setItem(LS_KEY, JSON.stringify(_state)); } catch {} }\nfunction ensureNpc(npcId){ if (!_state.npcs[npcId]) _state.npcs[npcId] = { stageIndex: 0, tasks: {} }; return _state.npcs[npcId]; }\n\nfunction emit(type, detail={}){ emitQuestProgress({ type, ...detail }); }\n\n\nexport const QuestState = {\n  getNPC(npcId){ return ensureNpc(npcId); },\n\n  // ‚îÄ‚îÄ —Ç—Ä–µ–∫–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ NPC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  getTrackedNpcId(){ return _state.trackedNpcId ?? null; },\n  setTrackedNpcId(npcId){\n    _state.trackedNpcId = npcId || null;\n    save(); emit('tracked-change', { npcId: _state.trackedNpcId });\n  },\n\n  getActiveStage(npcId){\n    const npcDef = getAllNPC().find(n => n.id === npcId);\n    if (!npcDef) return null;\n    const stIx = ensureNpc(npcId).stageIndex | 0;\n    return npcDef.stages?.[stIx] ?? null;\n  },\n\n  isTaskDone(npcId, task){\n    const rec = ensureNpc(npcId).tasks[task.id] || {};\n    if (task.countGoal != null) return (rec.count|0) >= (task.countGoal|0);\n    return !!rec.done;\n  },\n\n  addTaskCount(npcId, taskId, delta = 1){\n    const npc = ensureNpc(npcId);\n    const rec = npc.tasks[taskId] || (npc.tasks[taskId] = { count: 0 });\n    rec.count = Math.max(0, (rec.count|0) + (delta|0));\n    save(); emit('task-count', { npcId, taskId, count: rec.count });\n    return rec.count;\n  },\n\n  markTaskDone(npcId, taskId, v = true){\n    const npc = ensureNpc(npcId);\n    npc.tasks[taskId] = { ...(npc.tasks[taskId]||{}), done: !!v };\n    save(); emit('task-done', { npcId, taskId });\n  },\n\n  tryAdvanceStage(npcId){\n    const npcDef = getAllNPC().find(n => n.id === npcId);\n    if (!npcDef) return false;\n    const npc = ensureNpc(npcId);\n    const stage = npcDef.stages?.[npc.stageIndex|0];\n    if (!stage) return false;\n\n    const tasks = Array.isArray(stage.tasks) ? stage.tasks : [];\n    const allDone = tasks.every(t => this.isTaskDone(npcId, t));\n    if (allDone){\n      const finishedIndex = npc.stageIndex|0;\n      npc.stageIndex = finishedIndex + 1;\n      save();\n      emit('stage-complete', { npcId, stageIndex: finishedIndex });\n      emit('stage-changed',  { npcId, stageIndex: npc.stageIndex });\n      return true;\n    }\n    return false;\n  },\n  // –î–û–ë–ê–í–¨ –≤–Ω—É—Ç—Ä—å export const QuestState = { ... }\n\n  /** –í—Å–µ –∑–∞–¥–∞—á–∏ —Ç–µ–∫—É—â–µ–π —Å—Ç–∞–¥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã? */\n  isStageComplete(npcId){\n    const npcDef = getAllNPC().find(n => n.id === npcId);\n    if (!npcDef) return false;\n    const stIx = ensureNpc(npcId).stageIndex | 0;\n    const stage = npcDef.stages?.[stIx];\n    if (!stage) return false;\n    const tasks = Array.isArray(stage.tasks) ? stage.tasks : [];\n    return tasks.every(t => this.isTaskDone(npcId, t));\n  },\n\n  /** –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—Ä–≤–æ–π —Å—á–∏—Ç–∞–µ–º–æ–π –∑–∞–¥–∞—á–∏ —Ç–µ–∫—É—â–µ–π —Å—Ç–∞–¥–∏–∏ (–¥–ª—è —Ö–µ–¥–µ—Ä–∞ –º–æ–¥–∞–ª–∫–∏) */\n  getHeaderProgress(npcId){\n    const npcDef = getAllNPC().find(n => n.id === npcId);\n    if (!npcDef) return { cur:0, goal:0, task:null };\n    const stIx = ensureNpc(npcId).stageIndex | 0;\n    const stage = npcDef.stages?.[stIx];\n    if (!stage) return { cur:0, goal:0, task:null };\n\n    const pick = (stage.tasks||[]).find(t => !this.isTaskDone(npcId,t) && t.countGoal!=null)\n              || (stage.tasks||[]).find(t => t.countGoal!=null)\n              || null;\n\n    if (!pick) return { cur:0, goal:0, task:null };\n    const rec = (ensureNpc(npcId).tasks[pick.id]) || { count:0 };\n    const cur  = Math.min(rec.count|0, pick.countGoal|0);\n    const goal = pick.countGoal|0;\n    return { cur, goal, task: pick };\n  },\n\n  /** –ö–Ω–æ–ø–∫–∞ ¬´–ó–∞–±—Ä–∞—Ç–∏ –Ω–∞–≥–æ—Ä–æ–¥—É¬ª: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—Ç–∞–¥–∏–∏ –∏ –æ—á–∏—Å—Ç–∫–∞ –∑–∞–¥–∞—á. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç reward –∏–ª–∏ null. */\n  claimStageReward(npcId){\n    const npcDef = getAllNPC().find(n => n.id === npcId);\n    if (!npcDef) return null;\n    const npc = ensureNpc(npcId);\n    const stIx = npc.stageIndex | 0;\n    const stage = npcDef.stages?.[stIx];\n    if (!stage) return null;\n\n    const tasks = Array.isArray(stage.tasks) ? stage.tasks : [];\n    const allDone = tasks.every(t => this.isTaskDone(npcId, t));\n    if (!allDone) return null;\n\n    const reward = stage.reward || null;\n    npc.stageIndex = stIx + 1;\n    npc.tasks = {};                 // –æ—á–∏—Å—Ç–∏–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞—á\n    save();\n    emit('stage-claimed', { npcId, stageIndex: stIx });\n    emit('stage-changed', { npcId, stageIndex: npc.stageIndex });\n    return reward;\n  },\n\n\n  resetAll(){ _state = { npcs: {}, trackedNpcId: null }; save(); emit('reset'); }\n};\n\nexport default QuestState;\n","// src/quests/QuestRewards.js\nlet _sink = null;\n\n/** –°—Ü–µ–Ω–∞/HUD –º–æ–∂–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫—É–¥–∞ –ø–∞–¥–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã */\nexport function setRewardSink(fn){\n  _sink = (typeof fn === 'function') ? fn : null;\n}\n\n/** –í—ã–∑–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –Ω–∞–¥–æ –Ω–∞—á–∏—Å–ª–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É */\nexport function grantReward(reward){\n  if (!_sink || !reward) return;\n  try { _sink(reward); } catch {}\n}\n","// src/ui/QuestsModal.js\nimport UI from './theme.js';\nimport ModalHost from './ModalHost.js';\nimport PagedGrid from './PagedGrid.js';\nimport { getAllNPC } from '../data/QuestDB.js';\nimport { QuestState } from '../quests/QuestState.js';\nimport { grantReward } from '../quests/QuestRewards.js';\n\n/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ü—É–±–ª–∏—á–Ω—ã–π API ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\nexport function openQuestsModal(scene){\n  const host = ensureModalHost(scene);\n  new QuestsModal(scene, host).open();\n}\n\n/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ internals ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\nfunction ensureModalHost(scene){\n  if (!scene.__modalHost) {\n    const baseDepth = (UI.z?.modal ?? 2000);\n    scene.__modalHost = new ModalHost(scene, baseDepth);\n  }\n  return scene.__modalHost;\n}\n\n/* ============================================================== *\n *   –ö–í–ï–°–¢–´: –æ–∫–Ω–æ + –≥—Ä–∏–¥ –Ω–∞ PagedGrid, –¥–µ—Ç–∞–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –º–æ–¥–∞–ª–∫–µ *\n * ============================================================== */\nclass QuestsModal {\n  /** @param {Phaser.Scene} s @param {ModalHost} host */\n  constructor(s, host){\n    this.s = s; this.host = host;\n\n    // layout\n    this.cols = 3;\n    this.rows = 2;\n    this.gap  = 16;\n    this.headerH = 48;\n    this.pad = 18;\n    this.cardTargetW = 180;\n    this.cardTargetH = 208;\n\n    // –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ _measure()\n    this.cardW = 0; this.cardH = 0;\n    this.vw = 0; this.vh = 0;\n    this.winW = 0; this.winH = 0;\n    this.x0 = 0; this.y0 = 0;\n\n    // refs\n    this.root = null;\n    this.grid = null;\n\n    // handlers\n    this._resizeHandler = null;\n    this._keyLeft = null;\n    this._keyRight = null;\n  }\n\n  open(){\n    const api = this.host.open((root, modalApi) => {\n      this.root = root;\n\n      this._measure();\n      this._buildWindow();\n      this._buildGrid();\n\n      // –¥–∞–Ω–Ω—ã–µ\n      this.grid.setItems(getAllNPC());\n\n      this.s.input?.setTopOnly?.(true);\n\n      // –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞\nthis._onLeft  = () => this.grid.prev();\nthis._onRight = () => this.grid.next();\nthis.s.input.keyboard?.on('keydown-LEFT',  this._onLeft);\nthis.s.input.keyboard?.on('keydown-RIGHT', this._onRight);\n\n      // esc\n      modalApi.onEsc?.(()=> api.close());\n\n      // resize\n      this._resizeHandler = () => this._rebuild();\n      this.s.scale.on('resize', this._resizeHandler);\n    });\n\n    // –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π cleanup\n    const origClose = api.close;\n    api.close = () => { this._cleanup(); origClose(); };\n  }\n\n  /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ layout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\n  _measure(){\n    const sw = this.s.scale.width, sh = this.s.scale.height;\n\n    const maxW = Math.floor(sw * 0.9);\n    const maxH = Math.floor(sh * 0.86);\n\n    const baseVW = this.cardTargetW*this.cols + this.gap*(this.cols-1);\n    const baseVH = this.cardTargetH*this.rows + this.gap*(this.rows-1);\n    const dotsH  = 28;\n\n    const k = Math.min(\n      1,\n      (maxW - this.pad*2) / baseVW,\n      (maxH - (this.headerH + dotsH + this.pad)) / baseVH\n    );\n\n    this.cardW = Math.max(120, Math.floor(this.cardTargetW * k));\n    this.cardH = Math.max(140, Math.floor(this.cardTargetH * k));\n\n    this.vw = this.cardW*this.cols + this.gap*(this.cols-1);\n    this.vh = this.cardH*this.rows + this.gap*(this.rows-1);\n\n    this.winW = Math.min(this.vw + this.pad*2, maxW);\n    this.winH = Math.min(this.headerH + this.vh + dotsH + this.pad, maxH);\n\n    this.x0 = Math.round((sw - this.winW)/2);\n    this.y0 = Math.round((sh - this.winH)/2);\n  }\n\n_buildWindow(){\n  const s = this.s;\n  const sw = s.scale.width, sh = s.scale.height;\n\n  // --- FULLSCREEN BLOCKER: –ª–æ–≤–∏—Ç –∫–ª–∏–∫–∏/—Å–∫—Ä–æ–ª–ª –≤–µ–∑–¥–µ –ø–æ–¥ –º–æ–¥–∞–ª–∫–æ–π ---\n  this._screenBlock?.destroy();\n  this._screenBlock = s.add.zone(0, 0, sw, sh)\n    .setOrigin(0, 0)\n    .setScrollFactor?.(0)     // –µ—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –¥–≤–∏–≥–∞–µ—Ç—Å—è\n    .setInteractive({ useHandCursor:false });\n\n  const stop = ev => ev?.stopPropagation?.();\n  this._screenBlock.on('pointerdown', (_p,_lx,_ly,ev)=>stop(ev));\n  this._screenBlock.on('pointerup',   (_p,_lx,_ly,ev)=>stop(ev));\n  this._screenBlock.on('wheel',       (_p,_dx,_dy,ev)=>stop(ev));\n\n  // –∫–ª–∞–¥—ë–º –ü–ï–†–í–´–ú –≤ root\n  this.root.add(this._screenBlock);\n\n  // --- –¥–∞–ª—å—à–µ –∫–∞–∫ –±—ã–ª–æ ---\n  // –±–ª–æ–∫–µ—Ä –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å, –Ω–æ —É–∂–µ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)\n  this._panelHit?.destroy();\n  this._panelHit = s.add.zone(this.x0, this.y0, this.winW, this.winH)\n    .setOrigin(0,0).setInteractive({ useHandCursor:false });\n  this._panelHit.on('pointerdown', (_p,_lx,_ly,ev)=>stop(ev));\n  this._panelHit.on('pointerup',   (_p,_lx,_ly,ev)=>stop(ev));\n  this._panelHit.on('wheel',       (_p,_dx,_dy,ev)=>stop(ev));\n  this.root.add(this._panelHit);\n\n  const bg = s.add.graphics();\n    bg.fillStyle(UI.colors?.modalBg ?? 0x0f121a, 1)\n      .fillRoundedRect(this.x0, this.y0, this.winW, this.winH, 18);\n    bg.lineStyle(2, 0x2b3344, 1)\n      .strokeRoundedRect(this.x0, this.y0, this.winW, this.winH, 18);\n    this.root.add(bg);\n\n    const title = s.add.text(this.x0 + this.pad, this.y0 + this.pad, '–ö–≤–µ—Å—Ç–∏', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize: '20px', color:'#fff'\n    }).setOrigin(0,0);\n    this.root.add(title);\n\n    const closeBtn = s.add.text(this.x0 + this.winW - this.pad, this.y0 + this.pad, '‚úï', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize: '20px', color:'#a8b0be'\n    }).setOrigin(1,0).setInteractive({ useHandCursor:true });\n    closeBtn.on('pointerup', ()=> this.host.close(this.root));\n    this.root.add(closeBtn);\n  }\n\n  _buildGrid(){\n    const s = this.s;\n\n    this.grid = new PagedGrid(s, {\n      x: 0, y: 0,\n      cols: this.cols, rows: this.rows,\n      cellW: this.cardW, cellH: this.cardH, gap: this.gap,\n      showFrame: true,\n      makeCell: (npc, w, h) => this._makeNpcCard(npc, w, h),\n      makeStub: (w, h) => this._makeStub(w, h)\n    });\n\n    this.root.add(this.grid.root);\n    this.grid.setPosition(this.x0 + this.pad, this.y0 + this.headerH);\n    this.grid.setDepth((UI.z?.modal ?? 2000) + 1);\n  }\n\n  _rebuild(){\n    const page = this.grid?.pageIndex || 0;\n    this.grid?.destroy();\n    this.root?.removeAll(true);\n\n    this._measure();\n    this._buildWindow();\n    this._buildGrid();\n    this.grid.setItems(getAllNPC()).goTo(page, true);\n  }\n\n_cleanup(){\n  this.s.scale.off('resize', this._resizeHandler);\n  this.s.input.keyboard?.off('keydown-LEFT',  this._onLeft);\n  this.s.input.keyboard?.off('keydown-RIGHT', this._onRight);\n  this._onLeft = this._onRight = null;\n\n  this._screenBlock?.destroy(); this._screenBlock = null;\n  this._panelHit?.destroy();    this._panelHit   = null;   // <- —Ñ–∏–∫—Å–∏–º his ‚Üí this\n\n  this.grid?.destroy(); this.grid = null;\n  this.root = null;\n}\n\n  /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –∫–∞—Ä—Ç–æ—á–∫–∞ NPC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\n  _makeNpcCard(npc, w, h){\n    const s = this.s;\n\n    const base = s.add.graphics();\n    base.fillStyle(0x161a22,1).fillRoundedRect(0,0,w,h,12);\n    base.lineStyle(2, 0x2b3344,1).strokeRoundedRect(0,0,w,h,12);\n\n    const hover = s.add.graphics().setAlpha(0);\n    hover.lineStyle(2, UI.colors?.accent ?? 0x7ad7ff, 1).strokeRoundedRect(1,1,w-2,h-2,11);\n\n    let portrait;\n    if (npc.portraitKey && s.textures.exists(npc.portraitKey)) {\n      portrait = s.add.image(w/2, 56, npc.portraitKey).setOrigin(0.5);\n      const max = 62;\n      portrait.setScale(Math.min(max/(portrait.width||max), max/(portrait.height||max)));\n    } else {\n      portrait = s.add.text(w/2, 56, 'üßë‚Äçü¶±', { fontSize:'38px' }).setOrigin(0.5);\n    }\n\n    const name = s.add.text(w/2, 108, npc.name, {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'14px', color:'#fff', wordWrap:{ width: w-20 }, align:'center'\n    }).setOrigin(0.5);\n\n    const stage = s.add.text(w/2, 136, this._stageLabel(npc.id), {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'12px', color:'#a8b0be'\n    }).setOrigin(0.5);\n\n    const c = s.add.container(0,0,[base,hover,portrait,name,stage]).setSize(w,h);\n    const isActive = QuestState.getTrackedNpcId?.() === npc.id;\n    if (isActive){\n      const star = s.add.text(w - 10, 8, '‚òÖ', { fontSize:'16px', color:'#7ad7ff' }).setOrigin(1,0);\n      c.add(star);\n    }\nconst hit = s.add.zone(0, 0, w, h).setOrigin(0, 0).setInteractive({ useHandCursor: true });\nc.add(hit);\n\n// –•–æ–≤–µ—Ä—ã –∏ –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ –∑–æ–Ω—É\nhit.on('pointerover', () => { hover.setAlpha(1); c.setScale(1.02); c.y -= 2; });\nhit.on('pointerout',  () => { hover.setAlpha(0); c.setScale(1.00); c.y += 2; });\nhit.on('pointerup',   () => openQuestDetailsModal(this.s, npc));\n\n    return c;\n  }\n\n  _makeStub(w,h){\n    const g = this.s.add.graphics();\n    g.fillStyle(0x0d111a,0.6).fillRoundedRect(0,0,w,h,12);\n    g.lineStyle(2,0x2b3344,1).strokeRoundedRect(0,0,w,h,12);\n    const t = this.s.add.text(w/2,h/2,'‚Äî',{\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'18px', color:'#495065'\n    }).setOrigin(0.5);\n    return this.s.add.container(0,0,[g,t]).setSize(w,h);\n  }\n\n  _stageLabel(npcId){\n    const st = QuestState.getActiveStage(npcId);\n    return st ? st.name : '–ó–∞–≤–µ—Ä—à–µ–Ω–æ';\n  }\n}\n\n/* ============================================================== *\n *   –ú–û–î–ê–õ–ö–ê –î–ï–¢–ê–õ–ï–ô NPC (–ø–æ—Ä—Ç—Ä–µ—Ç, –∑–∞–¥–∞—á–∏, –Ω–∞–≥—Ä–∞–¥—ã)               *\n * ============================================================== */\nexport function openQuestDetailsModal(scene, npc){\n  const host = ensureModalHost(scene);\n  const s = scene;\n\n  host.open((root, api) => {\n    const sw = s.scale.width, sh = s.scale.height;\n    const winW = Math.min(720, Math.floor(sw * 0.78));\n    const winH = Math.min(560, Math.floor(sh * 0.78));\n    const x0 = Math.round((sw - winW)/2);\n    const y0 = Math.round((sh - winH)/2);\n    const pad = 18;\n    s.input?.setTopOnly?.(true);\n\n    // –∫–ª–∏–∫–æ- –∏ —Å–∫—Ä–æ–ª–ª-–±–ª–æ–∫–µ—Ä –ø–æ –æ–±–ª–∞—Å—Ç–∏ –æ–∫–Ω–∞ –¥–µ—Ç–∞–ª–µ–π\nconst panelHit = s.add.zone(x0, y0, winW, winH)\n  .setOrigin(0, 0)\n  .setInteractive({ useHandCursor:false });\npanelHit.on('pointerdown', (_p,_lx,_ly,ev)=>ev?.stopPropagation?.());\npanelHit.on('pointerup',   (_p,_lx,_ly,ev)=>ev?.stopPropagation?.());\npanelHit.on('wheel',       (_p,_dx,_dy,ev)=>ev?.stopPropagation?.());\nroot.add(panelHit);\n\n    // –æ–∫–Ω–æ\n    const bg = s.add.graphics();\n    bg.fillStyle(UI.colors?.modalBg ?? 0x0f121a, 1)\n      .fillRoundedRect(x0, y0, winW, winH, 16);\n    bg.lineStyle(2, 0x2b3344, 1)\n      .strokeRoundedRect(x0, y0, winW, winH, 16);\n    root.add(bg);\n\n    const title = s.add.text(x0 + pad, y0 + pad, '–î–µ—Ç–∞–ª—ñ –∫–≤–µ—Å—Ç—ñ–≤', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'18px', color:'#fff'\n    }).setOrigin(0,0); root.add(title);\n\n    const closeBtn = s.add.text(x0 + winW - pad, y0 + pad, '‚úï', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'18px', color:'#a8b0be'\n    }).setOrigin(1,0).setInteractive({ useHandCursor:true });\n closeBtn.on('pointerdown', (_p,_lx,_ly,ev)=>ev?.stopPropagation?.());\ncloseBtn.on('pointerup',   (p,_lx,_ly,ev)=>{ ev?.stopPropagation?.(); api.close(); });\nroot.add(closeBtn);\n\n    // ¬´–ê–∫—Ç–∏–≤–Ω—ã–π¬ª –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å\n    const isActive = QuestState.getTrackedNpcId() === npc.id;\n    const actBtn = s.add.text(x0 + winW - pad - 140, y0 + pad, isActive ? '–ê–∫—Ç–∏–≤–Ω–∏–π' : '–ó—Ä–æ–±–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω–∏–º', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'14px',\n      color: isActive ? '#7ad7ff' : '#ffffff'\n    }).setOrigin(0,0).setInteractive({ useHandCursor:true });\n    actBtn.on('pointerup', ()=>{\n      QuestState.setTrackedNpcId(npc.id);\n      actBtn.setText('–ê–∫—Ç–∏–≤–Ω–∏–π').setColor('#7ad7ff');\n      s.showToast?.('–ö–≤–µ—Å—Ç –∑—Ä–æ–±–ª–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω–∏–º');\n    });\n    root.add(actBtn);\n\n    // –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä\n    const cont = s.add.container(x0 + pad, y0 + 54); root.add(cont);\n\n    // —à–∞–ø–∫–∞ NPC\n    const head = s.add.graphics();\n    head.fillStyle(0x161a22,1).fillRoundedRect(0,0,winW - pad*2, 96, 12);\n    head.lineStyle(2,0x2b3344,1).strokeRoundedRect(0,0,winW - pad*2, 96, 12);\n    cont.add(head);\n\n    let avatar;\n    if (npc.portraitKey && s.textures.exists(npc.portraitKey)) {\n      avatar = s.add.image(46, 48, npc.portraitKey).setOrigin(0.5);\n      const max = 64;\n      avatar.setScale(Math.min(max/(avatar.width||max), max/(avatar.height||max)));\n    } else {\n      avatar = s.add.text(46, 48, 'üßë‚Äçü¶±', { fontSize:'42px' }).setOrigin(0.5);\n    }\n    cont.add(avatar);\n\n    const st = QuestState.getActiveStage(npc.id);\n    const stName = st ? st.name : '–£—Å—ñ —Å—Ç–∞–¥—ñ—ó –∑–∞–≤–µ—Ä—à–µ–Ω—ñ';\n\n    const name = s.add.text(90, 18, npc.name, {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'18px', color:'#fff'\n    }).setOrigin(0,0); cont.add(name);\n\n    const sub = s.add.text(90, 46, stName, {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'13px', color:'#a8b0be'\n    }).setOrigin(0,0); cont.add(sub);\n\n    // –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—Ä–≤–æ–π —Å—á–∏—Ç–∞–µ–º–æ–π –∑–∞–¥–∞—á–∏\n    const hp = QuestState.getHeaderProgress(npc.id);\n    if ((hp.goal|0) > 0){\n      const px = 90, py = 72, pw = winW - pad*2 - px - 16, ph = 10, r = 6;\n      const bar = s.add.graphics();\n      bar.fillStyle(0x0e1422,1).fillRoundedRect(px, py, pw, ph, r);\n      const ratio = Phaser.Math.Clamp((hp.cur||0)/(hp.goal||1), 0, 1);\n      bar.fillStyle(0x3aa3ff,1).fillRoundedRect(px, py, Math.max(2, Math.round(pw*ratio)), ph, r);\n      cont.add(bar);\n\n      const counter = s.add.text(px + pw, py + ph + 2, `${hp.cur}/${hp.goal}`, {\n        fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n        fontSize:'12px', color:'#a8b0be'\n      }).setOrigin(1,0);\n      cont.add(counter);\n    }\n\n    // –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º–∞—è –æ–±–ª–∞—Å—Ç—å\n    const innerY = 110;\n    const viewH  = winH - 54 - innerY - pad;\n    const maskG  = s.add.graphics();\n    maskG.fillStyle(0xffffff,1).fillRoundedRect(0, innerY, winW - pad*2, viewH, 12);\n    const mask = maskG.createGeometryMask(); maskG.setVisible(false);\n    root.add(maskG);\n\n    const scrollWrap = s.add.container(x0 + pad, y0 + 54).setMask(mask).setSize(winW - pad*2, viewH);\n    const body = s.add.container(0, innerY); scrollWrap.add(body);\n    root.add(scrollWrap);\n\n    // ‚Äî –∑–∞–¥–∞—á–∏\n    let y = 0;\n    const labelTasks = s.add.text(0, y, '–ó–∞–≤–¥–∞–Ω–Ω—è', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'14px', color:'#e0e6f1'\n    }).setOrigin(0,0); body.add(labelTasks); y += 24;\n\n    if (st?.tasks?.length){\n      for (const task of st.tasks){\n        const row = makeTaskRowUI(s, npc.id, task, winW - pad*2);\n        row.y = y; body.add(row); y += 44;\n      }\n    } else {\n      const none = s.add.text(0, y, '–ó–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—ñ', {\n        fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n        fontSize:'13px', color:'#a8b0be'\n      }).setOrigin(0,0); body.add(none); y += 22;\n    }\n\n    // ‚Äî –Ω–∞–≥—Ä–∞–¥–∞\n    y += 8;\n    const labelRw = s.add.text(0, y, '–ù–∞–≥–æ—Ä–æ–¥–∞', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'14px', color:'#e0e6f1'\n    }).setOrigin(0,0); body.add(labelRw); y += 28;\n\n    const chips = makeRewardChipsUI(s, st?.reward, winW - pad*2);\n    chips.y = y; body.add(chips); y += (chips.height || 30) + 8;\n\n    // ‚Äî –∫–Ω–æ–ø–∫–∞ ¬´–ó–∞–±—Ä–∞—Ç–∏ –Ω–∞–≥–æ—Ä–æ–¥—É¬ª\n    const ready = QuestState.isStageComplete(npc.id);\n    const claim = makeClaimButtonUI(\n      s,\n      0,            // x –≤–Ω—É—Ç—Ä–∏ body\n      y + 8,        // y\n      winW - pad*2, // –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–∞—è —à–∏—Ä–∏–Ω–∞\n      ready,\n      () => {\n        const rwd = QuestState.claimStageReward(npc.id);\n        if (rwd){\n          grantReward(rwd);\n          s.showToast?.('–ù–∞–≥–æ—Ä–æ–¥—É –æ—Ç—Ä–∏–º–∞–Ω–æ');\n          api.close();\n          openQuestDetailsModal(s, npc);\n        }\n      }\n    );\n    body.add(claim);\n    y += claim.height + 16;\n\n    body.setSize(winW - pad*2, y);\n\n    // –∫–æ–ª–µ—Å–æ ‚Äî —Å–∫—Ä–æ–ª–ª –∫–æ–Ω—Ç–µ–Ω—Ç–∞\n    scrollWrap.setInteractive(\n      new Phaser.Geom.Rectangle(0,0, winW - pad*2, winH - 54 - pad),\n      Phaser.Geom.Rectangle.Contains\n    );\n    let currentScroll = 0;\n    scrollWrap.on('wheel', (_p,_dx,dy,ev)=>{\n  ev?.stopPropagation?.();               // –Ω–µ –¥–∞—ë–º —Å–∫—Ä–æ–ª–ª—É –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ –≥—Ä–∏–¥–∞ –ø–æ–¥ –æ–∫–Ω–æ–º\n  const maxY = Math.max(0, (body.height||0) - viewH);\n  currentScroll = Phaser.Math.Clamp(currentScroll + (dy>0?30:-30), 0, maxY);\n  body.y = innerY - currentScroll;\n});\n    api.onEsc?.(()=> api.close());\n  });\n}\n\n/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ helpers (details) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\n\nfunction makeTaskRowUI(s, npcId, task, w){\n  const done = QuestState.isTaskDone(npcId, task);\n\n  const g = s.add.graphics();\n  g.fillStyle(0x1a2030,1).fillRoundedRect(0,0,w,36,10);\n  g.lineStyle(1,0x283146,1).strokeRoundedRect(0,0,w,36,10);\n\n  const check = s.add.text(10,18, done ? '‚úî' : '‚óã', {\n    fontSize:'16px', color: done ? '#7fff9f' : '#9aa3b6'\n  }).setOrigin(0,0.5);\n\n  const title = s.add.text(32,18, task.name || task.id, {\n    fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n    fontSize:'13px', color:'#fff'\n  }).setOrigin(0,0.5);\n\n  let prog = null, extra = '';\n  if (task.countGoal != null){\n    const rec = (QuestState.getNPC(npcId).tasks[task.id]) || {count:0};\n    const cur = Math.min(rec.count|0, task.countGoal|0);\n    const ratio = task.countGoal ? cur / task.countGoal : 0;\n    extra = `${cur}/${task.countGoal}`;\n\n    prog = s.add.graphics();\n    const px = w - 112, py = 12, pw = 92, ph = 12, r = 6;\n    prog.fillStyle(0x0e1422,1).fillRoundedRect(px, py, pw, ph, r);\n    prog.fillStyle(0x3aa3ff,1).fillRoundedRect(px, py, Math.max(2, Math.round(pw*ratio)), ph, r);\n  }\n\n  const right = s.add.text(w-10, 18, extra, {\n    fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n    fontSize:'12px', color:'#a8b0be'\n  }).setOrigin(1,0.5);\n\n  const children = [g, check, title, right];\n  if (prog) children.push(prog);\n\n  const row = s.add.container(0,0,children).setSize(w,36);\n  row.setInteractive(new Phaser.Geom.Rectangle(0,0,w,36), Phaser.Geom.Rectangle.Contains);\n  row.on('pointerover', ()=> g.setAlpha(0.95));\n  row.on('pointerout',  ()=> g.setAlpha(1));\n  return row;\n}\n\nfunction makeRewardChipsUI(s, rwd, maxW){\n  const cont = s.add.container(0,0);\n  let x = 0, y = 0, gap = 8;\n\n  const chips = [];\n  const push = (text) => {\n    const padX = 10, h = 24;\n    const t = s.add.text(0, h/2, text, {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'12px', color:'#dfe7f5'\n    }).setOrigin(0,0.5);\n\n    const bg = s.add.graphics();\n    const w = Math.round(t.width + padX*2);\n    bg.fillStyle(0x1b2334,1).fillRoundedRect(0,0,w,h,12);\n    bg.lineStyle(1,0x2a3852,1).strokeRoundedRect(0,0,w,h,12);\n\n    const chip = s.add.container(0,0,[bg,t]).setSize(w,h);\n    chips.push(chip);\n  };\n\n  if (rwd?.wallet?.coins)        push(`ü™ô –ú–æ–Ω–µ—Ç–∏ +${rwd.wallet.coins}`);\n  if (rwd?.wallet?.gold)         push(`‚≠ê –ó–æ–ª–æ—Ç–æ +${rwd.wallet.gold}`);\n  if (rwd?.perks?.skillPoints)   push(`üí° –û—á–∫–∏ –Ω–∞–≤–∏—á–æ–∫ +${rwd.perks.skillPoints}`);\n  if (rwd?.perks?.perkId)        push(`üéØ –ü–µ—Ä–∫: ${rwd.perks.perkId}`);\n  if (Array.isArray(rwd?.items)) for (const it of rwd.items) push(`üéÅ ${it.id} √ó${it.count}`);\n  if (!chips.length)             push('‚Äî');\n\n  for (const chip of chips){\n    if (x + chip.width > maxW) { x = 0; y += 30; }\n    chip.setPosition(x, y + 12);\n    cont.add(chip);\n    x += chip.width + gap;\n  }\n\n  cont.setSize(maxW, y + 28);\n  return cont;\n}\n\nfunction makeClaimButtonUI(s, x, y, maxW, enabled, onClick){\n  const label = '–ó–∞–±—Ä–∞—Ç–∏ –Ω–∞–≥–æ—Ä–æ–¥—É';\n  const padX = 14, h = 36, r = 10;\n\n  const t = s.add.text(0, 0, `üéÅ ${label}`, {\n    fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n    fontSize:'13px', color:'#ffffff'\n  }).setOrigin(0.5);\n\n  const w = Math.max(188, Math.min(maxW, Math.ceil(t.width + padX*2)));\n\n  const bg = s.add.graphics();\n  const fill   = enabled ? 0x2b7a3f : 0x33424f;\n  const stroke = enabled ? 0x71d48a : 0x2a3852;\n  bg.fillStyle(fill, 1).fillRoundedRect(-w/2, -h/2, w, h, r);\n  bg.lineStyle(1, stroke, 1).strokeRoundedRect(-w/2, -h/2, w, h, r);\n\n  const c = s.add.container(x + w/2, y + h/2, [bg, t]).setSize(w, h);\n  c.height = h;\n\n  const hit = s.add.zone(0, 0, w, h).setOrigin(0.5).setInteractive({ useHandCursor: enabled });\n  const stop = (_p,_lx,_ly,ev)=>ev?.stopPropagation?.();\n\n  hit.on('pointerdown',      stop);\n  hit.on('pointerupoutside', stop);\n  hit.on('pointermove',      stop);\n  hit.on('wheel',            stop);\n\n  if (enabled){\n    hit.on('pointerover', ()=> bg.setAlpha(0.92));\n    hit.on('pointerout',  ()=> bg.setAlpha(1));\n    hit.on('pointerup',   (p,lx,ly,ev)=>{ stop(p,lx,ly,ev); onClick?.(); });\n  } else {\n    hit.on('pointerup',   (p,lx,ly,ev)=>{ stop(p,lx,ly,ev); s.showToast?.('–ó–∞–≤–µ—Ä—à—ñ—Ç—å —É—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è'); });\n  }\n\n  c.add(hit);\n  return c;\n}\n\n","// src/ui/ActiveQuestHUD.js\nimport UI from './theme.js';\nimport { getAllNPC } from '../data/QuestDB.js';\nimport { QuestState } from '../quests/QuestState.js';\nimport { openQuestsModal, openQuestDetailsModal } from './QuestsModal.js';\n\nexport class ActiveQuestHUD {\n  constructor(s, opts = {}) {\n    this.s = s;\n    this.onOpen = typeof opts.onOpen === 'function' ? opts.onOpen : null;\n\n    // ‚îÄ‚îÄ‚îÄ –±–∞–∑–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    this.w = Math.max(220, (opts.width | 0) || 280);\n    this.h = 64;\n\n    // ‚îÄ‚îÄ‚îÄ –ø–∞–ª–∏—Ç—Ä–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    this._col = {\n      panel:   (UI.colors?.panelSubBg ?? UI.color?.panel ?? 0x121722),\n      stroke:  0x2b3344,\n      barBg:   0x0e1422,\n      barFg:   0x3aa3ff,\n      barFgReady: 0x39c26d,\n      text:    '#ffffff',\n      sub:     '#a8b0be',\n      ok:      '#93f5b9',\n      ddRow:   0x121826,\n      ddRowHover: 0x1a2333,\n      footerBg: 0x0f1521\n    };\n\n    // ‚îÄ‚îÄ‚îÄ —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    this._tune = { barBottom: 18, ddTextTop: 8, rootHitPad: 10 };\n\n    // ‚îÄ‚îÄ‚îÄ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    this.isOpen = false;          // –æ—Ç–∫—Ä—ã—Ç –ª–∏ –¥—Ä–æ–ø-–¥–∞—É–Ω\n    this._toggleLock = 0;         // –∞–Ω—Ç–∏-–¥—Ä–µ–±–µ–∑–≥\n    this._ignoreNextUp = false;   // —á—Ç–æ–±—ã –∫–ª–∏–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º –Ω–µ —É–ª–µ—Ç–∞–ª–∏ –≤ root\n    this._lastKey = '';\n    this._nextPollT = 0;\n    this._lastProgress = { cur: 0, goal: 0, ready: false };\n\n    // ‚îÄ‚îÄ‚îÄ –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä HUD –ø–æ–≤–µ—Ä—Ö –º–∏—Ä–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    const baseZ = (UI.z?.wallet ?? 952);\n    this.root = s.add.container((opts.x|0)||0, (opts.y|0)||0).setSize(this.w, this.h);\n    this.root.setDepth(baseZ + 1);\n\n    // —Ñ–æ–Ω + —Ä–∞–º–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏\n    this.bg = s.add.graphics(); this._paintPanel();\n\n    // –∞–≤–∞—Ç–∞—Ä\n    this.avatar = s.add.text(18, this.h/2, 'üßë‚Äçü¶±', { fontSize:'26px' }).setOrigin(0.5);\n\n    // –∑–∞–≥–æ–ª–æ–≤–∫–∏\n    this.title = s.add.text(44, 8, '‚Äî', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'14px', color:this._col.text\n    }).setOrigin(0,0);\n    this.sub = s.add.text(44, 24, '‚Äî', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'12px', color:this._col.sub\n    }).setOrigin(0,0);\n\n    // —Å—Ç—Ä–µ–ª–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥—Ä–æ–ø–∞\n    this.chev = s.add.text(this.w - 28, 6, '‚ñæ', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'14px', color:'#a8b0be'\n    }).setOrigin(0,0).setInteractive({ useHandCursor:true });\n\n    // –ø—Ä–æ–≥—Ä–µ—Å—Å\n    this.pbar = s.add.graphics();\n    this.ptext = s.add.text(this.w - 10, this.h - 10, '', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'11px', color:this._col.sub\n    }).setOrigin(1,1);\n\n    // –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–ö–≤–µ—Å—Ç–∏¬ª —Å–ø—Ä–∞–≤–∞\n    // —Å–æ–±—Ä–∞—Ç—å\n    this.root.add([this.bg, this.avatar, this.title, this.sub, this.pbar, this.ptext, this.chev,]);\n\n    // –¥—Ä–æ–ø-–¥–∞—É–Ω (–ø–æ–¥ –∫–∞—Ä—Ç–æ—á–∫–æ–π, –ø—Ä–∏–∂–∞—Ç –±–µ–∑ –∑–∞–∑–æ—Ä–∞)\n    this.ddWrap = s.add.container(0, this.h - 2).setVisible(false).setAlpha(0);\n    this.root.add(this.ddWrap);\n    this.ddBg = s.add.graphics(); this.ddWrap.add(this.ddBg);\n    this._ddRows = [];\n    this._ddShadow = null;\n\n    // —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –≤—Å–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏ (—Ç–æ–≥–≥–ª –¥—Ä–æ–ø–∞)\n    this._updateHitArea();\n\n    // ‚îÄ‚îÄ‚îÄ –∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    // 1) –≤—Å—è –∫–∞—Ä—Ç–æ—á–∫–∞ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç –¥—Ä–æ–ø-–¥–∞—É–Ω\n    this.root.on('pointerup', () => {\n      if (this._ignoreNextUp) { this._ignoreNextUp = false; return; }\n      if (this.s.time.now < this._toggleLock) return;\n      this._toggleLock = this.s.time.now + 150;\n      this._toggleDropdown();\n    });\n\n    // 2) –∫–ª–∏–∫ –ø–æ —Å—Ç—Ä–µ–ª–∫–µ ‚Äî —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç (–∏ –Ω–µ –ø—Ä–æ–±–∏–≤–∞–µ—Ç –Ω–∞ root)\n    this.chev.on('pointerup', (p,lx,ly,ev)=>{ ev?.stopPropagation?.(); this._ignoreNextUp = true; this._toggleDropdown(); });\n\n    // –ø–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä + –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–æ–≤\n    this.refresh(true);\n    this._onQuestEvt = () => { this.refresh(true); if (this.ddWrap.visible) this._buildDropdown(); };\n    window.addEventListener('quest-progress', this._onQuestEvt);\n  }\n\n  /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ public ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\n  setPosition(x,y){ this.root?.setPosition(x,y); return this; }\n  setVisible(v){ this.root?.setVisible(!!v); return this; }\n\n  setWidth(w){\n    const newW = Math.max(220, w|0);\n    if (newW === this.w) return this;\n    this.w = newW;\n\n    this.root?.setSize(this.w, this.h);\n    this._updateHitArea();\n    this._paintPanel();\n\n    // –ø—Ä–∞–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã\n    this.ptext.setX(this.w - 10);\n    this.chev.setX(this.w - 28);\n\n    // –∫–Ω–æ–ø–∫–∞ ¬´–ö–≤–µ—Å—Ç–∏¬ª –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–∏–∂–∞—Ç–æ–π –≤–ø—Ä–∞–≤–æ\n    this.openBtn?.setPosition(this.w - 12, 10);\n\n    this._drawProgress(this._lastProgress.cur, this._lastProgress.goal, this._lastProgress.ready);\n    if (this.ddWrap.visible) this._buildDropdown();\n    return this;\n  }\n\n  update(){\n    const now = this.s.time.now|0;\n    if (now < this._nextPollT) return;\n    this._nextPollT = now + 500;\n    this.refresh(false);\n  }\n\n  refresh(force=false){\n    const pick = _pickTrackedQuest();\n    const key = pick\n      ? `${pick.npc.id}|${pick.stage.id}|${pick.task?.id||'none'}|${pick.cur}/${pick.goal}|${pick.ready?'1':'0'}`\n      : 'none';\n    if (!force && key === this._lastKey) return;\n    this._lastKey = key;\n\n    if (!pick){\n      this._ensureAvatarText();\n      this.avatar.setText('üß©');\n      this.title.setText('–ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–≤–µ—Å—Ç—ñ–≤');\n      this.sub.setText('–í—ñ–¥–∫—Ä–∏–π ¬´–ö–≤–µ—Å—Ç–∏¬ª, —â–æ–± –ø–æ—á–∞—Ç–∏');\n      this._drawProgress(0,0,false);\n      if (this.ddWrap.visible) this._buildDropdown();\n      return;\n    }\n\n    // –∞–≤–∞—Ç–∞—Ä\n    if (pick.npc.portraitKey && this.s.textures.exists(pick.npc.portraitKey)){\n      if (this.avatar?.type === 'Text'){\n        this.avatar.destroy();\n        this.avatar = this.s.add.image(18, this.h/2, pick.npc.portraitKey).setOrigin(0.5);\n        this.root.addAt(this.avatar, 1);\n      } else {\n        this.avatar.setTexture(pick.npc.portraitKey);\n      }\n      const max = 28;\n      const sc = Math.min(max/(this.avatar.width||max), max/(this.avatar.height||max));\n      this.avatar.setScale(sc);\n    } else {\n      this._ensureAvatarText();\n      this.avatar.setText('üßë‚Äçü¶±');\n    }\n\n    this.title.setText(pick.npc.name);\n    this.sub.setText(pick.task ? pick.task.name : pick.stage.name);\n    this._drawProgress(pick.cur, pick.goal, pick.ready);\n\n    if (this.ddWrap.visible) this._buildDropdown();\n  }\n\n  /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ layout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\n  _updateHitArea(){\n    const p = this._tune.rootHitPad;\n    const rect = new Phaser.Geom.Rectangle(-p, -p, this.w + p*2, this.h + p*2);\n    this.root.setSize(this.w, this.h);\n    if (this.root.input) this.root.removeInteractive();\n    this.root.setInteractive(rect, Phaser.Geom.Rectangle.Contains);\n  }\n\n  _paintPanel(){\n    this.bg.clear();\n    this.bg.fillStyle(this._col.panel,1).fillRoundedRect(0,0,this.w,this.h,12);\n    this.bg.lineStyle(2, this._col.stroke,1).strokeRoundedRect(0,0,this.w,this.h,12);\n  }\n\n  _drawProgress(cur, goal, ready=false){\n    this._lastProgress = { cur:cur|0, goal:goal|0, ready:!!ready };\n    const x = 44, w = this.w - x - 96 /* –æ—Å—Ç–∞–≤–ª—è–µ–º –º–µ—Å—Ç–æ –ø–æ–¥ –∫–Ω–æ–ø–∫—É */, h = 8, r = 4;\n    const y = this.h - this._tune.barBottom;\n\n    const ratio = goal ? Phaser.Math.Clamp(cur/goal, 0, 1) : 0;\n    this.pbar.clear();\n    this.pbar.fillStyle(this._col.barBg,1).fillRoundedRect(x,y,w,h,r);\n    this.pbar.fillStyle(ready ? this._col.barFgReady : this._col.barFg,1)\n      .fillRoundedRect(x,y, Math.max(2, Math.round(w*ratio)), h, r);\n\n    this.ptext.setPosition(this.w - 12 - 88 /* btnW */, y + h).setOrigin(1,1);\n\n    if (ready) this.ptext.setText('‚úì –ì–æ—Ç–æ–≤–æ').setColor(this._col.ok);\n    else       this.ptext.setText(goal ? `${cur}/${goal}` : '').setColor(this._col.sub);\n  }\n\n  /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ dropdown ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\n  _toggleDropdown(){ this.isOpen ? this._closeDropdown() : this._openDropdown(); }\n\n  _openDropdown(){\n    if (this.isOpen) return;\n    this._buildDropdown();\n    this.ddWrap.setVisible(true).setAlpha(0);\n    this.s.tweens.add({ targets:this.ddWrap, alpha:1, duration:120, ease:'Cubic.Out' });\n    this.isOpen = true;\n    this.chev?.setText?.('‚ñ¥');\n    // –í–ê–ñ–ù–û: –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö ¬´—â–∏—Ç–∫–æ–≤¬ª –∏ –∫–ª–∏–∫–æ–≤ –≤–Ω–µ ‚Äî –¥—Ä–æ–ø –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º,\n    // –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –ª–æ–≤–∏—Ç—å —Ä—ã–±—É, UI –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–∏—Ä.\n  }\n\n  _closeDropdown(immediately=false){\n    if (!this.isOpen) return;\n    const finish = () => { this.ddWrap.setVisible(false).setAlpha(0); };\n    if (immediately) finish();\n    else this.s.tweens.add({ targets:this.ddWrap, alpha:0, duration:120, ease:'Cubic.Out', onComplete:finish });\n    this.isOpen = false;\n    this.chev?.setText?.('‚ñæ');\n  }\n\n_buildDropdown(){\n  const pick = _pickTrackedQuest();\n\n  // –æ—á–∏—Å—Ç–∫–∞\n  this._ddRows.forEach(r => r.destroy());\n  this._ddRows.length = 0;\n  this.ddBg.clear();\n  this._ddShadow?.destroy(); \n  this._ddShadow = null;\n\n  if (!pick || !pick.stage){\n    this.ddWrap.setVisible(false).setAlpha(0);\n    return;\n  }\n\n  const headerTaskId = pick.task?.id || null;\n  const tasks = Array.isArray(pick.stage.tasks) ? pick.stage.tasks : [];\n\n  // —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ (–±–µ–∑ —Ö–µ–¥–µ—Ä–∞)\n  const items = tasks\n    .filter(t => (t?.id || 'none') !== headerTaskId)\n    .map(t => {\n      const { cur, goal, done } = _taskProgress(pick.npc.id, t);\n      return { title: t.name || t.id, cur, goal, done, npc: pick.npc, isClaim:false };\n    });\n\n  // –µ—Å–ª–∏ —Å—Ç–∞–¥–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Äî –ø—É–Ω–∫—Ç ¬´–∑–∞–±–µ—Ä—ñ—Ç—å –Ω–∞–≥–æ—Ä–æ–¥—É¬ª —Å–≤–µ—Ä—Ö—É\n  if (QuestState.isStageComplete?.(pick.npc.id)){\n    items.unshift({\n      title:'–°—Ç–∞–¥—ñ—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ ‚Äî –∑–∞–±–µ—Ä—ñ—Ç—å –Ω–∞–≥–æ—Ä–æ–¥—É',\n      cur:0, goal:0, done:true, npc:pick.npc, isClaim:true\n    });\n  }\n\n  // —Ä–∞–∑–º–µ—Ä—ã\n  const w     = this.w;\n  const rowH  = 40;\n  const pad   = 10;\n\n  // +1 —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥ ¬´–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤—Å—ñ –∫–≤–µ—Å—Ç–∏‚Ä¶¬ª\n  const totalH = (items.length + 1) * rowH + pad*2;\n\n  // —Ç–µ–Ω—å\n  this._ddShadow = this.s.add.graphics();\n  const rrShadow = { tl:0, tr:0, bl:14, br:14 };\n  this._ddShadow.fillStyle(0x000000, 0.22).fillRoundedRect(2, 6, w, totalH, rrShadow);\n  this.ddWrap.add(this._ddShadow);\n\n  // —Ñ–æ–Ω\n  const rr = { tl:0, tr:0, bl:12, br:12 };\n  this.ddBg.fillStyle(this._col.panel, 1).fillRoundedRect(0, 0, w, totalH, rr);\n  this.ddBg.lineStyle(2, this._col.stroke, 1).strokeRoundedRect(0, 0, w, totalH, rr);\n\n  // —Å—Ç—Ä–æ–∫–∏ –∑–∞–¥–∞—á\n  let y = pad;\n  for (const it of items){\n    const row = this._makeDDRow(it, w, rowH);\n    row.setPosition(0, y);\n    this.ddWrap.add(row);\n    this._ddRows.push(row);\n    y += rowH;\n  }\n\n  // —Ñ—É—Ç–µ—Ä ¬´–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤—Å—ñ –∫–≤–µ—Å—Ç–∏‚Ä¶¬ª\n  const openAllRow = this._makeOpenAllRow(w, rowH);\n  openAllRow.setPosition(0, y);\n  this.ddWrap.add(openAllRow);\n  this._ddRows.push(openAllRow);\n  y += rowH;\n\n  // –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä/–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤\n  this.ddWrap.setSize(w, totalH);\n  if (this.ddWrap.input) this.ddWrap.removeInteractive();\n  this.ddWrap.setInteractive(\n    new Phaser.Geom.Rectangle(0, 0, w, totalH),\n    Phaser.Geom.Rectangle.Contains\n  );\n}\n\n\n  _makeDDRow(it, w, h){\n    const s = this.s;\n    const g = s.add.graphics();\n    const baseCol  = it.isClaim ? 0x1d2b21 : this._col.ddRow;\n    const hoverCol = it.isClaim ? 0x274a2a : this._col.ddRowHover;\n    g.fillStyle(baseCol,1).fillRoundedRect(4,2, w-8, h-4, 10);\n\n    const textTop = this._tune.ddTextTop;\n    const iconY   = textTop + 6;\n\n    const left = s.add.text(10, iconY, it.isClaim ? 'üéÅ' : (it.done ? '‚úî' : '‚Ä¢'), {\n      fontSize:'14px', color: it.isClaim ? this._col.ok : (it.done ? this._col.ok : '#8aa1c2')\n    }).setOrigin(0,0.5);\n\n    const title = s.add.text(24, textTop, it.title, {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n      fontSize:'12px', color:'#ffffff', wordWrap:{ width: w - 24 - 60 }\n    }).setOrigin(0,0);\n\n    const bar = s.add.graphics();\n    if (!it.isClaim){\n      const barX = 24, barW = w - 24 - 54, barY = h - 10;\n      const ratio = it.goal ? Phaser.Math.Clamp(it.cur/it.goal, 0, 1) : 0;\n      bar.fillStyle(this._col.barBg,1).fillRoundedRect(barX, barY, barW, 6, 3);\n      bar.fillStyle((it.goal && it.cur>=it.goal) ? this._col.barFgReady : this._col.barFg,1)\n        .fillRoundedRect(barX, barY, Math.max(2, Math.round(barW*ratio)), 6, 3);\n    }\n\n    const right = s.add.text(\n      w-10, iconY, it.isClaim ? '‚úì' : (it.goal ? `${it.cur}/${it.goal}` : ''),\n      { fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif', fontSize:'11px', color: it.isClaim ? this._col.ok : this._col.sub }\n    ).setOrigin(1,0.5);\n\n    const row = s.add.container(0,0,[g,left,title,bar,right]).setSize(w,h);\n    row.setInteractive(new Phaser.Geom.Rectangle(0,0,w,h), Phaser.Geom.Rectangle.Contains)\n      .on('pointerover', ()=> g.fillStyle(hoverCol,1).fillRoundedRect(4,2,w-8,h-4,10))\n      .on('pointerout',  ()=> g.fillStyle(baseCol,1).fillRoundedRect(4,2,w-8,h-4,10));\n\n    row.on('pointerup', (p,lx,ly,ev)=>{\n      ev?.stopPropagation?.();\n      this._ignoreNextUp = true;\n      this._hideDropdown(true); // –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏ –¥—Ä–æ–ø —Å–∫—Ä—ã–≤–∞–µ–º\n      QuestState.setTrackedNpcId?.(it.npc.id);\n      openQuestDetailsModal(this.s, it.npc);\n    });\n\n    return row;\n  }\n_makeOpenAllRow(w, h){\n  const s = this.s;\n\n  const g = s.add.graphics();\n  const baseCol  = this._col.ddRow;\n  const hoverCol = this._col.ddRowHover;\n  g.fillStyle(baseCol, 1).fillRoundedRect(4, 2, w-8, h-4, 10);\n\n  const title = s.add.text(14, h/2, '–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤—Å—ñ –∫–≤–µ—Å—Ç–∏‚Ä¶', {\n    fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n    fontSize:'12px', color:'#ffffff'\n  }).setOrigin(0,0.5);\n\n  const chevron = s.add.text(w-12, h/2, '‚Ä∫', {\n    fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif',\n    fontSize:'14px', color:this._col.sub\n  }).setOrigin(1,0.5);\n\n  const row = s.add.container(0,0,[g,title,chevron]).setSize(w,h);\n  row.setInteractive(new Phaser.Geom.Rectangle(0,0,w,h), Phaser.Geom.Rectangle.Contains);\n  row.input.cursor = 'pointer';\n\n  row.on('pointerover', () => g.clear().fillStyle(hoverCol,1).fillRoundedRect(4,2,w-8,h-4,10));\n  row.on('pointerout',  () => g.clear().fillStyle(baseCol,1).fillRoundedRect(4,2,w-8,h-4,10));\n\n  row.on('pointerup', (p,lx,ly,ev) => {\n    ev?.stopPropagation?.();\n    this._ignoreNextUp = true;\n    this._hideDropdown(true);\n    openQuestsModal(this.s);\n  });\n\n  return row;\n}\n\n\n  _makeOpenAllFooter(w, h){\n    const s = this.s;\n    const g = s.add.graphics();\n    g.fillStyle(this._col.footerBg, 1).fillRoundedRect(4, 2, w-8, h-4, {tl:8,tr:8,bl:10,br:10});\n    g.lineStyle(1, 0x1c2432, 1).strokeRoundedRect(4, 2, w-8, h-4, {tl:8,tr:8,bl:10,br:10});\n\n    const t = s.add.text(14, h/2, '–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤—Å—ñ –∫–≤–µ—Å—Ç–∏‚Ä¶', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif', fontSize:'12px', color:'#c9d3e6'\n    }).setOrigin(0,0.5);\n\n    const chevron = s.add.text(w-16, h/2, '‚Ä∫', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif', fontSize:'16px', color:'#c9d3e6'\n    }).setOrigin(1,0.5);\n\n    const row = s.add.container(0,0,[g,t,chevron]).setSize(w,h);\n    row.setInteractive(new Phaser.Geom.Rectangle(0,0,w,h), Phaser.Geom.Rectangle.Contains)\n      .on('pointerover', ()=> g.setAlpha(0.92))\n      .on('pointerout',  ()=> g.setAlpha(1))\n      .on('pointerup',   (p,lx,ly,ev)=>{ ev?.stopPropagation?.(); this._ignoreNextUp = true; openQuestsModal(this.s); });\n\n    return row;\n  }\n\n  _hideDropdown(immediately=false){\n    if (!this.ddWrap.visible) return;\n    if (immediately){ this.ddWrap.setVisible(false).setAlpha(0); return; }\n    this.s.tweens.add({ targets:this.ddWrap, alpha:0, duration:120, ease:'Cubic.Out',\n      onComplete: ()=> this.ddWrap.setVisible(false)\n    });\n  }\n\n  _makeOpenAllBtn(){\n    const s = this.s;\n    const btnW = 88, btnH = 26, r = 12;\n    const cont = s.add.container(this.w - 12, 10); // –ø—Ä–∏–∂–∞—Ç –∫ –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω–µ–º—É —É–≥–ª—É –∫–∞—Ä—Ç–æ—á–∫–∏\n    const g = s.add.graphics();\n    const fill = UI.colors?.accent ?? 0x3aa3ff;\n    g.fillStyle(fill,1).fillRoundedRect(-btnW, 0, btnW, btnH, r);\n    g.lineStyle(1,0xffffff,0.15).strokeRoundedRect(-btnW, 0, btnW, btnH, r);\n    const t = s.add.text(-btnW/2, btnH/2, '–ö–≤–µ—Å—Ç–∏', {\n      fontFamily: UI.fonts?.ui || 'Inter, Arial, sans-serif', fontSize:'12px', color:'#ffffff'\n    }).setOrigin(0.5);\n\n    const hit = s.add.zone(-btnW, 0, btnW, btnH).setOrigin(0,0).setInteractive({ useHandCursor:true });\n    hit.on('pointerover', ()=> g.setAlpha(0.92));\n    hit.on('pointerout',  ()=> g.setAlpha(1));\n    hit.on('pointerup',   ()=>{ this._ignoreNextUp = true; (this.onOpen ? this.onOpen() : openQuestsModal(this.s)); });\n\n    cont.add([g,t,hit]);\n    cont.setSize(btnW, btnH);\n    return cont;\n  }\n\n  _ensureAvatarText(){\n    if (this.avatar && this.avatar.type !== 'Text'){\n      this.avatar.destroy();\n      this.avatar = this.s.add.text(18, this.h/2, 'üßë‚Äçü¶±', { fontSize:'26px' }).setOrigin(0.5);\n      this.root.addAt(this.avatar, 1);\n    }\n  }\n\n  destroy(){\n    try { window.removeEventListener('quest-progress', this._onQuestEvt); } catch(_){}\n    this.root?.removeAll(true);\n    this.root?.destroy();\n    this.root = null;\n  }\n}\n\n/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */\nfunction _taskProgress(npcId, task){\n  const done = QuestState.isTaskDone(npcId, task);\n  if (task.countGoal == null) return { cur:0, goal:0, done };\n  const rec = (QuestState.getNPC(npcId).tasks[task.id]) || { count:0 };\n  const cur  = Math.min(rec.count|0, task.countGoal|0);\n  const goal = task.countGoal|0;\n  return { cur, goal, done };\n}\n\nfunction _pickTrackedQuest(){\n  const npcs = getAllNPC();\n  const tracked = QuestState.getTrackedNpcId?.();\n  const scan = tracked ? npcs.filter(n => n.id === tracked) : npcs;\n\n  for (const npc of scan){\n    const stage = QuestState.getActiveStage(npc.id);\n    if (!stage) continue;\n\n    let task = null, cur = 0, goal = 0;\n    if (Array.isArray(stage.tasks) && stage.tasks.length){\n      task = stage.tasks.find(t => !QuestState.isTaskDone(npc.id, t)) || stage.tasks[0];\n      if (task?.countGoal != null){\n        const rec = (QuestState.getNPC(npc.id).tasks[task.id]) || { count:0 };\n        cur  = Math.min(rec.count|0, task.countGoal|0);\n        goal = task.countGoal|0;\n      }\n    }\n\n    const ready = QuestState.isStageComplete?.(npc.id) || (goal>0 && cur>=goal);\n    return { npc, stage, task, cur, goal, ready };\n  }\n  return null;\n}\n\nexport default ActiveQuestHUD;\n","// src/ui/TopHUD.js\nimport UI from './theme.js';\nimport { KeepnetBadge } from './KeepnetBadge.js';\nimport { ClockHUD } from './ClockHUD.js';\nimport { LevelBadge } from './LevelBadge.js';\nimport { DepthSonar } from './DepthSonar.js';\nimport { DepthCtrl } from './DepthCtrl.js';\nimport ActionDock from './ActionDock.js';\nimport { openQuestsModal } from './QuestsModal.js';\nimport { ActiveQuestHUD } from './ActiveQuestHUD.js';\n\nexport class TopHUD {\n  constructor(scene, opts = {}) {\n    this.s = scene;\n    this.opts = opts;\n    this.levelOffsetY = opts.levelOffsetY ?? 0;\n\n    this.getSlotsTop   = opts.getSlotsTop || null;\n    this.onDepthChange = opts.onDepthChange || null;\n    this.sonarCorner   = opts.sonarCorner || 'left';\n    this.rigDepthM     = (typeof opts.rigDepthM === 'number') ? opts.rigDepthM : 1.2;\n\n    // —Å–ª–µ–≤–∞\n    this.level  = new LevelBadge(scene, opts.progress);\n\n    // —Ü–µ–Ω—Ç—Ä\n    this.clock  = new ClockHUD(scene, opts.timeCycle, {\n      ringR: UI.rem(scene, 12),\n      ringTh: Math.max(2, Math.round(UI.rem(scene, 4))),\n      depth: (UI.z.wallet ?? 940) - 1\n    });\n\n    // —Å–ø—Ä–∞–≤–∞ (—Å–∞–¥–æ–∫)\n    this.keepnet = new KeepnetBadge(scene, opts.keepnetCapacity ?? 25, opts.onKeepnetClick);\n\n    // –∫–æ–º–±–æ–¥–æ–∫ (–±–∞–∑–∞/–ª–æ–∫–∞—Ü–∏–∏/–∫–æ—à–µ–ª—ë–∫/–ø–µ—Ä–∫–∏)\n    this.actionDock = new ActionDock(scene, {\n      onBase: () => opts.onGoBase?.(),\n      onLocationPick: (locId) => opts.onLocationPick?.(locId),\n      wallet: opts.wallet,\n      showPerks: true\n    });\n\n\n    // –ú–∏–Ω–∏-–∫–∞—Ä—Ç–æ—á–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞ (–∫–ª–∏–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª–∫—É)\n    this.activeQuest = new ActiveQuestHUD(scene, {\n      width: 230,\n      onOpen: () => openQuestsModal(scene)\n    });\n\n    // —Å–æ–Ω–∞—Ä + –≥–ª—É–±–∏–Ω–∞\n    this.sonar = new DepthSonar(scene, {\n      x: UI.layout.sonar.anchorX,\n      y: 0,\n      w: UI.layout.sonar.size.w,\n      h: UI.layout.sonar.size.h\n    });\n    this.depthCtrl = new DepthCtrl(\n      scene,\n      this.rigDepthM,\n      { x: 0, y: 0 },\n      (v) => { this.rigDepthM = v; this.onDepthChange?.(v); }\n    );\n    this.sonar.attachDepthCtrl(this.depthCtrl, UI.layout.sonar.depthAttachGap);\n\n    // –ª—ç–π–∞—É—Ç\n    this.layout = this.layout.bind(this);\n    this.layout();\n    scene.scale.on('resize', this.layout);\n  }\n\n  // –ø—É–±–ª–∏—á–Ω–æ–µ API\n  showSonarAt(x, y){ this.sonar?.show(x, y); }\n  hideSonar(){ this.sonar?.hide(); }\n  setSonarFollowX(v){ this.sonar?.setDotFollowX(!!v); }\n  setSonarFight(v){ this.sonar?.setFight(!!v); }\n  updateSonarDot(y, opts = {}){ this.sonar?.updateDot(y, opts); }\n\n  setWallet(coins, gold, perks=0){ this.actionDock?.setWallet(coins, gold, perks); }\n  setKeepnet(count, cap){ this.keepnet?.set(count|0, cap|0); }\n\n  update(){\n    this.clock.update();\n    this.activeQuest?.update();\n  }\n\n  layout(){\n    const W   = this.s.scale.width;\n    const gap = UI.rem(this.s, UI.layout.top.gap);\n    const m   = gap;\n\n    // —Ä–∞–∑–º–µ—Ä—ã —á–∞—Å–æ–≤ (–Ω—É–∂–Ω—ã –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ä—è–¥–∞)\n    this.clock.update(true);\n    const ckB = this.clock.getBounds?.() ?? new Phaser.Geom.Rectangle(0,0,180,40);\n\n    // —Ä–∞–∑–º–µ—Ä—ã –¥–æ–∫–∞ (–≤–µ—Ä—Ö–Ω–∏–π —Ä—è–¥)\n    const dockW = this.actionDock.w ?? 360;\n    const dockH = this.actionDock.h ?? 40;\n\n    // ===== ROW 1: ActionDock (—Ü–µ–Ω—Ç—Ä) + Keepnet (—Å–ø—Ä–∞–≤–∞) =====\n    const row1Y = m + Math.round(dockH/2);\n\n    // Keepnet —Å–ø—Ä–∞–≤–∞\n    const knW  = this.keepnet.w ?? 160;\n    const knH  = this.keepnet.h ?? 42;\n    const knX  = W - m - knW;\n    const knY  = Math.round(row1Y - knH/2);\n    this.keepnet.setPosition?.(knX, knY);\n\n    // –î–æ–∫ ‚Äî —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ —Ü–µ–Ω—Ç—Ä—É, –Ω–µ –≤—Ä–µ–∑–∞–µ—Ç—Å—è –≤ —Å–∞–¥–æ–∫\n    const maxRight = knX - gap;\n    const minLeft  = m;\n    let dockX = Math.round(W/2);\n    let left  = dockX - dockW/2;\n    let right = dockX + dockW/2;\n\n    if (right > maxRight) {\n      const shift = right - maxRight;\n      dockX -= shift; left -= shift; right -= shift;\n    }\n    if (left < minLeft) {\n      dockX = minLeft + Math.round(dockW/2);\n      left  = dockX - dockW/2; right = dockX + dockW/2;\n    }\n    this.actionDock.setPosition(dockX, row1Y);\n\n    // ---- –ê–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –º–µ–∂–¥—É –¥–æ–∫–æ–º –∏ —Å–∞–¥–∫–æ–º (–∏–ª–∏ –ø–æ–¥ —Å–∞–¥–æ–∫)\n    const aqMinW = 160;\n    const aqMaxW = 360;\n\n    const leftEdge  = right + gap;   // —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–æ–∫–∞\n    const rightEdge = knX - gap;     // –ø–µ—Ä–µ–¥ —Å–∞–¥–∫–æ–º\n    const avail     = Math.max(0, rightEdge - leftEdge);\n\n    if (avail >= aqMinW) {\n      // –ø–æ–º–µ—â–∞–µ–º –º–µ–∂–¥—É –¥–æ–∫–æ–º –∏ —Å–∞–¥–∫–æ–º\n      const useW = Math.min(aqMaxW, avail);\n      this.activeQuest.setWidth(useW);\n      const aqY = Math.round(row1Y - this.activeQuest.h/2);\n      this.activeQuest.setPosition(leftEdge, aqY).setVisible(true);\n    } else {\n      // –º–∞–ª–æ –º–µ—Å—Ç–∞ ‚Äî –ø–µ—Ä–µ–Ω–æ—Å–∏–º –ø–æ–¥ —Å–∞–¥–æ–∫\n      const underGap = Math.round(gap * 0.75);\n      const useW = Math.min(aqMaxW, Math.max(aqMinW, knW - gap));\n      this.activeQuest.setWidth(useW);\n      const centerX = knX + Math.round((knW - useW) / 2);\n      const aqY = row1Y + Math.ceil(knH/2) + underGap + Math.round(this.activeQuest.h/2);\n      this.activeQuest.setPosition(centerX, aqY).setVisible(true);\n    }\n\n    // ===== ROW 2: Clock (—Ü–µ–Ω—Ç—Ä) + Level (—Å–ª–µ–≤–∞) =====\n    const vgap   = Math.round(gap * 0.75);\n    const row2Y  = row1Y + Math.ceil(dockH/2) + vgap + Math.round(ckB.height/2);\n\n    // —á–∞—Å—ã —Å—Ç—Ä–æ–≥–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É\n    this.clock.setPosition(Math.round(W/2), row2Y);\n\n    // –ª–µ–≤—ã–π –±–µ–π–¥–∂ —É—Ä–æ–≤–Ω—è ‚Äî –ø–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–µ\n    const lvlY = Math.max(2, m + this.levelOffsetY);\n    this.level.setPosition?.(m, lvlY);\n\n    // –°–æ–Ω–∞—Ä ‚Äî –∫ –ª–∏–Ω–∏–∏ —Å–ª–æ—Ç–æ–≤\n    this.placeSonar(m, W);\n  }\n\n  placeSonar(m, W){\n    if (!this.sonar?.setPosition) return;\n\n    const baselineY = (typeof this.getSlotsTop === 'function')\n      ? (this.getSlotsTop() ?? Math.round(this.s.scale.height * 0.72))\n      : Math.round(this.s.scale.height * 0.72);\n\n    const raise  = UI.rem(this.s, UI.layout.sonar.raiseRem);\n    const sonarY = Math.round(baselineY - raise);\n\n    const sizeW   = UI.layout.sonar.size?.w ?? 240;\n    const xLeft   = UI.layout.sonar.anchorX|0;\n    const xRight  = Math.max(m, W - sizeW - m);\n    const x       = (this.sonarCorner === 'right') ? xRight : xLeft;\n\n    this.sonar.setPosition(x, sonarY);\n  }\n\n  destroy(){\n    this.s.scale.off('resize', this.layout);\n    this.activeQuest?.destroy();\n  }\n}\n\nexport default TopHUD;\n","// src/time/TimeCycle.js\nimport VM from '../vm.js';\n\n// –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Å—É—Ç–∫–∏ –∏–¥—É—Ç 60 —Ä–µ–∞–ª—å–Ω—ã—Ö –º–∏–Ω—É—Ç, —Ñ–∞–∑—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —á–∞—Å–∞–º\nexport const TimeCfgDefault = {\n  dayLengthMin: 10,          // 1 ¬´–∏–≥—Ä–æ–≤—ã–µ —Å—É—Ç–∫–∏¬ª = 60 –º–∏–Ω\n  startClock:   '06:01',     // –≤–æ —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–µ —Å—É—Ç–∫–∏\n  // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–∑ –ø–æ 24—á\n  schedule: {\n    dawn:  '06:00',          // 06:00‚Äì10:00\n    day:   '10:00',          // 10:00‚Äì18:00\n    dusk:  '18:00',          // 18:00‚Äì22:00\n    night: '22:00',          // 22:00‚Äì06:00 (—Å–æ —Å–≤—ë—Ä—Ç–∫–æ–π —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—á—å)\n  },\n};\n\n// –ü–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ñ–∞–∑\nconst ORDER = ['dawn','day','dusk','night'];\n\nexport class TimeCycle {\n  constructor(scene, cfg = {}, onPhaseChange) {\n    this.s   = scene;\n    this.cfg = { ...TimeCfgDefault, ...cfg };\n    this.onPhaseChange = onPhaseChange;\n\n    // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ –º–∏–Ω—É—Ç—ã –æ—Ç –Ω–∞—á–∞–ª–∞ —Å—É—Ç–æ–∫ [0..1439]\n    this._schedMin = this._buildSchedule(this.cfg.schedule);\n\n    // —Ç–æ—á–∫–∞ –æ—Ç—Å—á—ë—Ç–∞ (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è) –∏ —Å–¥–≤–∏–≥ –ø–æ –∏–≥—Ä–æ–≤—ã–º —Å—É—Ç–∫–∞–º (–º–∏–Ω—É—Ç—ã 0..1439)\n    this.anchorMs  = VM.get?.('clockAnchorMs') ?? Date.now();\n    this.offsetMin = VM.get?.('clockOffsetMin');\n    if (typeof this.offsetMin !== 'number') {\n      this.offsetMin = this._parseHHMM(this.cfg.startClock);\n      VM.set?.('clockOffsetMin', this.offsetMin);\n    }\n    VM.set?.('clockAnchorMs', this.anchorMs);\n\n    this.curPhase = null;\n\n    this.timer = scene.time.addEvent({\n      delay: 1000, loop: true, callback: () => this._tick()\n    });\n    this._tick(true);\n  }\n\n  dispose(){ this.timer?.remove(); }\n\n  // --- —É—Ç–∏–ª–∏—Ç—ã ---------------------------------------------------------------\n\n  _parseHHMM(hhmm = '00:00') {\n    const [h,m] = String(hhmm).split(':').map(n => parseInt(n, 10) || 0);\n    return ((h % 24) * 60 + (m % 60)) % 1440;\n  }\n\n  _buildSchedule(schedule) {\n    const s = { ...TimeCfgDefault.schedule, ...(schedule || {}) };\n    // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –º–∏–Ω—É—Ç—ã\n    const mins = ORDER.map(k => [k, this._parseHHMM(s[k])]);\n    // —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç ORDER (–æ–Ω —É–∂–µ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω)\n    return mins; // [['dawn',360], ['day',600], ['dusk',1080], ['night',1320]]\n  }\n\n  _totalMs(){ return (this.cfg.dayLengthMin|0) * 60 * 1000; }\n\n  // ¬´–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Å—É—Ç–æ—á–Ω–æ–π –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏¬ª –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö —Å–∏–º-—Å—É—Ç–æ–∫\n  _progressMs() {\n    const passed = Date.now() - this.anchorMs;   // —Ä–µ–∞–ª—å–Ω–æ–µ –ø—Ä–æ—à–µ–¥—à–µ–µ\n    const total  = this._totalMs();              // –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–¥–Ω–∏—Ö —Å–∏–º-—Å—É—Ç–æ–∫\n    // offsetMin ‚Äî –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö 24—á; —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –ø–æ–¥ total\n    const baseMs = Math.floor(((this.offsetMin|0) % 1440) / 1440 * total);\n    let p = (passed + baseMs) % total;\n    if (p < 0) p += total;\n    return p;\n  }\n\n  // —Ç–µ–∫—É—â–∏–µ 24—á (0..1), hh:mm –∏ —Ñ–∞–∑–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º t (0..1)\n  getInfo() {\n    // 0..1 –ø–æ —Å—É—Ç–∫–∞–º\n    const pct24 = (this._progressMs() / this._totalMs()) % 1;\n    // –º–∏–Ω—É—Ç—ã 0..1439\n    const mins24 = Math.floor(pct24 * 1440);\n    const h = Math.floor(mins24 / 60) % 24;\n    const m = mins24 % 60;\n    const clock = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;\n\n    // –≤—ã—á–∏—Å–ª—è–µ–º —Ñ–∞–∑—É –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é\n    const { phase, next, t } = this._phaseAt(mins24);\n\n    return { phase, next, t, h, m, clock, pct24 };\n  }\n\n  _phaseAt(mins24) {\n    const S = this._schedMin; // [['dawn',360], ...]\n    // helper: –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç a –¥–æ b –ø–æ –∫—Ä—É–≥—É —Å—É—Ç–æ–∫\n    const span = (a, b) => (b - a + 1440) % 1440;\n\n    // –Ω–∞–π–¥—ë–º —Ç—É –ø–∞—Ä—É [start_i, start_{i+1}) –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—É—â–∏–µ –º–∏–Ω—É—Ç—ã\n    for (let i = 0; i < S.length; i++) {\n      const curName = S[i][0];\n      const curStart = S[i][1];\n      const nextName = S[(i+1) % S.length][0];\n      const nextStart = S[(i+1) % S.length][1];\n\n      const dur = span(curStart, nextStart) || 1; // —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∏—Ç—å –Ω–∞ 0\n      const into = span(curStart, mins24);\n\n      // –ø–æ–ø–∞–ª–∏ –ª–∏ –º—ã –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª [curStart, nextStart) —Å —É—á—ë—Ç–æ–º —Å–≤—ë—Ä—Ç–∫–∏\n      const inInterval = (curStart <= nextStart)\n        ? (mins24 >= curStart && mins24 < nextStart)\n        : (mins24 >= curStart || mins24 < nextStart); // —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—á—å\n\n      if (inInterval) {\n        return { phase: curName, next: nextName, t: into / dur };\n      }\n    }\n\n    // –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π (–Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å): —Å—á–∏—Ç–∞–µ–º —á—Ç–æ –Ω–æ—á—å, t=0\n    return { phase: 'night', next: 'dawn', t: 0 };\n  }\n\n  _tick(initial = false) {\n    const { phase } = this.getInfo();\n    if (initial || phase !== this.curPhase) {\n      this.curPhase = phase;\n      this.onPhaseChange?.(phase);\n    }\n  }\n\n  // (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) –±—ã—Å—Ç—Ä—ã–π —Å–µ—Ç—Ç–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ ‚Äî —É–¥–æ–±–Ω–æ –¥–ª—è –¥–µ–±–∞–≥–∞:\n  // tc.setClock('18:30') ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω–æ ¬´–ø–µ—Ä–µ–º–æ—Ç–∞—Ç—å¬ª —á–∞—Å—ã\n  setClock(hhmm) {\n    this.offsetMin = this._parseHHMM(hhmm);\n    VM.set?.('clockOffsetMin', this.offsetMin);\n    // –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –¥—ë—Ä–Ω–µ–º —Ç–∏–∫ ‚Äî —á—Ç–æ–±—ã –∫–æ–ª–±—ç–∫–∏/—á–∞—Å—ã –æ–±–Ω–æ–≤–∏–ª–∏—Å—å —Å—Ä–∞–∑—É\n    this._tick(true);\n  }\n}\n\nexport default TimeCycle;\n","// src/locations/LocationEditor.js\n// –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä castMask –∏ speciesAreas.\n// –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å LOCATIONS –∏ —Å—Ü–µ–Ω–æ–π. LocationMgr –ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è.\n\nimport { LOCATIONS } from '../data/locations.js';\n\nexport class LocationEditor {\n  constructor(scene, locationId = 'lake') {\n    this.s = scene;\n    this.locId = locationId;\n\n    // —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤\n    this._maskEdit = null;\n    this._spEdit = null;\n\n    // —Å–ª—É–∂–µ–±–Ω–æ–µ\n    this._hotkeysBound = false;\n    this._shutdownBound = false;\n    this._prevCursor = '';\n\n    // –∞–≤—Ç–æ-–æ—Ç–≤—è–∑–∫–∞ –Ω–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å—Ü–µ–Ω—ã\n    if (!this._shutdownBound) {\n      this._shutdownBound = true;\n      this.s.events?.once(Phaser.Scenes.Events.SHUTDOWN, () => {\n        this.stopCastMaskEditor();\n        this.stopSpeciesAreasEditor();\n        if (this._hotkeysBound && this._hotKeyHandler) {\n          this.s.input.keyboard?.off('keydown', this._hotKeyHandler);\n          this._hotkeysBound = false;\n        }\n      });\n    }\n  }\n\n  // -------- —É—Ç–∏–ª–∏—Ç—ã –¥–æ—Å—Ç—É–ø–∞ / –≥–µ–æ–º–µ—Ç—Ä–∏—è --------\n  get loc() {\n    return LOCATIONS.find(l => l.id === this.locId) || (LOCATIONS[0] ?? null);\n  }\n  setLocation(id) { this.locId = id; }\n\n  // water bounds –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (px/frac ‚Üí px)\n  _waterBounds() {\n    const H = this.s.scale.height;\n    const w = this.loc?.water || {};\n    const toPx = (v) => (v <= 1 ? Math.round(v * H) : v|0);\n    const top = (w.top != null) ? toPx(w.top) : 0;\n    const shore = (w.bottom != null) ? toPx(w.bottom) : H;\n    return { top, shore };\n  }\n\n  _toUV(x, y) {\n    const W = Math.max(1, this.s.scale.width);\n    const { top, shore } = this._waterBounds();\n    const u = Phaser.Math.Clamp(x / W, 0, 1);\n    const v = Phaser.Math.Clamp((y - top) / Math.max(1, (shore - top)), 0, 1);\n    return { u, v };\n  }\n  _toXY([u, v]) {\n    const W = this.s.scale.width;\n    const { top, shore } = this._waterBounds();\n    const Hwater = Math.max(1, shore - top);\n    return { x: u * W, y: top + v * Hwater };\n  }\n\n  static _distPtSeg({u, v}, [ax, ay], [bx, by]) {\n    const vx = bx - ax, vy = by - ay;\n    const wx = u  - ax, wy = v  - ay;\n    const c1 = vx*wx + vy*wy;\n    if (c1 <= 0) return Math.hypot(u-ax, v-ay);\n    const c2 = vx*vx + vy*vy;\n    if (c2 <= c1) return Math.hypot(u-bx, v-by);\n    const t = c1 / Math.max(1e-9, c2);\n    const px = ax + t*vx, py = ay + t*vy;\n    return Math.hypot(u - px, v - py);\n  }\n  static _insertPointIntoNearestEdge(poly, ptUV) {\n    if (!poly.length) { poly.push([ptUV.u, ptUV.v]); return; }\n    let bestI = 0, bestD = Infinity;\n    for (let i=0;i<poly.length;i++) {\n      const a = poly[i], b = poly[(i+1)%poly.length];\n      const d = LocationEditor._distPtSeg(ptUV, a, b);\n      if (d < bestD) { bestD = d; bestI = i; }\n    }\n    poly.splice(bestI+1, 0, [ptUV.u, ptUV.v]);\n  }\n  static _findNearestVertex(poly, ptUV, maxDist=0.03) {\n    let idx = -1, best = Infinity;\n    for (let i=0;i<poly.length;i++) {\n      const [u,v] = poly[i];\n      const d = Math.hypot(ptUV.u - u, ptUV.v - v);\n      if (d < best) { best = d; idx = i; }\n    }\n    return (best <= maxDist) ? idx : -1;\n  }\n\n  // ---------- —É–¥–æ–±–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ) ----------\n  isCastMaskEditing(){ return !!this._maskEdit; }\n  isSpeciesEditing(){ return !!this._spEdit; }\n\n  toggleCastMaskEditor(force){\n    if (force === true)  return this.startCastMaskEditor();\n    if (force === false) return this.stopCastMaskEditor();\n    return this._maskEdit ? this.stopCastMaskEditor() : this.startCastMaskEditor();\n  }\n  toggleSpeciesAreasEditor(force){\n    if (force === true)  return this.startSpeciesAreasEditor();\n    if (force === false) return this.stopSpeciesAreasEditor();\n    return this._spEdit ? this.stopSpeciesAreasEditor() : this.startSpeciesAreasEditor();\n  }\n\n  // Alt+M ‚Äî –º–∞—Å–∫–∞, Alt+P ‚Äî –≤–∏–¥—ã\n  bindHotkeys(){\n    if (this._hotkeysBound) return;\n    const kb = this.s.input.keyboard; if (!kb) return;\n    this._hotKeyHandler = (e) => {\n      if (e.altKey && e.code === 'KeyM') { e.preventDefault(); this.toggleCastMaskEditor(); }\n      if (e.altKey && e.code === 'KeyP') { e.preventDefault(); this.toggleSpeciesAreasEditor(); }\n    };\n    kb.on('keydown', this._hotKeyHandler);\n    this._hotkeysBound = true;\n  }\n\n  // ---------------- CastMask editor ----------------\n  startCastMaskEditor() {\n    if (this._maskEdit) return; // —É–∂–µ –∑–∞–ø—É—â–µ–Ω\n    this.stopSpeciesAreasEditor(); // –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä\n\n    const loc = this.loc;\n    const mask = (loc.castMask ||= {});\n    mask.allowedPolys = mask.allowedPolys || [];\n    mask.blockedPolys = mask.blockedPolys || [];\n\n    const state = { layer: 'allowedPolys', polyIdx: 0 };\n\n    // –∂–∏–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã –≤–æ–¥—ã\n    let W = this.s.scale.width;\n    let { top: TOP, shore: SHORE } = this._waterBounds();\n    let Hwater = Math.max(1, SHORE - TOP);\n\n    const toUV = (x, y) => ({\n      u: Phaser.Math.Clamp(x / Math.max(1, W), 0, 1),\n      v: Phaser.Math.Clamp((y - TOP) / Math.max(1, Hwater), 0, 1),\n    });\n    const toXY = ([u, v]) => ({ x: u * W, y: TOP + v * Hwater });\n\n    // –ö—É—Ä—Å–æ—Ä\n    this._prevCursor = this.s.input.manager?.canvas?.style?.cursor || '';\n    try { this.s.input.manager.canvas.style.cursor = 'crosshair'; } catch {}\n\n    // —Å–ª–æ–∏\n    const overlay = this.s.add.rectangle(0, 0, this.s.scale.width, this.s.scale.height, 0x000000, 0)\n      .setOrigin(0, 0).setDepth(5999).setScrollFactor(0).setInteractive(); // –∫–ª–∏–∫–∏ –ª–æ–≤–∏–º —Ç–æ–ª—å–∫–æ –Ω–∞ overlay\n    const gAllowed = this.s.add.graphics().setDepth(6000);\n    const gBlocked = this.s.add.graphics().setDepth(6000);\n    const handles  = this.s.add.container(0, 0).setDepth(6001);\n\n    const ensurePoly = (layer) => {\n      const list = mask[layer];\n      if (!list.length) list.push([]);\n      if (state.polyIdx >= list.length) state.polyIdx = list.length - 1;\n      return list[state.polyIdx];\n    };\n\n    const colors = {\n      allowed: { fill: 0x00ff88, alpha: 0.18, stroke: 0x00ff88, hFill: 0xffffff },\n      blocked: { fill: 0xff3355, alpha: 0.25, stroke: 0xff3355, hFill: 0xffffff },\n    };\n\n    // –∂–∏–≤–æ–π –ø—Ä–µ–≤—å—é: –ø—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å–∫—É –∫ BG-–≤–æ–¥–µ (–µ—Å–ª–∏ –Ω–∞ —Å—Ü–µ–Ω–µ –µ—Å—Ç—å LocationMgr)\n    const previewApply = () => this.s.locationMgr?.setWaterMaskFromCastMask?.(mask);\n\n    const repaintPolys = () => {\n      const drawSet = (g, polys, col) => {\n        g.clear();\n        polys.forEach(poly => {\n          if (!Array.isArray(poly) || poly.length < 3) return;\n          g.fillStyle(col.fill, col.alpha).lineStyle(2, col.stroke, 0.9);\n          g.beginPath();\n          const p0 = toXY(poly[0]); g.moveTo(p0.x, p0.y);\n          for (let i = 1; i < poly.length; i++) { const p = toXY(poly[i]); g.lineTo(p.x, p.y); }\n          g.closePath(); g.fillPath(); g.strokePath();\n        });\n      };\n      drawSet(gAllowed, mask.allowedPolys, colors.allowed);\n      drawSet(gBlocked, mask.blockedPolys, colors.blocked);\n    };\n\n    const rebuildHandles = () => {\n      handles.removeAll(true);\n      const active = ensurePoly(state.layer);\n      const col = (state.layer === 'allowedPolys') ? colors.allowed : colors.blocked;\n\n      for (let i = 0; i < active.length; i++) {\n        const { x, y } = toXY(active[i]);\n        const c = this.s.add.circle(x, y, 7, col.hFill, 1)\n          .setStrokeStyle(2, 0x1b2638, 0.8)\n          .setInteractive({ draggable: true });\n\n        c.on('drag', (_p, dragX, dragY) => {\n          const uv = toUV(dragX, dragY);\n          active[i][0] = uv.u; active[i][1] = uv.v;\n          c.setPosition(dragX, dragY);\n          repaintPolys(); previewApply();\n        });\n        this.s.input.setDraggable(c, true);\n        handles.add(c);\n      }\n    };\n\n    const repaintAll = () => { repaintPolys(); rebuildHandles(); previewApply(); };\n\n    const addAtCursor = () => {\n      const active = ensurePoly(state.layer);\n      const ptr = this.s.input.activePointer;\n      const uv = toUV(ptr.worldX ?? ptr.x, ptr.worldY ?? ptr.y);\n      LocationEditor._insertPointIntoNearestEdge(active, uv);\n      repaintAll();\n      this.s.showToast?.(state.layer === 'blockedPolys' ? '–î–æ–±–∞–≤–ª–µ–Ω–∞ –ö–†–ê–°–ù–ê–Ø —Ç–æ—á–∫–∞' : '–î–æ–±–∞–≤–ª–µ–Ω–∞ –ó–ï–õ–Å–ù–ê–Ø —Ç–æ—á–∫–∞');\n    };\n\n    // —Å–æ–±—ã—Ç–∏—è ‚Äî –≤–µ—à–∞–µ–º –Ω–∞ overlay, —á—Ç–æ–±—ã –ø–æ—Å–ª–µ destroy –≤—Å—ë —É—à–ª–æ –≤–º–µ—Å—Ç–µ\n    const onOverlayPointerDown = (p) => {\n      const active = ensurePoly(state.layer);\n      const uv = toUV(p.worldX ?? p.x, p.worldY ?? p.y);\n      if (p.event?.shiftKey) { LocationEditor._insertPointIntoNearestEdge(active, uv); repaintAll(); return; }\n      if (p.event?.altKey)   { const idx = LocationEditor._findNearestVertex(active, uv); if (idx >= 0) { active.splice(idx,1); repaintAll(); } return; }\n    };\n    overlay.on('pointerdown', onOverlayPointerDown);\n\n    // –∫–ª–∞–≤–∏—à–∏ ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ\n    const roundN = (x, n = 3) => Math.round(x * Math.pow(10, n)) / Math.pow(10, n);\n    const roundPolys = (polys, n = 3) => polys.map(poly => poly.map(([u, v]) => [roundN(u, n), roundN(v, n)]));\n\n    const onKey = (e) => {\n      if (e.code === 'KeyG' && !e.ctrlKey) { state.layer = 'allowedPolys'; this.s.showToast?.('–°–ª–æ–π: –ó–ï–õ–Å–ù–´–ô (allowed)'); repaintAll(); }\n      if (e.code === 'KeyR' && !e.ctrlKey) { state.layer = 'blockedPolys'; this.s.showToast?.('–°–ª–æ–π: –ö–†–ê–°–ù–´–ô (blocked)'); repaintAll(); }\n      if (e.code === 'KeyG' && e.ctrlKey) { addAtCursor(); e.preventDefault(); }\n      if (e.code === 'KeyR' && e.ctrlKey) { state.layer = 'blockedPolys'; addAtCursor(); e.preventDefault(); }\n      if (e.code === 'KeyN' && !e.ctrlKey) {\n        mask[state.layer].push([]); state.polyIdx = mask[state.layer].length - 1; repaintAll();\n        this.s.showToast?.('–ù–æ–≤—ã–π –ø–æ–ª–∏–≥–æ–Ω –≤ —Ç–µ–∫—É—â–µ–º —Å–ª–æ–µ');\n      }\n      // SAVE ‚Üí –≤ –±—É—Ñ–µ—Ä –≥–æ—Ç–æ–≤—ã–π –±–ª–æ–∫ castMask\n      if (e.code === 'KeyS' && !e.ctrlKey) {\n        const A = roundPolys(mask.allowedPolys, 3);\n        const B = roundPolys(mask.blockedPolys, 3);\n        mask.allowedPolys = A; mask.blockedPolys = B;\n        repaintAll();\n        const payload = `castMask: ${JSON.stringify({ allowedPolys: A, blockedPolys: B }, null, 2)}`;\n        console.log(payload);\n        if (navigator.clipboard?.writeText) {\n          navigator.clipboard.writeText(payload)\n            .then(() => this.s.showToast?.('castMask —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –±—É—Ñ–µ—Ä'))\n            .catch(() => this.s.showToast?.('castMask –≤—ã–≤–µ–¥–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å'));\n        } else {\n          this.s.showToast?.('castMask –≤—ã–≤–µ–¥–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å');\n        }\n      }\n      if (e.code === 'Escape') this.stopCastMaskEditor();\n    };\n    this.s.input.keyboard?.on('keydown', onKey);\n\n    // —Ä–µ—Å–∞–π–∑: –æ–±–Ω–æ–≤–∏—Ç—å –≥–µ–æ–º–µ—Ç—Ä–∏—é\n    const onResize = () => {\n      W = this.s.scale.width;\n      const wb = this._waterBounds();\n      TOP = wb.top; SHORE = wb.shore; Hwater = Math.max(1, SHORE - TOP);\n      overlay.setSize(this.s.scale.width, this.s.scale.height);\n      repaintAll();\n    };\n    this.s.scale.on('resize', onResize);\n\n    this._maskEdit = { overlay, gAllowed, gBlocked, handles, onKey, onResize };\n\n    repaintAll();\n    this.s.showToast?.('–†–µ–¥–∞–∫—Ç–æ—Ä –º–∞—Å–∫–∏: G/R ‚Äî —Å–ª–æ–π, Ctrl+G/R ‚Äî —Ç–æ—á–∫–∞, Shift=–¥–æ–±–∞–≤–∏—Ç—å, Alt=—É–¥–∞–ª–∏—Ç—å, N ‚Äî –Ω–æ–≤—ã–π, S ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, Esc ‚Äî –≤—ã—Ö–æ–¥');\n  }\n\n  stopCastMaskEditor() {\n    const E = this._maskEdit; if (!E) return;\n\n    // –≤–µ—Ä–Ω—É—Ç—å –∫—É—Ä—Å–æ—Ä\n    try { if (this._prevCursor != null) this.s.input.manager.canvas.style.cursor = this._prevCursor; } catch {}\n\n    this.s.input.keyboard?.off('keydown', E.onKey);\n    this.s.scale.off('resize', E.onResize);\n    E.overlay?.destroy(); E.gAllowed?.destroy(); E.gBlocked?.destroy(); E.handles?.destroy();\n\n    this._maskEdit = null;\n  }\n\n  // ---------------- SpeciesAreas editor ----------------\n  startSpeciesAreasEditor() {\n    if (this._spEdit) return; // —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω\n    this.stopCastMaskEditor();\n\n    const loc = (this.loc.speciesAreas ||= []);\n    const speciesList = Object.keys((this.s.SPAWN_TABLES||{})[this.locId] || {});\n    let curSpIdx = Math.max(0, speciesList.indexOf((loc[0]?.speciesId)||speciesList[0]||'pike'));\n    const curSpecies = () => speciesList[curSpIdx] || 'pike';\n\n    // —Ä–∞–∑–º–µ—Ä—ã\n    let W = this.s.scale.width;\n    let { top: TOP, shore: SHORE } = this._waterBounds();\n    let Hwater = Math.max(1, SHORE - TOP);\n\n    // –ö—É—Ä—Å–æ—Ä\n    this._prevCursor = this.s.input.manager?.canvas?.style?.cursor || '';\n    try { this.s.input.manager.canvas.style.cursor = 'crosshair'; } catch {}\n\n    const overlay = this.s.add.rectangle(0,0,W,this.s.scale.height,0x000000,0).setOrigin(0).setDepth(7000).setInteractive();\n    const g = this.s.add.graphics().setDepth(7001);\n    const handles = this.s.add.container(0,0).setDepth(7002);\n\n    const toXY = ([u,v]) => ({ x: u*W, y: TOP + v*Hwater });\n    const toUV = (x,y) => {\n      return {\n        u: Phaser.Math.Clamp(x/Math.max(1,W), 0, 1),\n        v: Phaser.Math.Clamp((y-TOP)/Math.max(1,Hwater), 0, 1)\n      };\n    };\n\n    const ensureLayer = () => {\n      const id = curSpecies();\n      let layer = this.loc.speciesAreas.find(a => a.speciesId === id);\n      if (!layer) { layer = { speciesId:id, mult:1.5, polys:[] }; this.loc.speciesAreas.push(layer); }\n      return layer;\n    };\n\n    const repaint = () => {\n      g.clear(); handles.removeAll(true);\n      for (const a of this.loc.speciesAreas) {\n        const active = a.speciesId === curSpecies();\n        const col = active ? 0xffff66 : 0x66ccff;\n        const alpha = active ? 0.25 : 0.12;\n        g.lineStyle(2, col, 0.9);\n        g.fillStyle(col, alpha);\n        for (const poly of (a.polys||[])) {\n          if (poly.length < 3) continue;\n          const p0 = toXY(poly[0]); g.beginPath(); g.moveTo(p0.x, p0.y);\n          for (let i=1;i<poly.length;i++){ const p=toXY(poly[i]); g.lineTo(p.x,p.y); }\n          g.closePath(); g.fillPath(); g.strokePath();\n        }\n      }\n\n      const layer = ensureLayer();\n      for (const poly of (layer.polys||[])) {\n        poly.forEach((uv, vi) => {\n          const {x,y} = toXY(uv);\n          const c = this.s.add.circle(x,y,7,0xffffff,1).setStrokeStyle(2,0x1b2638,0.8)\n            .setInteractive({ draggable:true });\n          this.s.input.setDraggable(c, true);\n          c.on('drag', (_p, dx, dy) => {\n            const p = toUV(dx, dy);\n            poly[vi][0] = p.u; poly[vi][1] = p.v; repaint();\n          });\n          handles.add(c);\n        });\n      }\n\n      const info = this.s.add.text(100, 330,\n        `–í–∏–¥: ${curSpecies()} (mult=${ensureLayer().mult.toFixed(2)})  |  Shift+–∫–ª–∏–∫=—Ç–æ—á–∫–∞  Alt+–∫–ª–∏–∫=—É–¥–∞–ª–∏—Ç—å  N=–Ω–æ–≤—ã–π –ø–æ–ª–∏–≥–æ–Ω  [ ]=–º–Ω–æ–∂–∏—Ç–µ–ª—å  Q/E=–≤–∏–¥  S=–ª–æ–≥  Esc=–≤—ã—Ö–æ–¥`,\n        { fontSize:'16px', color:'#ffffff', }).setDepth(7003).setScrollFactor(0).setOrigin(0,0);\n      handles.add(info);\n    };\n\n    const onOverlayPointerDown = (p) => {\n      const layer = ensureLayer();\n      const ptr = { x:p.worldX ?? p.x, y:p.worldY ?? p.y };\n      const uv = toUV(ptr.x, ptr.y);\n      if (p.event?.shiftKey) {\n        if (!layer.polys.length) layer.polys.push([]);\n        const poly = layer.polys[layer.polys.length-1];\n        LocationEditor._insertPointIntoNearestEdge(poly, uv);\n        repaint(); return;\n      }\n      if (p.event?.altKey) {\n        const poly = layer.polys[layer.polys.length-1];\n        if (poly?.length) {\n          const idx = LocationEditor._findNearestVertex(poly, uv);\n          if (idx >= 0) { poly.splice(idx,1); repaint(); }\n        }\n        return;\n      }\n    };\n    overlay.on('pointerdown', onOverlayPointerDown);\n\n    const onKey = (e) => {\n      const layer = ensureLayer();\n      if (e.code === 'KeyN') { layer.polys.push([]); repaint(); }\n      if (e.code === 'BracketLeft')  { layer.mult = Math.max(1, +(layer.mult - 0.1).toFixed(2)); repaint(); }\n      if (e.code === 'BracketRight') { layer.mult = Math.min(8, +(layer.mult + 0.1).toFixed(2)); repaint(); }\n      if (e.code === 'KeyQ') { curSpIdx = (curSpIdx - 1 + speciesList.length) % speciesList.length; repaint(); }\n      if (e.code === 'KeyE') { curSpIdx = (curSpIdx + 1) % speciesList.length; repaint(); }\n\n      if (e.code === 'KeyS' && !e.ctrlKey) {\n        const filled = this.loc.speciesAreas.filter(a => a.polys?.some(poly => poly.length >= 3));\n        const clean = filled.map(a => ({\n          speciesId: a.speciesId,\n          mult: +a.mult.toFixed(2),\n          polys: a.polys\n            .filter(poly => poly.length >= 3)\n            .map(poly => poly.map(([u,v]) => [+u.toFixed(3), +v.toFixed(3)]))\n        }));\n        const txt = `speciesAreas: ${JSON.stringify(clean, null, 2)}`;\n        console.log(txt);\n        this.s.showToast?.('SpeciesAreas (–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ) ‚Üí –≤ –∫–æ–Ω—Å–æ–ª—å');\n      }\n      if (e.code === 'KeyS' && e.ctrlKey) {\n        e.preventDefault();\n        const polys = (layer.polys || []).filter(p => p.length >= 3);\n        const one = [{\n          speciesId: layer.speciesId,\n          mult: +layer.mult.toFixed(2),\n          polys: polys.map(poly => poly.map(([u,v]) => [+u.toFixed(3), +v.toFixed(3)]))\n        }];\n        const txt = `speciesAreas: ${JSON.stringify(one, null, 2)}`;\n        console.log(txt);\n        this.s.showToast?.(`–¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–π –≤–∏–¥: ${layer.speciesId} ‚Üí –≤ –∫–æ–Ω—Å–æ–ª—å`);\n      }\n\n      if (e.code === 'Escape') this.stopSpeciesAreasEditor();\n    };\n    this.s.input.keyboard?.on('keydown', onKey);\n\n    const onResize = () => {\n      W = this.s.scale.width;\n      const wb = this._waterBounds();\n      TOP = wb.top; SHORE = wb.shore; Hwater = Math.max(1, SHORE - TOP);\n      overlay.setSize(this.s.scale.width, this.s.scale.height);\n      repaint();\n    };\n    this.s.scale.on('resize', onResize);\n\n    this._spEdit = { overlay, g, handles, onKey, onResize };\n\n    repaint();\n    this.s.showToast?.('–†–µ–¥–∞–∫—Ç–æ—Ä –∑–æ–Ω –≤–∏–¥–æ–≤ –∑–∞–ø—É—â–µ–Ω (—Å–º. –ø–∞–Ω–µ–ª—å —Å–≤–µ—Ä—Ö—É)');\n  }\n\n  stopSpeciesAreasEditor() {\n    const E = this._spEdit; if (!E) return;\n\n    try { if (this._prevCursor != null) this.s.input.manager.canvas.style.cursor = this._prevCursor; } catch {}\n\n    this.s.input.keyboard?.off('keydown', E.onKey);\n    this.s.scale.off('resize', E.onResize);\n    E.overlay?.destroy(); E.g?.destroy(); E.handles?.destroy();\n    this._spEdit = null;\n  }\n}\n\nexport default LocationEditor;\n","// src/quests/QuestKinds.js\n// –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á. –¢–µ–ø–µ—Ä—å —É—á–∏—Ç—ã–≤–∞–µ–º —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è: catch | wallet | shop | level | inventory\n\nfunction inRange(val, [min, max]) {\n  const v = Number(val);\n  const lo = (min ?? -Infinity);\n  const hi = (max ?? +Infinity);\n  return Number.isFinite(v) && v >= lo && v <= hi;\n}\nfunction normStr(x){ return String(x||'').trim().toLowerCase(); }\nfunction evIs(ctx, ...evs){ const ev = ctx?.ev ?? 'catch'; return evs.includes(ev); }\n\nfunction weightToG(pick) {\n  if (!pick) return null;\n  if (typeof pick.weightG === 'number') return pick.weightG|0;\n  if (typeof pick.weightKg === 'number') return Math.round(pick.weightKg * 1000);\n  return null;\n}\nfunction getSpeciesId(pick) {\n  return pick?.speciesId ?? pick?.species ?? pick?.id ?? null;\n}\nfunction normTime(s) {\n  const t = normStr(s);\n  if (!t) return null;\n  // –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ñ–∞–∑ –≤–∏–∑—É–∞–ª–∫–∏ –∫ –∏–≥—Ä–æ–≤—ã–º —Å–ª–æ—Ç–∞–º –≤—Ä–µ–º–µ–Ω–∏\n  if (['dawn','—Ä–∞—Å—Å–≤–µ—Ç','—Å–≤—ñ—Ç–∞–Ω–æ–∫'].includes(t)) return 'morning';\n  if (['dusk','–∑–∞–∫–∞—Ç','—Å—É—Ç—ñ–Ω–∫–∏'].includes(t))     return 'evening';\n\n  if (['morning','—É—Ç—Ä–æ','—Ä–∞–Ω–æ–∫'].includes(t))  return 'morning';\n  if (['day','–¥–µ–Ω—å'].includes(t))              return 'day';\n  if (['evening','–≤–µ—á–µ—Ä','–≤–µ—ái—Ä','–≤–µ—á—ñ—Ä'].includes(t)) return 'evening';\n  if (['night','–Ω–æ—á—å','–Ω—ñ—á'].includes(t))      return 'night';\n  return t;\n}\nfunction listFromKgOrG(params){\n  // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º params.valuesG (–º–∞—Å—Å–∏–≤), params.valueG (—á–∏—Å–ª–æ),\n  // params.valuesKg / valueKg ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –≥—Ä–∞–º–º—ã\n  if (!params) return null;\n  if (Array.isArray(params.valuesG)) return params.valuesG.map(n=>Number(n)||0);\n  if (typeof params.valueG === 'number') return [params.valueG];\n  if (Array.isArray(params.valuesKg)) return params.valuesKg.map(n=>Math.round(Number(n)*1000));\n  if (typeof params.valueKg === 'number') return [Math.round(Number(params.valueKg)*1000)];\n  return null;\n}\n\nfunction _anyHasItemId(arr, wantId){\n  if (!Array.isArray(arr)) return false;\n  return arr.some(it => (typeof it === 'string') ? (it === wantId) : (it?.id === wantId));\n}\n\nexport const QuestKinds = Object.freeze({\n  // =============== CATCH-–∏–≤–µ–Ω—Ç—ã ===============\n  catch_count(task, pick, ctx) {\n    if (!evIs(ctx,'catch')) return false;\n    return pick?.kind === 'fish';\n  },\n\n  // –í–µ—Å–æ–≤–æ–π –∫–æ—Ä–∏–¥–æ—Ä –≤ –≥—Ä–∞–º–º–∞—Ö\n  catch_weight_range_g(task, pick, ctx) {\n    if (!evIs(ctx,'catch') || pick?.kind !== 'fish') return false;\n    const w = weightToG(pick);\n    const range = task?.params?.weightG ?? task?.params?.rangeG ?? task?.params?.g;\n    if (!Array.isArray(range) || range.length !== 2) return false;\n    return inRange(w, range);\n  },\n\n  // –¢–æ—á–Ω—ã–π –≤–µ—Å (–ø–æ–¥ —Ç–≤–æ–∏ 0.111, 0.222, ... –∫–≥). –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–≥/–≥ + –¥–æ–ø—É—Å–∫.\n  // params: { valuesKg:[0.111,0.222], toleranceG?:2, ignoreZero?:true }\n  catch_weight_exact_g(task, pick, ctx){\n    if (!evIs(ctx,'catch') || pick?.kind !== 'fish') return false;\n    const w = weightToG(pick);\n    if (w == null) return false;\n\n    const { toleranceG = 2, ignoreZero = true } = task?.params || {};\n    if (ignoreZero && w <= 0) return false;\n\n    const targetsG = listFromKgOrG(task?.params);\n    if (!targetsG || !targetsG.length) return false;\n\n    // –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –¥–æ–ø—É—Å–∫–æ–º ¬±toleranceG (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.111 –∫–≥ ‚Üí 111 –≥ ¬± 2 –≥)\n    return targetsG.some(tg => Math.abs(w - (tg|0)) <= (toleranceG|0));\n  },\n\n  // –í–∏–¥—ã\n  catch_species(task, pick, ctx) {\n    if (!evIs(ctx,'catch') || pick?.kind !== 'fish') return false;\n    const want = task?.params?.species;\n    if (!want) return false;\n    const have = getSpeciesId(pick);\n    return Array.isArray(want) ? want.includes(have) : (have === want);\n  },\n\n  // –ì–ª—É–±–∏–Ω–∞\n  catch_depth_range_m(task, _pick, ctx) {\n    if (!evIs(ctx,'catch')) return false;\n    const dm = Number(ctx?.depthM);\n    const range = task?.params?.depthM ?? task?.params?.m;\n    if (!Array.isArray(range) || range.length !== 2) return false;\n    return inRange(dm, range);\n  },\n\n  // –ù–∞–∂–∏–≤–∫–∞\n  catch_bait_is(task, _pick, ctx) {\n    if (!evIs(ctx,'catch')) return false;\n    const want = normStr(task?.params?.bait ?? task?.params?.id);\n    const have = normStr(ctx?.bait);\n    return !!want && !!have && want === have;\n  },\n\n  // –õ–æ–∫–∞—Ü–∏—è\n  catch_in_location(task, _pick, ctx) {\n    if (!evIs(ctx,'catch')) return false;\n    const loc = ctx?.locationId;\n    const want = task?.params?.locations ?? task?.params?.location;\n    return Array.isArray(want) ? want.includes(loc) : (want ? loc === want : false);\n  },\n\n  // –í—Ä–µ–º—è —Å—É—Ç–æ–∫\n  catch_time_of_day(task, _pick, ctx) {\n    if (!evIs(ctx,'catch')) return false;\n    const want = task?.params?.time ?? task?.params?.times;\n    const have = normTime(ctx?.timeOfDay);\n    if (!have || !want) return false;\n    const arr = Array.isArray(want) ? want : [want];\n    return arr.map(normTime).includes(have);\n  },\n\n  // –õ—É—Ç\nloot_any(task, pick, ctx) {\n  if (!evIs(ctx,'catch')) return false;\n  // –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Å—ë –Ω–µ-—Ä—ã–±—É\n  return pick && pick.kind && pick.kind !== 'fish';\n},\n\n  // =============== WALLET-–∏–≤–µ–Ω—Ç—ã ===============\n  // params: { coins: 1000 }\n  wallet_coins_at_least(task, wallet, ctx) {\n    if (!evIs(ctx,'wallet')) return false;\n    const need = Number(task?.params?.coins ?? 0);\n    return Number(wallet?.coins ?? 0) >= need;\n  },\n  // params: { gold: 2 }\n  wallet_gold_at_least(task, wallet, ctx) {\n    if (!evIs(ctx,'wallet')) return false;\n    const need = Number(task?.params?.gold ?? 0);\n    return Number(wallet?.gold ?? 0) >= need;\n  },\n\n  // =============== LEVEL-–∏–≤–µ–Ω—Ç—ã ===============\n  // params: { level: 3 }\n  reach_level_at_least(task, prog, ctx) {\n    if (!evIs(ctx,'level')) return false;\n    const need = Number(task?.params?.level ?? 0);\n    const cur  = Number(prog?.level ?? 1);\n    return cur >= need;\n  },\n\n  // =============== SHOP/INVENTORY-–∏–≤–µ–Ω—Ç—ã ===============\n  // params: { itemId:'rod_basic' }\n  buy_item_id(task, purchase, ctx) {\n    if (!evIs(ctx,'shop')) return false;\n    const want = task?.params?.itemId;\n    return !!want && purchase?.itemId === want;\n  },\n\n  // params: { kind:'rod', count:2 }\n  own_item_kind_count_at_least(task, inventory, ctx) {\n    if (!evIs(ctx,'inventory')) return false;\n    const kind = task?.params?.kind; // 'rod'|'reel'|'line'|'hook' –∏ —Ç.–ø.\n    const need = Number(task?.params?.count ?? 1);\n    if (!kind) return false;\n    const arr = Array.isArray(inventory?.[kind+'s']) ? inventory[kind+'s'] : [];\n    return arr.length >= need;\n  },\n\n  // params: { itemId:'rod_pro' }\n own_item_id(task, inventory, ctx) {\n    if (!evIs(ctx,'inventory')) return false;\n    const want = task?.params?.itemId;\n    if (!want) return false;\n\n    // —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–º–∞—Å—Å–∏–≤—ã —Å—Ç—Ä–æ–∫ –∏–ª–∏ –æ–±—ä–µ–∫—Ç–æ–≤)\n    const cats = ['rods','reels','lines','hooks','items'];\n    for (const c of cats) {\n      if (_anyHasItemId(inventory?.[c], want)) return true;\n    }\n\n    // –Ω–∞–∂–∏–≤–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫ –º–∞—Å—Å–∏–≤—ã, —Ç–∞–∫ –∏ map\n    const baits = inventory?.baits || inventory?.bait;\n    if (Array.isArray(baits)) {\n      if (_anyHasItemId(baits, want)) return true;\n    } else if (baits && typeof baits === 'object') {\n      if (Object.prototype.hasOwnProperty.call(baits, want) && (baits[want]|0) > 0) return true;\n    }\n    return false;\n  },\n});\n\n// –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –º–∞—Ç—á–∏–Ω–≥–∞\nexport function matchTask(task, payload, ctx) {\n  const fn = QuestKinds[task?.kind];\n  if (!fn) return false;\n  try { return !!fn(task, payload, ctx); } catch { return false; }\n}\n","// src/quests/QuestHooks.js\nimport { QuestState } from './QuestState.js';\nimport { getAllNPC } from '../data/QuestDB.js';\nimport { matchTask } from './QuestKinds.js';\nimport { emitQuestProgress } from './QuestEvents.js';\n\n\n// –ï–¥–∏–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –ª—é–±–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (ev): 'catch' | 'wallet' | 'shop' | 'level' | 'inventory'\nfunction processEvent(ev, payload, ctx = {}) {\n  const tracked = QuestState.getTrackedNpcId();\n  const targets = tracked ? getAllNPC().filter(n => n.id === tracked) : getAllNPC();\n\n  const ctxExt = { ...ctx, ev };\n\n  for (const npc of targets) {\n    const stage = QuestState.getActiveStage(npc.id);\n    if (!stage || !Array.isArray(stage.tasks) || !stage.tasks.length) continue;\n\n    let changed = false;\n\n    for (const t of stage.tasks) {\n      if (QuestState.isTaskDone(npc.id, t)) continue;\n\n      if (!matchTask(t, payload, ctxExt)) continue;\n\n      if (t.countGoal != null) QuestState.addTaskCount(npc.id, t.id, 1);\n      else                     QuestState.markTaskDone(npc.id, t.id, true);\n      changed = true;\n    }\n\n    if (changed){\n  emitQuestProgress({ type: ev });\n}\n    if (tracked) break;\n  }\n}\n\n// ‚îÄ‚îÄ –ü—É–±–ª–∏—á–Ω—ã–µ —Ö—É–∫–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nexport function onCatch(pick, ctx = {}) { processEvent('catch', pick, ctx); }\nexport function onWalletChange(wallet){ processEvent('wallet', wallet, {}); }\nexport function onLevelChange(progress){ processEvent('level', progress, {}); }\nexport function onItemBought(purchase){ processEvent('shop', purchase, {}); }\n// inventory = { rods:[], reels:[], lines:[], hooks:[], items:[], baits:[] ... }\nexport function onInventoryChange(inventory){ processEvent('inventory', inventory, {}); }\n","// src/quests/CatchFlow.js\n\nimport { emitQuestProgress } from './QuestEvents.js';\nimport { onCatch as questOnCatch } from './QuestHooks.js';\nimport { openFishCatchModal, openLootModal } from '../ui/CatchModals.js';\n\nexport function handleCatch(scene, pick, ctx = {}) {\n  function _phaseToTime(t){\n  const v = String(t||'').toLowerCase();\n  if (v === 'dawn') return 'morning';\n  if (v === 'dusk') return 'evening';\n  return v;\n}\n\n  // –°–æ–±–∏—Ä–∞–µ–º —á—É—Ç—å –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å—Ü–µ–Ω–µ\n  const mergedCtx = {\n    locationId: ctx.locationId ?? scene.currentLocationId ?? scene.locationId,\n    depthM:     ctx.depthM     ?? scene.rigDepthM,\n    bait:       ctx.bait       ?? scene.currentBaitId,\n    timeOfDay: _phaseToTime(ctx.timeOfDay ?? scene.timeOfDay ?? scene.dayPhase ?? scene.currentTimeOfDay)\n\n  };\n\n  // 1) –ö–≤–µ—Å—Ç—ã ‚Äî –æ–¥–∏–Ω —Ä–∞–∑ –∑–¥–µ—Å—å\ntry {\n  questOnCatch(pick, mergedCtx);\n  emitQuestProgress({ type: 'onCatch' });\n  console.debug('[quests] onCatch', pick, mergedCtx);\n} catch (e) {\n  console.error('[quests] onCatch error', e);\n}\n\n  // 2) UI (–º–æ–¥–∞–ª–∫–∏)\n  if (pick.kind === 'fish') {\n    return openFishCatchModal(scene, pick, {\n      keepnet: scene.keepnet,\n      keepnetFull: (scene.keepnet?.length ?? 0) >= (scene.keepnetCap ?? 0),\n      locationId: mergedCtx.locationId,\n      depthM:     mergedCtx.depthM,\n      bait:       mergedCtx.bait\n    });\n  } else {\n    const coins = pick.reward?.coins | 0;\n    return openLootModal(scene, pick, { coins });\n  }\n}\n","import { Auth } from './api.js';\n\n// –ø–æ–¥–∫–ª—é—á–∏ socket.io –∫–ª–∏–µ–Ω—Ç (—á–µ—Ä–µ–∑ <script> –≤ index.html –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–±–æ—Ä—â–∏–∫)\nexport class ChatClient {\n  constructor(io, baseUrl) {\n    this.enabled = !!(io && baseUrl);\n    if (!this.enabled) return;\n    this.socket = io(baseUrl, { transports: ['websocket'], path: '/socket.io' });\n  }\n  join()         { if (!this.enabled) return; /* ... */ }\n  leave()        { if (!this.enabled) return; /* ... */ }\n  on()           { if (!this.enabled) return; /* ... */ }\n  announceCatch(){ if (!this.enabled) return; /* ... */ }\n}\n","export default class ChatOverlay {\n  constructor(scene, chatClient, roomId){\n    this.s = scene;\n    this.chat = chatClient;\n    this.roomId = roomId;\n    this.depth = 3000;\n\n    const W = scene.scale.width, H = scene.scale.height;\n    const w = Math.min(380, Math.floor(W*0.42));\n    const h = Math.min(240, Math.floor(H*0.38));\n    const x = 12, y = H - h - 12;\n\n    this.root = scene.add.container(x,y).setDepth(this.depth);\n\n    const bg = scene.add.rectangle(0,0,w,h,0x0b0f18,0.78).setOrigin(0,0)\n      .setStrokeStyle(2,0xffffff,0.15).setInteractive();\n    this.root.add(bg);\n\n    this.list = scene.add.text(8, 8, '', {\n      fontFamily:'Arial', fontSize:'12px', color:'#cfe',\n      wordWrap:{ width:w-16 }\n    }).setOrigin(0,0);\n    this.root.add(this.list);\n\n    // input\n    const dom = scene.add.dom(8, h-8).createFromHTML(`\n      <input id=\"chatInput\" type=\"text\" placeholder=\"–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...\"\n        style=\"width:${w-16}px; padding:6px 8px; border-radius:8px; border:1px solid #456; background:#0c1323; color:#fff; font-size:14px;\">\n    `).setOrigin(0,1);\n    this.root.add(dom);\n\n    this.history = [];\n\n    this.chat.on('chat:new', (msg)=> this.pushMsg(msg));\n  }\n\n  async loadHistory(API, limit=50){\n    try {\n      const rows = await API.chatHistory(this.roomId, limit);\n      rows.forEach(r=> this.pushMsg(r,false));\n      this.render();\n    } catch {}\n  }\n\n  pushMsg(m, renderNow=true){\n    if (m.type === 'chat'){\n      this.history.push(`[${m.username}] ${m.text}`);\n    } else if (m.type === 'catch'){\n      const p = m.payload || {};\n      const fish = p.name || p.fishId || '—É–ª–æ–≤';\n      const w = p.weightKg != null ? `, ${p.weightKg.toFixed?.(2)||p.weightKg} –∫–≥` : '';\n      this.history.push(`üé£ ${m.username} —Å–ø—ñ–π–º–∞–≤ ${fish}${w}`);\n    }\n    if (this.history.length > 100) this.history.splice(0, this.history.length-100);\n    if (renderNow) this.render();\n  }\n\n  render(){\n    this.list.setText(this.history.slice(-12).join('\\n'));\n  }\n\n  focusInput(){\n    const el = this.root.getAt(2).node?.querySelector?.('#chatInput');\n    if (el){ el.focus(); }\n  }\n\n  destroy(){ this.root?.destroy(); }\n}\n","// === Clean Start Scene (–±–µ–∑ ensure/prepare/asset-logs, –±–µ–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤) ===\nimport { GearSlots } from '../ui/GearSlots.js';\nimport { spawnFish } from '../sim/spawn.js';\nimport { calcFightParams } from '../data/balance.js';\nimport { BarsDock } from '../ui/BarsDock.js';\nimport { Progress } from '../progression/progress.js';\nimport { GearModal } from '../ui/GearModal.js';\nimport { GearDB, getDefaultGear } from '../data/gear.js';\nimport { Bobber } from '../ui/Bobber.js';\nimport UI from '../ui/theme.js';\nimport { ModalHost } from '../ui/ModalHost.js';\nimport { LocationMgr } from '../locations/LocationMgr.js';\nimport VM from '../vm.js';\nimport { ShopCatalog } from '../data/shopCatalog.js';\nimport { openKeepnetModal } from '../ui/CatchModals.js';\nimport PhotoBank from '../assets/PhotoBank.js';\nimport TopHUD from '../ui/TopHUD.js';\nimport { TimeCycle } from '../time/TimeCycle.js';\nimport LocationEditor from '../locations/LocationEditor.js';\nimport { handleCatch } from '../quests/CatchFlow.js';\nimport { setRewardSink } from '../quests/QuestRewards.js';\nimport { onWalletChange, onLevelChange } from '../quests/QuestHooks.js';\nimport { API, Auth } from '../net/api.js';\nimport { ChatClient } from '../net/chat.js';\nimport ChatOverlay from '../ui/ChatOverlay.js';\nimport Phaser from 'phaser';\n\nexport class Start extends Phaser.Scene {\n  constructor(){ super('Start'); this.locId = 'lake'; }\n  init(data){ if (data?.locId) this.locId = data.locId; }\n\n  preload(){\n    this.locId = VM.get?.('locationId', this.locId) ?? this.locId;\n    LocationMgr.loadAssets(this);                 // —Ñ–æ–Ω, –∑–≤—É–∫–∏ –∏ —Ç.–¥.\n    PhotoBank.queueForScene(this, this.locId);    // (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã —Ñ–æ—Ç–∫–∏ –ª—É—Ç–∞/–º—É—Å–æ—Ä–∞)\n  }\n\nasync create(){\n    await Auth.ensure();\n  if (!Auth.isAuthed) { this.scene.start('Auth'); return; }\n\n\n  // --- 1) VM-–¥–µ—Ñ–æ–ª—Ç—ã (–±–∞–∑–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ç–µ–π—Ç–∞) ---\n  const d = VM.defaults();\n  this.state       = 'idle';\n  this.inventory   = VM.get('inventory') ?? d.inventory;\n  this.activeBaitId= VM.get('activeBaitId','worm');\n  this.gear        = VM.get('gear') ?? getDefaultGear();\n  this.gear.inv  ||= {};\n  this.gear.inv.bait = this.inventory?.bait?.[this.activeBaitId] | 0;\n  this.keepnet     = VM.get('keepnet', d.keepnet);\n  this.wallet      = VM.get('wallet')    ?? d.wallet;\n  this.rigDepthM   = VM.get('rigDepthM', d.rigDepthM);\n  this.keepnetCap  = VM.get('keepnetCap', d.keepnetCap ?? 25);\n  this.locId       = VM.get?.('locationId', this.locId) ?? this.locId;\n\n  // <<< –í–û–¢ –≠–¢–û–ì–û –ù–ï –•–í–ê–¢–ê–õ–û:\nconst savedProgress = VM.get('progress');\nconst savedLevel    = VM.get('level', 1);\n\n// --- —Å–æ–∑–¥–∞—Ç—å Progress –∏ –Ω–∞–ª–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è\nthis.progress = new Progress(this);\nif (savedProgress?.xp != null)    this.progress.xp    = savedProgress.xp|0;\nif (savedProgress?.level != null) this.progress.level = savedProgress.level|0;\nelse                               this.progress.level = savedLevel|0;\n\n\n  // --- 2) –°–µ—Ä–≤–µ—Ä–Ω—ã–π —Å—Ç–µ–π—Ç –ø–æ–≤–µ—Ä—Ö VM ---\n  let st = null;\n  try { st = window.API_BASE ? await API.loadState() : null; } catch (e){ console.warn('loadState failed', e); }\n  if (st){\n    this.wallet       = st.wallet      ?? this.wallet;\n    this.keepnet      = st.keepnet     ?? this.keepnet;\n    this.keepnetCap   = st.keepnetCap  ?? this.keepnetCap;\n    this.gear         = st.gear        ?? this.gear;\n    this.rigDepthM    = st.rigDepthM   ?? this.rigDepthM;\n    this.locId        = st.locationId  || this.locId;\n    this.inventory    = st.inventory   ?? this.inventory;\n    this.activeBaitId = st.activeBaitId?? this.activeBaitId;\n    this.gear.inv   ||= {};\n    this.gear.inv.bait = this.inventory?.bait?.[this.activeBaitId] | 0;\n      if (st.progress?.xp != null)    this.progress.xp    = st.progress.xp|0;\n  if (st.progress?.level != null) this.progress.level = st.progress.level|0;\n  }\n\n  // --- 3) –î–µ–±–∞—É–Ω—Å-–∞–≤—Ç–æ—Å–µ–π–≤: VM + —Å–µ—Ä–≤–µ—Ä ---\n  let _saveTO = null;\n  this.commitState = () => {\n    const payload = {\n      wallet:this.wallet, keepnet:this.keepnet, keepnetCap:this.keepnetCap,\n      gear:this.gear, rigDepthM:this.rigDepthM,\n      locationId: this.locationMgr?.getCurrentId?.() || this.locId,\n      level:this.progress?.level,\n      progress:{ xp:this.progress?.xp, level:this.progress?.level },\n      inventory:this.inventory, activeBaitId:this.activeBaitId\n    };\n    if (VM.setMany) VM.setMany(payload); else {\n      VM.set('wallet', payload.wallet);\n      VM.set('keepnet', payload.keepnet);\n      VM.set('keepnetCap', payload.keepnetCap);\n      VM.set('gear', payload.gear);\n      VM.set('rigDepthM', payload.rigDepthM);\n      VM.set('locationId', payload.locationId);\n      VM.set('inventory', payload.inventory);\n      VM.set('activeBaitId', payload.activeBaitId);\n    }\n  console.log('[SAVE]', payload);                    // <-- –≤–∏–¥–Ω–æ –∫–∞–∂–¥–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ\n  clearTimeout(_saveTO);\n  _saveTO = setTimeout(() => {\n    // –µ—Å–ª–∏ –Ω–µ—Ç API_BASE ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ —à–ª—ë–º\n    if (window.API_BASE) API.saveState(payload).catch(()=>{});\n  }, 400);\n};\n\nwindow.addEventListener('beforeunload', () => this.commitState?.());\nthis.events.once('shutdown', () => this.commitState?.());\n\n  // --- 4) –õ–æ–∫–∞—Ü–∏—è/–≤—Ä–µ–º—è/—Ñ–æ–Ω ---\n  this.locationMgr = new LocationMgr(this, this.locId);\n  this.locationMgr.applyBackground();\n\n  const onPhaseChange = (phase) => {\n    const ti = this.timeCycle?.getInfo?.(); const t = ti?.t ?? 0;\n    this.locationMgr?.setPhaseBlend?.(phase, t);\n    this.timeOfDay = phase;     // –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–µ–≥ –¥–ª—è —Å–ø–∞–≤–Ω–∞\n  };\n  this.cameras.main.roundPixels = true;\n  this.timeCycle = new TimeCycle(this, {}, onPhaseChange);\n  { const ti = this.timeCycle.getInfo(); this.locationMgr?.setPhaseBlend?.(ti.phase, ti.t); this.timeOfDay = ti.phase; }\n\n\n  // --- 5) RUNTIME –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ---\n  this.bobber = null; this.biteTimer = null; this.toast = null;\n  this.fish = null; this.params = null; this.jerkTO = null;\n  this.fishTargetX = null; this.fishSideSpeed = 0; this.sideTimer = null;\n  this.kickTweening = false;\n  this.holdAcc = 0; this.HOLD_NEED = 0.1; this.SAFE_THR = 90;\n  this.baseSlipChance = 0.12; this.slipTO = null;\n  this.baitCharged = false;\n  this.uiLock = false;\n\n  // --- 6) UI: HUD/—Å–ª–æ—Ç—ã/–±–∞—Ä—ã/–º–æ–¥–∞–ª–∫–∏ ---\n  this.initInventory();\n  this.createHUD();\n  this.createSlots();\n  this.positionPullButtonAtSlotsLevel();\n\n  this.scale.on('resize', () => this.computeCastZone());\n\n  this.createBarsDock();\n  this.rodBar.setThreshold(this.SAFE_THR);\n  this.lineBar.setThreshold(this.SAFE_THR);\n  this.barsDock.setMode('idle');\n\n  this.modals = new ModalHost(this, UI.z.modal);\n\n  // –ü—Ä–æ–≥—Ä–µ—Å—Å\n  this.progress = new Progress(this);\n  if (st?.level != null) this.progress.level = st.level;\n\n  // –≠—Ñ—Ñ–µ–∫—Ç—ã/—Ä–µ–¥–∞–∫—Ç–æ—Ä\n  this.locationMgr.enableWaterFX({ amp: 2, waveLen: 56, speed: 22 });\n  this.locEditor = new LocationEditor(this, this.locId || 'lake');\n  this.locEditor.bindHotkeys();\n\n  // Top HUD\n  this.rigDepthM = this.rigDepthM ?? 1.20;\n  this.hud = new TopHUD(this, {\n    wallet: this.wallet,\n    progress: this.progress,\n    keepnetCapacity: this.keepnetCap ?? 25,\n    timeCycle: this.timeCycle,\n\n    onKeepnetClick: async () => {\n      if (!this.keepnet?.length){ this.showToast?.('–°–∞–¥–æ–∫ –ø—É—Å—Ç'); return; }\n      const res = await openKeepnetModal(this, this.keepnet, 0);\n      if (res?.action === 'release'){\n        this.hud.setKeepnet(this.keepnet.length, this.keepnetCap);\n        this.commitState?.();\n        onWalletChange(this.wallet);\n      }\n    },\n\n    onLocationPick: (locId) => {\n      if (this.state === 'fight'){ this.showToast('–ù–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –ª–æ–∫–∞—Ü–∏—é –≤–æ –≤—Ä–µ–º—è –≤—ã–≤–∞–∂–∏–≤–∞–Ω–∏—è'); return; }\n      this.abortFishingDueToLocationChange();\n      VM.snapshotFromStart?.(this);\n      this.commitState();\n      // —á–∞—Ç: –ø–æ–∫–∏–Ω—É—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–º–Ω–∞—Ç—É (–ø–æ–¥–∫–ª—é—á–∏–º—Å—è –≤ –Ω–æ–≤–æ–π —Å—Ü–µ–Ω–µ)\n      if (this.currentRoomId) this.ioClient?.leave(this.currentRoomId);\n      this.scene.start('LoadLoc', { locId });\n    },\n\n    onGoBase: () => {\n      if (this.state === 'fight'){ this.showToast('–ù–µ–ª—å–∑—è –Ω–∞ –±–∞–∑—É –≤–æ –≤—Ä–µ–º—è –≤—ã–≤–∞–∂–∏–≤–∞–Ω–∏—è'); return; }\n      this.abortFishingDueToLocationChange();\n      VM.snapshotFromStart?.(this);\n      this.commitState();\n      this.scene.start('Base');\n    },\n\n    getSlotsTop: () => this.slots?.yTop,\n    rigDepthM: this.rigDepthM,\n    onDepthChange: (v) => { this.rigDepthM = v; this._applyRigToBobber(); },\n    sonarCorner: 'left',\n    sonarAtTop:  true,\n  });\n\n  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å HUD-—á–∏—Å–ª–∞\n  this.hud.setWallet(this.wallet.coins|0, this.wallet.gold|0);\n  this.hud.setKeepnet(this.keepnet.length|0, this.keepnetCap|0);\n\n  // –ì–µ–æ–º–µ—Ç—Ä–∏—è –≤–æ–¥—ã\n  this.computeCastZone();\n  this.positionPullButtonAtSlotsLevel();\n\n// --- 7) –ß–ê–¢: –æ–¥–∏–Ω —Ä–∞–∑, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ ---\nif (window.API_BASE && window.io) {                 // —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω–æ –µ—Å—Ç—å –±—ç–∫–µ–Ω–¥\n  this.ioClient = new ChatClient(window.io, window.API_BASE);\n  this.currentRoomId = this.locationMgr.getCurrentId?.() || this.locId || 'lake';\n  this.ioClient.join?.(this.currentRoomId);\n\n  this.chatUI = new ChatOverlay(this, this.ioClient, this.currentRoomId);\n  this.chatUI?.loadHistory?.(API, 40);             // –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–∑–æ–≤\n}\n\n  // --- 8) –≠–∫–æ–Ω–æ–º–∏–∫–∞ / –∏–Ω–ø—É—Ç ---\n  this.marketCfg = {\n    kgPrice: 1,\n    valuableThreshold: 0.75,\n    recordThreshold: 0.95,\n    pieceMult: 3.0\n  };\n\n  this.input.on('pointerdown', (p) => {\n    if (this.uiLock) return;\n    if (this.state === 'fight' || this.state === 'result') return;\n    this.castLine(p.worldX, p.worldY);\n  });\n\n  // --- 9) –†–µ–≤–∞—Ä–¥—ã ---\n  setRewardSink((reward) => {\n    if (!reward) return;\n    const w = (this.wallet ||= { coins:0, gold:0, perks:0 });\n    if (reward.wallet?.coins) w.coins = (w.coins|0) + (reward.wallet.coins|0);\n    if (reward.wallet?.gold)  w.gold  = (w.gold|0)  + (reward.wallet.gold|0);\n    if (reward.perks?.skillPoints) w.perks = (w.perks|0) + (reward.perks.skillPoints|0);\n    this.updateWalletHUD?.();\n    this.commitState?.();\n    const parts = [];\n    if (reward.wallet?.coins) parts.push(`ü™ô +${reward.wallet.coins}`);\n    if (reward.wallet?.gold)  parts.push(`‚≠ê +${reward.wallet.gold}`);\n    if (reward.perks?.skillPoints) parts.push(`üí° +${reward.perks.skillPoints}`);\n    if (parts.length) this.showToast?.(`–ù–∞–≥–æ—Ä–æ–¥–∞: ${parts.join(' ')}`);\n  });\n\n  // --- 10) –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ UI ---\n  this.setPullUI('idle');\n}\n\n// --- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–∑—ã –¥–ª—è —Å–ø–∞–≤–Ω–∞ ---\n// 4 —Ñ–∞–∑—ã –≤–∏–∑—É–∞–ª–∫–∏ -> 3 –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –¥–ª—è —Å–ø–∞–≤–Ω–∞\n_spawnTimeFromPhase(phase){\n  switch (phase) {\n    case 'night': return 'night';\n    case 'dusk':  return 'evening';\n    case 'dawn':  return 'dawn';\n    case 'day':   // —Ä–∞—Å—Å–≤–µ—Ç –∏ –¥–µ–Ω—å —Å—á–∏—Ç–∞–µ–º \"day\"\n    default:      return 'day';\n  }\n}\n\n\n  // --- –ü–æ–ø–ª–∞–≤–æ–∫: –ª–æ–∂–∏—Ç—Å—è –ª–∏ –ø—Ä–∏ —Ç–µ–∫—É—â–µ–π –æ—Å–Ω–∞—Å—Ç–∫–µ/–≥–ª—É–±–∏–Ω–µ ---\n  _shouldLieByRig(actualDepth){\n    const minStand = this.bobber?.minStandingDepth ?? 0.45;\n    if (actualDepth < minStand) return true;\n    const EPS = 0.10; // 10 —Å–º\n    return (this.rigDepthM > actualDepth + EPS);\n  }\n  _applyRigToBobber(){\n    if (!this.bobber) return;\n    const d = this.locationMgr.getDepthAtXY(this.bobber.x, this.bobber.y);\n    const lie = this._shouldLieByRig(d);\n    this.bobber.setShallow(lie);\n  }\n\n  // --- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å/—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ---\n  initInventory(){\n    const invFromVM = VM.get?.('inventory');\n    if (invFromVM){\n      this.inventory = JSON.parse(JSON.stringify(invFromVM));\n    } else {\n      this.inventory = {\n        rods:  ['rod_wood_1'],\n        reels: ['reel_rusty'],\n        lines: ['line_old_1'],\n        hooks: ['hook_rusty'],\n        bait:  { worm: (this.gear?.inv?.bait ?? 25) }\n      };\n    }\n    this.gear.inv = this.gear.inv || {};\n    this.gear.inv.bait = (this.inventory?.bait?.worm | 0);\n  }\n\n  // === Gear helpers ===\n  getDefById(kind, id){\n    const arr = GearDB[kind + 's'] || [];\n    return arr.find(x => x.id === id) || null;\n  }\n  buildOwnedList(kind){\n    const ids = this.inventory[kind + 's'] || [];\n    return ids.map(id => this.getDefById(kind, id)).filter(Boolean);\n  }\n  mergeGearKeepingRuntime(kind, def){\n    if (!def) return;\n    const slot = this.gear[kind] || (this.gear[kind] = {});\n    if (kind === 'rod'){\n      slot.id = def.id; slot.name = def.name; slot.capKg = def.capKg;\n      if (slot.durability == null) slot.durability = 100;\n      return;\n    }\n    if (kind === 'line'){\n      slot.id = def.id; slot.name = def.name; slot.capKg = def.capKg;\n      if (slot.durability == null) slot.durability = 100;\n      return;\n    }\n    if (kind === 'reel'){\n      slot.id = def.id; slot.name = def.name; slot.pullBoost = def.pullBoost;\n      return;\n    }\n    if (kind === 'hook'){\n      const prevId = slot.id;\n      slot.id = def.id; slot.name = def.name; slot.control = def.control;\n      if (prevId !== def.id){\n        const stacks = this.inventory.hookPacks || {};\n        slot.count = Math.max(0, stacks[def.id] | 0);\n      } else {\n        if (slot.count == null || slot.count <= 0){\n          const stacks = this.inventory.hookPacks || {};\n          slot.count = Math.max(0, stacks[def.id] | 0);\n        }\n      }\n      return;\n    }\n  }\n\n  // --- –º–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ —Å–Ω–∞—Å—Ç–µ–π ---\n  openGearModal(kind){\n    if (this.state === 'fight') { this.showToast('–ù–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å —Å–Ω–∞—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–≤–∞–∂–∏–≤–∞–Ω–∏—è'); return; }\n    const supported = ['rod','reel','line','hook'];\n    if (!supported.includes(kind)) return;\n\n    const list = this.buildOwnedList(kind);\n    const activeId = this.gear?.[kind]?.id ?? null;\n    const onPick = (def) => {\n      this.mergeGearKeepingRuntime(kind, def);\n      this.slots?.update(this.gear);\n      this.computeCastZone();\n      this.showToast(`${def.name} —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–∞`);\n    };\n\n    this.uiLock = true;\n    this._gearModal = new GearModal(\n      this, kind, list, activeId, onPick,\n      () => { this.uiLock = false; this._gearModal = null; }\n    );\n  }\n\n  // --- HUD: –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ---\n  createHUD(){\n    const W = this.scale.width, H = this.scale.height;\n    this.pullBtnSize = 128;\n    const btnW = this.pullBtnSize, btnH = this.pullBtnSize;\n    const PAD = UI.layout.pull.outerPad;\n\n    const tempX = W - PAD - btnW / 2;\n    const tempY = H - PAD - btnH / 2;\n\n    this.pullPressed = false;\n    this.pullEnabled = false;\n\n    this.pullBtnBg = this.add.rectangle(tempX, tempY, btnW, btnH, 0x3a3a3a, 1)\n      .setStrokeStyle(2, 0xffffff, 0.5)\n      .setInteractive()\n      .setDepth(810);\n\n    this.pullBtnLabel = this.add.text(tempX, tempY, '', {\n      fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n    }).setOrigin(0.5).setDepth(811);\n\n    this.pullBtnBg.on('pointerdown', () => {\n      if (!this.pullEnabled) return;\n      if (this.state === 'bite') { this.attemptHook(); return; }\n      if (this.state === 'fight') { this.pullPressed = true; this.pullBtnBg.setFillStyle(0x1573cc,1); }\n    });\n    this.pullBtnBg.on('pointerup',   () => {\n      if (!this.pullEnabled) return;\n      if (this.state === 'fight') { this.pullPressed = false; this.pullBtnBg.setFillStyle(0x1e90ff,1); }\n    });\n    this.pullBtnBg.on('pointerout',  () => {\n      if (!this.pullEnabled) return;\n      if (this.state === 'fight') { this.pullPressed = false; this.pullBtnBg.setFillStyle(0x1e90ff,1); }\n    });\n  }\n\n  setPullUI(mode){\n    this.tweens.killTweensOf(this.pullBtnBg);\n    this.tweens.killTweensOf(this.pullBtnLabel);\n\n    if (mode === 'idle'){\n      this.pullEnabled = false; this.pullPressed = false;\n      this.pullBtnBg.setFillStyle(0x3a3a3a, 1).setAlpha(0.35);\n      this.pullBtnLabel.setText('');\n    }\n    if (mode === 'bite'){\n      this.pullEnabled = true; this.pullPressed = false;\n      this.pullBtnBg.setFillStyle(0xff8c00, 1).setAlpha(1);\n      this.pullBtnLabel.setText('–ü–æ–¥—Å–µ—á—å');\n      this.tweens.add({\n        targets:[this.pullBtnBg,this.pullBtnLabel],\n        alpha: { from:1, to:0.65 }, duration:500, yoyo:true, repeat:-1, ease:'Sine.inOut'\n      });\n    }\n    if (mode === 'fight'){\n      this.pullEnabled = true; this.pullPressed = false;\n      this.pullBtnBg.setFillStyle(0x1e90ff, 1).setAlpha(1);\n      this.pullBtnLabel.setText('–¢—è–Ω—É—Ç—å');\n    }\n  }\n\n  abortFishingDueToLocationChange(){\n    if (this.bobber) this.bobber?.stopAllTweens();\n    this.clearAttempt();\n    this.barsDock.setMode('idle');\n    this.setPullUI('idle');\n    this.state = 'idle';\n  }\n\n  createBarsDock(){\n    const btnRect = { x: this.pullBtnBg.x, width: this.pullBtnSize, height: this.pullBtnSize };\n    this.barsDock = new BarsDock(this, this.slots, btnRect);\n    this.rodBar  = this.barsDock.rodBar;\n    this.lineBar = this.barsDock.lineBar;\n    this.barsDock.setMode('idle');\n  }\n\n  positionPullButtonAtSlotsLevel(){\n    const size = this.pullBtnSize;\n    const PAD = UI.layout.pull.outerPad;\n    const x = this.scale.width - PAD - size / 2;\n    const y = this.slots.yTop + (this.slots.h / 2);\n    this.pullBtnBg.setPosition(x, y);\n    this.pullBtnLabel.setPosition(x, y);\n  }\n\n  createSlots(){\n    const onClick = {\n      rod:  () => this.openGearModal('rod'),\n      reel: () => this.openGearModal('reel'),\n      line: () => this.openGearModal('line'),\n      hook: () => this.openGearModal('hook'),\n      bait: () => this.openBaitModal(),\n    };\n    this.slots = new GearSlots(this, this.gear, onClick);\n  }\n\n  setBarsVisible(v){ this.rodBar.setVisible(v); this.lineBar.setVisible(v); }\n\ncomputeCastZone(){\n  // const H = this.scale.height;\n\n  // // –≤–µ—Ä—Ö –≤–æ–¥—ã\n  // this.castTopY = Math.max(120, Math.floor(H * 0.46));\n\n  // // –Ω–∏–∑ –≤–æ–¥—ã = –≥–¥–µ –∫–æ–Ω—á–∞–µ—Ç—Å—è ¬´–∏–≥—Ä–æ–≤–æ–π¬ª —ç–∫—Ä–∞–Ω (–≤—ã—à–µ —Å–ª–æ—Ç–æ–≤ –∏ –∫–Ω–æ–ø–∫–∏)\n  // const btnTop   = this.pullBtnBg.y - this.pullBtnSize / 2 - 8;\n  // const slotsTop = this.slots ? (this.slots.yTop - 8) : H;\n  // this.castBottomY = Math.min(btnTop, slotsTop);\n\n  // // –ª–æ–≥–∏—á–µ—Å–∫–∏–π ¬´–±–µ—Ä–µ–≥¬ª –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –Ω–∏–∑ –ø—Ä–∏ –±–æ—é —Å–æ–≤–ø–∞–¥–∞—é—Ç\n  // this.logicShoreY   = this.castBottomY;\n  // this.visualBottomY = this.castBottomY;\n\n  // // <- –∫–ª—é—á: –ª–æ—á–∏–º –≤–æ–¥—É –≤–Ω—É—Ç—Ä–∏ LocationMgr, —á—Ç–æ–±—ã —Ä–µ—Å–∞–π–∑ –µ—ë –Ω–µ –ø–µ—Ä–µ—Ç—ë—Ä\n  // this.locationMgr.setWaterArea(this.castTopY, this.castBottomY, { lock:true });\n  const area = this.locationMgr?.getWaterArea?.();\n  const H = this.scale.height;\n\n  const top    = area?.top    ?? Math.max(120, Math.floor(H*0.46));\n  const bottom = area?.bottom ?? (H - 2);\n\n  this.castTopY     = top;\n  this.castBottomY  = bottom;\n  this.logicShoreY  = bottom;\n  this.visualBottomY = bottom;\n\n}\n\n\n  castLine(x, y){\n   if (!this.locationMgr.canCastAt(x, y)){\n   this.showToast('–°—é–¥–∞ –∑–∞–±—Ä–æ—Å–∏—Ç—å –Ω–µ–ª—å–∑—è'); return;\n   }\n  if ((this.gear.inv.bait ?? 0) <= 0){\n    this.showToast('–ù—É–∂–Ω–∞ –Ω–∞–∂–∏–≤–∫–∞ (—á–µ—Ä–≤—å)'); return;\n  }\n    this.clearAttempt();\n\n    this.bobber = new Bobber(this, x, y);\n    this.bobber.startIdleBobbing();\n\n    this.hud.showSonarAt(x, y);\n    this.hud.setSonarFollowX(false);\n    this.hud.updateSonarDot(y);\n\n    const waterDepth = this.locationMgr.getDepthAtXY(x, y);\n    const hookDepth  = Math.min(this.rigDepthM ?? 0, waterDepth);\n    this._waterDepthAtCast = waterDepth;\n    this._hookDepthAtCast  = hookDepth;\n    this._castDepthM       = hookDepth;\n\n    this._applyRigToBobber();\n\n    this.state = 'waiting';\n    this.barsDock.setMode('idle');\n    this.setPullUI('idle');\n\n    const delay = Phaser.Math.Between(1000,1000);\n    this.biteTimer = this.time.delayedCall(delay, () => this.onBite());\n  }\n\n  onBite(){\n    if (!this.bobber) return;\n    this.state = 'bite';\n    \nconst tinfo = this.timeCycle?.getInfo?.() || { phase:'day' };\nconst picked = spawnFish({\n  bait: this._getActiveBaitId?.() ?? this.activeBaitId ?? 'worm',\n  timeOfDay: this._spawnTimeFromPhase?.(tinfo.phase) ?? tinfo.phase ?? 'day',\n  locationId: this.locationMgr.getCurrentId?.() || this.locationMgr.current || 'lake',\n  depthM: this._hookDepthAtCast ?? this._castDepthM ?? 0,\n  cast: { x: this.bobber.x, y: this.bobber.y },\n  getAreaMods: (x, y) =>\n    this.locationMgr.getSpeciesAreaModsAt?.(x, y) ||\n    this.locationMgr.getSpotModsAt?.(x, y) || null\n});\n\n\n    if (!picked){\n      this.showToast('–ó–¥–µ—Å—å –Ω–∞ —ç—Ç—É –Ω–∞–∂–∏–≤–∫—É –∏ –≥–ª—É–±–∏–Ω—É –Ω–µ –∫–ª—é—ë—Ç. –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥—É—é –≥–ª—É–±–∏–Ω—É/–Ω–∞–∂–∏–≤–∫—É.');\n      this.state = 'waiting';\n      const delay = Phaser.Math.Between(5000, 12000);\n      this.biteTimer = this.time.delayedCall(delay, () => this.onBite());\n      return;\n    }\n\n    this.fish = picked;\n    this.bobber?.biteShake();\n\n    this.hookActive = true;\n    this.hookStartMs = this.time.now;\n    this.hookMin = 250; this.hookMax = 1600; this.hookSweet = 850;\n    this.hookTO = this.time.delayedCall(this.hookMax, () => {\n      if (this.hookActive) this.fishEscape('–ü–æ–∑–¥–Ω–æ –ø–æ–¥—Å–µ–∫–ª–∏ ‚Äî —É–ª–æ–≤ —É—à—ë–ª');\n    });\n\n    this.setPullUI('bite');\n    this.showToast('–ö–ª—é—ë—Ç! –ü–æ–¥—Å–µ–∫–∏—Ç–µ!');\n  }\n\n  attemptHook(){\n    if (!this.hookActive) return;\n    const dt = this.time.now - this.hookStartMs;\n    if (dt < this.hookMin) return this.fishEscape('–°–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ –ø–æ–¥—Å–µ–∫–ª–∏ ‚Äî —Ä—ã–±–∞ —É—à–ª–∞');\n    if (dt > this.hookMax) return this.fishEscape('–ü–æ–∑–¥–Ω–æ –ø–æ–¥—Å–µ–∫–ª–∏ ‚Äî —Ä—ã–±–∞ —É—à–ª–∞');\n\n    if (this.bobber) this.tweens.killTweensOf(this.bobber);\n\n    const halfWin = (this.hookMax - this.hookMin) / 2;\n    const norm = Math.min(Math.abs(dt - this.hookSweet), halfWin) / halfWin;\n    const hookQ = 1 - norm;\n    this.hookQ = hookQ;\n    this.slipGraceUntil = this.time.now + 2500;\n\n    this.hookActive = false; if (this.hookTO){ this.hookTO.remove(); this.hookTO = null; }\n    this.bobber?.stopAllTweens();\n    this.params = calcFightParams(this.gear, this.fish, hookQ);\n\n    // –°–º—è–≥—á–µ–Ω–∏–µ –¥–ª—è –Ω–µ-—Ä—ã–±—ã\n    if (this.fish?.kind && this.fish.kind !== 'fish'){\n      const K = ({ loot:0.35, trash:0.25, bycatch:0.50 }[this.fish.kind] ?? 0.35);\n      this.params.rodUp         = (this.params.rodUp        ?? 18) * K;\n      this.params.lineUp        = (this.params.lineUp       ?? 22) * K;\n      this.params.down          = (this.params.down         ?? 12) * 0.6;\n      this.params.fishPullSpeed = (this.params.fishPullSpeed?? 70) * K;\n      this.params.pullSpeed     = (this.params.pullSpeed    ?? 120) * 1.0;\n      this.params.escapeLimit   = Math.max(2.0, (this.params.escapeLimit ?? 3.2) * 1.6);\n      const j = this.params.jerk || { add: 4, chance: 0.4, minMs: 900, maxMs: 1600 };\n      j.add    = (j.add ?? 4) * (0.35 * K + 0.15);\n      j.chance = Math.min(0.15, (j.chance ?? 0.4) * 0.35);\n      j.minMs  = Math.max(900, (j.minMs ?? 900) * 1.5);\n      j.maxMs  = Math.max(j.minMs + 200, (j.maxMs ?? 1600) * 1.6);\n      this.params.jerk = j;\n    }\n\n    this.fishSideSpeed = this.params.fishPullSpeed * 0.75;\n    this.fishTargetX = this.bobber.x;\n    if (this.sideTimer) this.sideTimer.remove();\n    this.sideTimer = this.time.addEvent({\n      delay: Phaser.Math.Between(600, 1200), loop: true,\n      callback: () => {\n        const margin = 30;\n        this.fishTargetX = Phaser.Math.Between(margin, this.scale.width - margin);\n      }\n    });\n\n    this.state = 'fight';\n    this.hud.setSonarFollowX(true);\n    this.hud.setSonarFight?.(true);\n\n    this.tailPx = 0;\n\n    this.rodVal = 0; this.lineVal = 0;\n    this.pullPressed = false; this.noPullTime = 0; this.holdAcc = 0; this.baitCharged = false;\n    this.hud?.update();\n\n    this.barsDock.setMode('fight');\n    this.setPullUI('fight');\n\n\n    const dist = this.logicShoreY - this.bobber.y;\n    if (dist < 28){\n      const KICK = 12;\n      const targetY = Math.max(this.castTopY + 16, this.bobber.y - KICK);\n      const targetX = Phaser.Math.Clamp(this.bobber.x + Phaser.Math.Between(-24, 24), 20, this.scale.width - 20);\n      this.kickTweening = true;\n      this.tweens.add({\n        targets: this.bobber, y: targetY, x: targetX,\n        duration: 140, ease: 'Sine.out', onComplete: () => { this.kickTweening = false; }\n      });\n    }\n\n    this.queueSlip();\n    this.scheduleNextJerk();\n  }\n\n  queueSlip(){\n    if (this.slipTO) this.slipTO.remove();\n    const delay = Phaser.Math.Between(2000, 2800);\n    this.slipTO = this.time.delayedCall(delay, () => this.trySlip());\n  }\n  trySlip(){\n    if (this.state !== 'fight') return;\n    let chance = this.baseSlipChance / (this.gear.hook?.control ?? 1.0);\n    chance *= this.pullPressed ? 0.5 : 1.1;\n    if (this.rodVal >= 90 || this.lineVal >= 90) chance *= 1.25;\n    if (Math.random() < chance) this.fishEscape('–†—ã–±–∞ —Å–æ—à–ª–∞');\n    else this.queueSlip();\n  }\n\n  scheduleNextJerk(){\n    if (!this.params?.jerk) return;\n    const { minMs, maxMs } = this.params.jerk;\n    const delay = Phaser.Math.Between(minMs, maxMs);\n    this.jerkTO = this.time.delayedCall(delay, () => {\n      this.applyJerk();\n      this.scheduleNextJerk();\n    });\n  }\n\n  applyJerk(){\n    if (this.state !== 'fight' || !this.params?.jerk) return;\n    const { add, chance } = this.params.jerk;\n    if (Math.random() > chance) return;\n    const k = this.pullPressed ? 1.0 : 1.15;\n    const bump = add * (0.85 + Math.random() * 0.3) * k;\n    this.rodVal  = Phaser.Math.Clamp(this.rodVal  + bump, 0, 100);\n    this.lineVal = Phaser.Math.Clamp(this.lineVal + bump, 0, 100);\n    this.rodBar.set(this.rodVal);\n    this.lineBar.set(this.lineVal);\n    if (this.bobber) this.bobber.y = Math.max(this.castTopY + 8, this.bobber.y - 4);\n  }\n\n  update(_, delta){\nconst ti = this.timeCycle?.getInfo?.();\nif (ti){\n  this.timeOfDay = ti.phase;               // –¥–ª—è —Å–ø–∞–≤–Ω–∞\n  this.hud?.clock?.update?.();             // –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —á–∞—Å—ã\n}\n\nthis.hud?.update();\n\nif (this.bobber && (this.state === 'idle' || this.state === 'waiting')) {\n  this.hud.updateSonarDot(this.bobber.y);\n  this._applyRigToBobber();\n}\n\nif (this.state === 'fight' && this.bobber){\n  const tension = Math.max(this.rodVal, this.lineVal) / 100;\n  this.hud.updateSonarDot(this.bobber.y, {\n    tension,\n    reeling: this.pullPressed,\n    allowXDrift: true\n  });\n}\n\nif (this.state !== 'fight' || !this.params) {\n  // –ù–µ-–±–æ–µ–≤–æ–π –∞–ø–¥–µ–π—Ç ‚Äî –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –ª–∏—à—å –ø–æ–¥–∂–∞—Ç—å bobber –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤–æ–¥—ã –∏ –≤—ã–π—Ç–∏\n  if (this.bobber){\n    const bottomClamp = this.castBottomY;\n    this.bobber.y = Phaser.Math.Clamp(this.bobber.y, this.castTopY + 8, bottomClamp);\n  }\n  return;\n}\n\n\n    const dt = delta / 1000;\n    const P = this.params;\n\n    // –í—Ä–µ–º–µ–Ω–Ω—ã–π ¬´–∫–∏–∫¬ª –ø–æ—Å–ª–µ —Ö—É–∫–∞\n    if (this.kickTweening){\n      if (this.pullPressed){ this.rodVal += P.rodUp*dt; this.lineVal += P.lineUp*dt; }\n      else                 { this.rodVal -= P.down*dt;  this.lineVal -= P.down*dt;  }\n      this.rodVal  = Phaser.Math.Clamp(this.rodVal,  0, 100);\n      this.lineVal = Phaser.Math.Clamp(this.lineVal, 0, 100);\n      this.rodBar.set(this.rodVal); this.lineBar.set(this.lineVal);\n      return;\n    }\n\n    // –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ\n    if (this.pullPressed){ this.rodVal += P.rodUp*dt; this.lineVal += P.lineUp*dt; }\n    else                 { this.rodVal -= P.down*dt;  this.lineVal -= P.down*dt;  }\n    this.rodVal  = Phaser.Math.Clamp(this.rodVal,  0, 100);\n    this.lineVal = Phaser.Math.Clamp(this.lineVal, 0, 100);\n    this.rodBar.set(this.rodVal); this.lineBar.set(this.lineVal);\n\n    // –ü–æ–ª–æ–º–∫–∏\n    if (this.rodVal >= 100 && this.lineVal >= 100) return (Math.random()<0.5? this.breakRod(): this.breakLine());\n    if (this.rodVal >= 100) return this.breakRod();\n    if (this.lineVal >= 100) return this.breakLine();\n\n    // –î–≤–∏–∂–µ–Ω–∏–µ –ø–æ Y\n    const distToShore = this.logicShoreY - this.bobber.y;\n    const nearShoreFactor = Phaser.Math.Clamp(distToShore / 160, 0.50, 1.0);\n\n    if (this.pullPressed){\n      this.noPullTime = 0;\n      this.bobber.y += P.pullSpeed * nearShoreFactor * dt;\n    } else {\n      this.noPullTime += dt;\n      const topEdge = this.castTopY + 8;\n      const distTop = this.bobber.y - topEdge;\n      const slow = Phaser.Math.Clamp(distTop / 60, 0.25, 1);\n      this.bobber.y -= P.fishPullSpeed * slow * dt;\n    }\n\n    // –î–≤–∏–∂–µ–Ω–∏–µ –ø–æ X\n    if (this.fishTargetX != null){\n      const dx = this.fishTargetX - this.bobber.x;\n      let sideMult = this.pullPressed ? 0.35 : 1.0;\n      if (this.bobber.y >= this.logicShoreY - 6) sideMult *= 0.25;\n      const step = this.fishSideSpeed * dt * sideMult;\n      const move = Phaser.Math.Clamp(dx, -step, step);\n      this.bobber.x += move;\n    }\n\n    // –ö–ª–∞–º–ø—ã\n    this.bobber.x = Phaser.Math.Clamp(this.bobber.x, 20, this.scale.width - 20);\n    const bottomClamp = (this.state === 'fight') ? this.visualBottomY : this.castBottomY;\n    this.bobber.y = Phaser.Math.Clamp(this.bobber.y, this.castTopY + 8, bottomClamp);\n\n    // ¬´–£—à–ª–∞ –≤–≤–µ—Ä—Ö¬ª\n    if (this.noPullTime > P.escapeLimit || this.bobber.y <= this.castTopY + 8){\n      return this.fishEscape('–†—ã–±–∞ —Å–æ—Ä–≤–∞–ª–∞—Å—å');\n    }\n\n    // –£–¥–µ—Ä–∂–∞–Ω–∏–µ —É –±–µ—Ä–µ–≥–∞\n    const atShore = (this.bobber.y >= this.logicShoreY - 6);\n    const tensionMax = Math.max(this.rodVal, this.lineVal);\n    const safe = tensionMax < (this.SAFE_THR + 10);\n    if (atShore && safe){\n      const k = this.pullPressed ? 1.0 : 0.6;\n      this.holdAcc += dt * k;\n      if (this.holdAcc >= this.HOLD_NEED) return this.landFish();\n    } else {\n      this.holdAcc = 0;\n    }\n  }\n\n  breakRod(){\n    this.showToast('–£–¥–æ—á–∫–∞ —Å–ª–æ–º–∞–ª–∞—Å—å!');\n    this.gear.rod.durability = Math.max(0, (this.gear.rod.durability ?? 100) - 20);\n    this.chargeBaitOnce();\n    this.slots?.update(this.gear);\n    this.endFight('break');\n  }\n\n  breakLine(){\n    this.showToast('–õ–µ—Å–∫–∞ –ø–æ—Ä–≤–∞–ª–∞—Å—å!');\n    this.gear.line.durability = Math.max(0, (this.gear.line.durability ?? 100) - 25);\n\n    const hid = this.gear.hook?.id;\n    if (hid){\n      const cur = this.gear.hook.count|0;\n      this.gear.hook.count = Math.max(0, cur - 1);\n      const stacks = this.inventory.hookPacks || (this.inventory.hookPacks = {});\n      stacks[hid] = Math.max(0, (stacks[hid]|0) - 1);\n      if (stacks[hid] === 0) this.showToast('–ö—Ä—é—á–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å');\n    }\n\n    this.chargeBaitOnce();\n    this.slots?.update(this.gear);\n    this.endFight('break');\n  }\n\n  fishEscape(msg='–†—ã–±–∞ —É—à–ª–∞'){\n    this.showToast(msg);\n    this.chargeBaitOnce();\n    this.endFight('escape');\n  }\n\n  // ‚Äî‚Äî‚Äî –§–∏–Ω–∞–ª –ø–æ–∏–º–∫–∏ ‚Äî‚Äî‚Äî\nasync landFish(){\n  this.chargeBaitOnce();\n  const pick = this.fish;\n\n  // –æ–±—â–∏–π UI-–ø–µ—Ä–µ—Ö–æ–¥ –∏–∑ –±–æ—è\n  this.barsDock.setMode('idle');\n  this.setPullUI('idle');\n\n  // –æ–±—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∫–≤–µ—Å—Ç–∞/—Å–ø–∞–≤–Ω–∞\n  const questCtx = {\n    locationId: this.locationMgr.getCurrentId?.() || this.locationMgr.current || this.locId || 'lake',\n    depthM:     this._hookDepthAtCast ?? this._castDepthM ?? this.rigDepthM,\n    bait:       this._getActiveBaitId?.() ?? this.activeBaitId ?? 'worm'\n  };\n\n  // –ö–ê–†–¢–ò–ù–ö–ê –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏\n  pick.imageKey = pick.imageKey || (pick.kind==='fish' ? PhotoBank.key('fish', pick.id)\n                                                       : PhotoBank.key('pick', pick.id));\n\n  // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ \"result\" –Ω–∞ –≤—Ä–µ–º—è –º–æ–¥–∞–ª–∫–∏\n  const prevState = this.state;\n  const prevLock  = this.uiLock;\n  this.state  = 'result';\n  this.uiLock = true;\n\n  // ‚Üê –ü–û–ö–ê–ó–´–í–ê–ï–ú –ú–û–î–ê–õ–ö–£ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ç—Ä–∏–≥–≥–µ—Ä–∏–º –∫–≤–µ—Å—Ç—ã (–≤–Ω—É—Ç—Ä–∏ handleCatch)\n  const action = await handleCatch(this, pick, questCtx);\n  // action: 'keep'|'release' –¥–ª—è —Ä—ã–±—ã, 'take'|'drop' –¥–ª—è –ª—É—Ç–∞\n\n  // –í–û–ó–í–†–ê–¢ UI\n  this.uiLock = prevLock;\n  this.state  = 'idle';\n\n  if (pick.kind !== 'fish') {\n    // –õ–£–¢/–ú–£–°–û–† ‚Äî –º–æ–Ω–µ—Ç—ã, –µ—Å–ª–∏ –≤–∑—è–ª–∏\n    const coins = pick?.reward?.coins | 0;\n    if (action === 'take' && coins > 0) {\n      this.wallet.coins = (this.wallet.coins|0) + coins;\n      this.hud.setWallet(this.wallet.coins|0, this.wallet.gold|0);\n      this.commitState?.();\n      onWalletChange(this.wallet); // QUEST HOOK–°S\n    }\n    this.setPullUI('idle');\n    this.clearAttempt();\n    return;\n  }\n\n  // –†–´–ë–ê ‚Äî XP + —Å–∞–¥–æ–∫\n  const award = (released) => {\n    const base = this.progress.xpForFish(pick);\n    const res  = this.progress.grantCatchXP(pick, { released });\n    this.hud?.level?.update?.();\n    if (res.leveled > 0) this.hud?.level?.pulse?.();\n    onLevelChange({ level: this.progress.level, xp: this.progress.xp }); // QUEST HOOKS\n    this.showToast(`+${released ? base * 2 : base} XP`);\n  };\n\n  if (action === 'keep' && this.keepnet.length < this.keepnetCap){\n    this.keepnet.push(pick);\n    this.hud.setKeepnet(this.keepnet.length, this.keepnetCap);\n    this.commitState?.();\n    award(false);\n  } else {\n    award(true);\n  }\n\n this.ioClient?.announceCatch?.({\n  fishId: pick.id, name: pick.name, weightKg: pick.weightKg, lengthCm: pick.lengthCm,\n  rarity: pick.rarity, photoKey: pick.imageKey\n});\n\n  this.clearAttempt();\n  this.state = 'idle';\n}\n\nupdateWalletHUD(){\n  this.hud?.setWallet(this.wallet.coins|0, this.wallet.gold|0, this.wallet.perks|0);\n}\n\n  endFight(){\n    this.hud.setSonarFollowX(false);\n    this.hud.setSonarFight?.(false);\n    this.clearAttempt();\n    this.barsDock.setMode('idle');\n    this.setPullUI('idle');\n    this.state = 'idle';\n    this.tailPx = 0;\n  }\n\n  // ‚Äî‚Äî‚Äî –ù–∞–∂–∏–≤–∫–∞ ‚Äî‚Äî‚Äî\n  _getActiveBaitId(){ return this.activeBaitId || 'worm'; }\n  _getBaitCount(){\n    const id = this._getActiveBaitId();\n    return this.inventory?.bait?.[id] | 0;\n  }\n  _setBaitCount(v){\n    const id = this._getActiveBaitId();\n    const bag = this.inventory.bait || (this.inventory.bait = {});\n    bag[id] = Math.max(0, v|0);\n    this.gear.inv.bait = bag[id];\n    this.slots?.update(this.gear);\n  }\n  chargeBaitOnce(){\n    if (this.baitCharged) return;\n    const n = this._getBaitCount();\n    if (n <= 0) return;\n    this.baitCharged = true;\n    this._setBaitCount(n - 1);\n  }\n\n  openBaitModal(){\n    if (this.state === 'fight'){ this.showToast('–ù–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –Ω–∞–∂–∏–≤–∫—É –≤–æ –≤—Ä–µ–º—è –≤—ã–≤–∞–∂–∏–≤–∞–Ω–∏—è'); return; }\n\n    const W = this.scale.width, H = this.scale.height;\n    const PW = Math.min(520, W-80), PH = Math.min(360, H-120);\n    const cx = Math.round(W/2), cy = Math.round(H/2);\n    const D  = 2100;\n\n    this.uiLock = true;\n    const ui = this.add.container(0,0).setDepth(D);\n\n    const overlay = this.add.rectangle(0,0,W,H,0x000000,0.6)\n      .setOrigin(0,0).setScrollFactor(0).setInteractive();\n    const shadow = this.add.rectangle(cx+2, cy+3, PW, PH, 0x000000, 0.22);\n    const panel  = this.add.rectangle(cx, cy, PW, PH, 0x1f2433, 1).setStrokeStyle(2, 0xffffff, 0.22);\n    const title  = this.add.text(cx, cy - PH/2 + 16, '–í—ã–±–æ—Ä –Ω–∞–∂–∏–≤–∫–∏', {\n      fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n    }).setOrigin(0.5,0);\n    const close = this.add.text(cx + PW/2 - 18, cy - PH/2 + 6, '‚úï', {\n      fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n    }).setOrigin(1,0).setInteractive();\n\n    ui.add([overlay, shadow, panel, title, close]);\n\n    const bag = this.inventory?.bait || {};\n    const ids = Object.keys(bag);\n    if (ids.length === 0){\n      const t = this.add.text(cx, cy, '–ù–∞–∂–∏–≤–∫–∏ –Ω–µ—Ç', { fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#cfd8dc' }).setOrigin(0.5);\n      ui.add(t);\n    } else {\n      const names = {};\n      (ShopCatalog?.items?.bait || []).forEach(b => names[b.id] = b.name);\n\n      const rowH = 56, gap = 10;\n      const totalH = ids.length*rowH + (ids.length-1)*gap;\n      let y = Math.round(cy - totalH/2 + rowH/2) + 10;\n\n      ids.forEach((id)=>{\n        const w = PW - 40, h = rowH;\n        const g = this.add.container(cx, y);\n        const bg = this.add.rectangle(0,0,w,h,0x2a3144,1).setStrokeStyle(2,0xffffff,0.16).setInteractive({useHandCursor:true});\n        const label = names[id] || id;\n        const count = bag[id] | 0;\n\n        const nameTxt  = this.add.text(-w/2 + 12, 0, label, { fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#ffffff' }).setOrigin(0,0.5);\n        const cntTxt   = this.add.text(nameTxt.x + nameTxt.width + 10, 0, `‚Ä¢ ${count} —à—Ç.`, { fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#a7ffeb' }).setOrigin(0,0.5);\n\n        const btnW=110, btnH=30;\n        const btn = this.add.rectangle(w/2 - btnW/2 - 8, 0, btnW, btnH, 0x3b4662,1).setStrokeStyle(2,0xffffff,0.18);\n        const btnLbl = this.add.text(btn.x, btn.y, (count>0?'–í—ã–±—Ä–∞—Ç—å':'–ù–µ—Ç'), { fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#ffffff' }).setOrigin(0.5);\n\n        if (count>0){\n          btn.setInteractive({useHandCursor:true})\n            .on('pointerover', ()=> btn.setFillStyle(0x435074,1))\n            .on('pointerout',  ()=> btn.setFillStyle(0x3b4662,1))\n            .on('pointerdown', ()=> {\n              this.activeBaitId = id;\n              this.gear.inv.bait = bag[id] | 0;\n              this.slots?.update(this.gear);\n              this.showToast(`–ù–∞–∂–∏–≤–∫–∞: ${label}`);\n              this.commitState?.();\n              cleanup();\n            });\n        } else {\n          btn.setFillStyle(0x2c3446,1);\n          btnLbl.setColor('#bfc7d9');\n        }\n\n        g.add([bg, nameTxt, cntTxt, btn, btnLbl]);\n        ui.add(g);\n        y += rowH + gap;\n      });\n    }\n\n    const cleanup = ()=>{\n      ui.destroy();\n      this.time.delayedCall(16, ()=> this.uiLock = false);\n    };\n    close.on('pointerdown', cleanup);\n    overlay.on('pointerdown', (p)=>{ p.stopPropagation(); cleanup(); });\n    this.input.keyboard?.once('keydown-ESC', cleanup);\n  }\n\n  clearAttempt(){\n    if (this.hookTO) { this.hookTO.remove(); this.hookTO = null; }\n    if (this.slipTO) { this.slipTO.remove(); this.slipTO = null; }\n    this.hookActive = false;\n\n    if (this.sideTimer) { this.sideTimer.remove(); this.sideTimer = null; }\n    this.fishTargetX = null; this.fishSideSpeed = 0;\n\n    if (this.biteTimer) { this.biteTimer.remove(); this.biteTimer = null; }\n\n    if (this.bobber){\n      this.bobber.stopAllTweens();\n      this.bobber.destroy();\n      this.bobber = null;\n    }\n\n    this.hud.hideSonar();\n    this.hud.setSonarFight?.(false);   \n\n    this.fish = null; this.params = null;\n    this.kickTweening = false;\n    this.holdAcc = 0;\n    this.baitCharged = false;\n    if (this.jerkTO) { this.jerkTO.remove(); this.jerkTO = null; }\n  }\n\n  showToast(text){\n    const W = this.scale.width, H = this.scale.height;\n    if (this.toast) this.toast.destroy();\n    const t = this.add.text(W/2, H-20, text, {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n    }).setOrigin(0.5,1);\n    this.toast = t;\n    this.tweens.add({ targets:t, alpha:0, duration:1500, delay:900, onComplete:()=>t.destroy() });\n  }\n\n}\n\nexport default Start;\n","\n// src/data/pricing.js\n// –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ü–µ–Ω. –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø–æ –≤–∏–¥–∞–º.\nexport const PriceRules = {\n  // –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é\n  _default: { kgPrice: 60, premiumMult: 2.5, premiumMinKg: 1.2, recordKg: 5 },\n\n  // –ø—Ä–∏–º–µ—Ä—ã –≤–∏–¥–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:\n  '–û–∫—É–Ω—å': { kgPrice: 70, premiumMult: 2.6, premiumMinKg: 1.0, recordKg: 3.5 },\n  '–©—É–∫–∞':  { kgPrice: 18, premiumMult: 2.2, premiumMinKg: 3.0, recordKg: 9.0 },\n  '–ö–∞—Ä–ø':  { kgPrice: 12, premiumMult: 2.4, premiumMinKg: 2.5, recordKg: 8.0 },\n};\n\nfunction ruleFor(f) {\n  return PriceRules[f?.name] || PriceRules._default;\n}\n\nexport function isPremium(f) {\n  const r = ruleFor(f);\n  return (f.weightKg >= r.premiumMinKg);\n}\n\nexport function isRecord(f) {\n  const r = ruleFor(f);\n  return (f.weightKg >= r.recordKg);\n}\n\nexport function priceKg(f) {\n  const r = ruleFor(f);\n  return Math.round(f.weightKg * r.kgPrice);\n}\n\nexport function pricePremium(f) {\n  const r = ruleFor(f);\n  // —à—Ç—É—á–Ω–æ, –¥–æ—Ä–æ–∂–µ –∑–∞ –∫–≥\n  return Math.round(f.weightKg * r.kgPrice * r.premiumMult);\n}\n\n// –†–∞–∑–æ–±—Ä–∞—Ç—å —Å–∞–¥–æ–∫ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—ã\nexport function summarizeKeepnet(keepnet) {\n  const small = [];   // –º–µ–ª–æ—á—å -> –ø—Ä–æ–¥–∞—ë–º –æ–ø—Ç–æ–º ¬´–ø–æ –∫–≥¬ª\n  const prem  = [];   // —Ü–µ–Ω–Ω–∞—è -> —à—Ç—É—á–Ω–æ\n  const rec   = [];   // —Ä–µ–∫–æ—Ä–¥–Ω–∞—è -> –∑–æ–ª–æ—Ç–æ (WIP)\n\n  for (const f of keepnet) {\n    if (isRecord(f))      rec.push(f);\n    else if (isPremium(f)) prem.push(f);\n    else                  small.push(f);\n  }\n\n  const sumSmall = small.reduce((s,f)=>s+priceKg(f),0);\n  const sumPrem  = prem.reduce((s,f)=>s+pricePremium(f),0);\n  const cntRec   = rec.length;\n\n  return { small, prem, rec, sumSmall, sumPrem, cntRec };\n}\n","// src/ui/MarketModal.js\nimport { summarizeKeepnet } from '../data/pricing.js';\n\nexport class MarketModal {\n  constructor(scene, keepnet, wallet, onChange, onClose) {\n    this.scene = scene;\n    this.keepnet = keepnet;\n    this.wallet = wallet;\n    this.onChange = onChange;\n    this.onClose = onClose;\n    this.kill = [];\n    this.depthBase = 3100;\n\n    // —Ç–æ—Å—Ç\n    this.toast = (msg) => {\n      const t = this.scene.add.text(\n        Math.round(this.scene.scale.width / 2),\n        Math.round(this.scene.scale.height - 64),\n        msg,\n        { fontFamily: 'Arial, sans-serif', fontSize: '16px', color: '#ffffff' }\n      ).setOrigin(0.5).setDepth(this.depthBase + 10).setScrollFactor(0);\n      this.scene.tweens.add({ targets: t, y: t.y - 12, alpha: 0, delay: 600, duration: 1600, onComplete: () => t.destroy() });\n    };\n\n    const W = this.scene.scale.width, H = this.scene.scale.height;\n    const PAD = 18;\n\n    // overlay\n    const overlay = scene.add.rectangle(0, 0, W, H, 0x000000, 0.72)\n      .setOrigin(0, 0).setInteractive().setDepth(this.depthBase).setScrollFactor(0);\n    overlay.on('pointerdown', (_p,_x,_y,e)=>e?.stopPropagation());\n    overlay.on('wheel', (_p,_dx,_dy,_dz,e)=>e?.stopPropagation());\n    this.kill.push(overlay);\n\n    // panel\n    const panelW = Math.min(1060, W - 80);\n    const panelH = Math.min(620,  H - 80);\n    const cx = Math.round(W / 2), cy = Math.round(H / 2);\n\n    const shadow = scene.add.rectangle(cx + 2, cy + 3, panelW, panelH, 0x000000, 0.22)\n      .setDepth(this.depthBase + 1).setScrollFactor(0);\n    const panel = scene.add.rectangle(cx, cy, panelW, panelH, 0x1f2433, 1)\n      .setStrokeStyle(2, 0xffffff, 0.22)\n      .setDepth(this.depthBase + 1).setScrollFactor(0);\n    this.kill.push(shadow, panel);\n\n    // header\n    const titleTop = cy - panelH/2 + 16;\n    const title = scene.add.text(cx - panelW/2 + 20, titleTop, '–ü–†–û–î–ê–ñ–ê –†–´–ë–´', {\n      fontFamily:'Arial, sans-serif', fontSize:'28px', color:'#ffffff', fontStyle:'bold'\n    }).setOrigin(0,0).setDepth(this.depthBase+2);\n    const btnClose = scene.add.text(cx + panelW/2 - 14, titleTop - 8, '‚úï', {\n      fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n    }).setOrigin(1,0).setDepth(this.depthBase+2).setInteractive({useHandCursor:true});\n    btnClose.on('pointerdown', ()=> this.close());\n    this.kill.push(title, btnClose);\n\n    // –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç–∫–∞ (–æ–¥–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –≤—Å–µ—Ö)\n    const innerX = cx - panelW/2 + PAD;\n    const innerY = titleTop + 48;\n    const innerW = panelW - PAD*2;\n    const headerH = 36;\n    const gapCols = 16;\n\n    const colW = Math.floor((innerW - gapCols) / 2);\n    const leftX = innerX;\n    const rightX = innerX + colW + gapCols;\n\n    // –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ–∫—Ü–∏–π\n    const capL = this._sectionCaption(leftX,  innerY, colW, '–û–ø—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂–∏');\n    const capR = this._sectionCaption(rightX, innerY, colW, '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–∫–∞–∑—ã');\n    this.kill.push(capL.g, capL.t, capR.g, capR.t);\n\n    // —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏\n    const areaTop = innerY + headerH + 8;\n    const areaH = (cy + panelH/2 - PAD) - areaTop;\n\n    // —Ä–∞–º–∫–∏ –∫–æ–ª–æ–Ω–æ–∫\n    const leftFrame  = scene.add.rectangle(leftX,  areaTop, colW, areaH, 0x0f141d, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.12).setDepth(this.depthBase+1);\n    const rightFrame = scene.add.rectangle(rightX, areaTop, colW, areaH, 0x0f141d, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.12).setDepth(this.depthBase+1);\n    this.kill.push(leftFrame, rightFrame);\n\n    // –∫–æ–Ω—Ç–µ–Ω—Ç—ã –∫–æ–ª–æ–Ω–æ–∫ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã) ‚Äî –≤—Å—ë —Ä–∏—Å—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏—Ö (0,0)\n    this.leftRoot   = scene.add.container(leftX + 12, areaTop + 12).setDepth(this.depthBase+2);\n    this.ordersRoot = scene.add.container(rightX + 12, areaTop + 12).setDepth(this.depthBase+2);\n    this.summaryBar = this._buildSummaryBar(leftX, areaTop, colW, areaH);\n    this.kill.push(this.summaryBar.grp);\n    this.kill.push(this.leftRoot, this.ordersRoot);\n\n    // –ª–µ–≤–∞—è: —Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏\n    this.sellCards = [];\n    let y = 0;\n    this.sellCards.push(this._buildSellOption(this.leftRoot, { y, w: colW - 24, h: 120,\n      icon:'rare', title:'–†–µ–¥–∫–∞—è —Ä—ã–±–∞', subtitle:'–ü—Ä–æ–¥–∞—Ç—å —Ä–µ–¥–∫—É—é —Ä—ã–±—É –∑–∞ –∑–æ–ª–æ—Ç–æ',\n      countText: () => `–£ –≤–∞—Å: ${this._cache?.cntRec|0} —à—Ç`,\n      estText:   () => `–û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${this._cache?.cntRec|0} –∑–æ–ª–æ—Ç—ã—Ö`,\n      button: { label:'–°–∫–æ—Ä–æ', disabled:true, onClick:()=>this.soon() }\n    })); y += 120 + 12;\n\n    this.sellCards.push(this._buildSellOption(this.leftRoot, { y, w: colW - 24, h: 120,\n      icon:'big', title:'–ö—Ä—É–ø–Ω–∞—è —Ä—ã–±–∞', subtitle:'–ü—Ä–æ–¥–∞—Ç—å –≤—Å—é –∫—Ä—É–ø–Ω—É—é —Ä—ã–±—É (–î–æ—Ä–æ–≥–æ)',\n      countText: () => `–£ –≤–∞—Å: ${this._cache?.prem?.length|0} —à—Ç`,\n      estText:   () => `–û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${this._cache?.sumPrem|0} —Å–µ—Ä–µ–±—Ä–∞`,\n      button: { label:'–ü—Ä–æ–¥–∞—Ç—å', onClick:()=>this.sellPremium() }\n    })); y += 120 + 12;\n\n    this.sellCards.push(this._buildSellOption(this.leftRoot, { y, w: colW - 24, h: 120,\n      icon:'all', title:'–í—Å—è —Ä—ã–±–∞', subtitle:'–ü—Ä–æ–¥–∞—Ç—å –≤—Å—é —Ä—ã–±—É –æ–ø—Ç–æ–º (–î–µ—à–µ–≤–æ)',\n      countText: () => `–£ –≤–∞—Å: ${this.keepnet.length|0} —à—Ç`,\n      estText:   () => `–û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${(this._cache?.sumSmall|0)+(this._cache?.sumPrem|0)} —Å–µ—Ä–µ–±—Ä–∞`,\n      button: { label:'–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë', onClick:()=>this.sellAll() }\n    }));\n\n    // –ø—Ä–∞–≤–∞—è: —Å–µ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ 2xN\n    this.orders = [\n      { id:'bream',   name:'–õ–µ—â',   price:90,  tex:'fish_bream' },\n      { id:'catfish', name:'–°–æ–º',   price:200, tex:'fish_catfish' },\n      { id:'croaker', name:'–ì–æ—Ä–±—ã–ª—å —Å—É–¥–∞—á–∏–π', price:45,  tex:'fish_croaker' },\n      { id:'asp',     name:'–ñ–µ—Ä–µ—Ö', price:75,  tex:'fish_asp' },\n    ];\n    const gp = 12;\n    const cardW = Math.floor((colW - 24 - gp) / 2);\n    const cardH = 196;\n\n    let xi = 0, yi = 0;\n    for (const o of this.orders) {\n      const x = 0 + xi * (cardW + gp);\n      const y2 = 0 + yi * (cardH + gp);\n      this._buildOrderCard(this.ordersRoot, o, x, y2, cardW, cardH);\n      xi++; if (xi >= 2) { xi = 0; yi++; }\n    }\n\n    // –ø–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ\n    this.leftRoot.setAlpha(0);\n    this.ordersRoot.setAlpha(0);\n    scene.tweens.add({ targets:this.leftRoot,   alpha:1, duration:200, ease:'Sine.out' });\n    scene.tweens.add({ targets:this.ordersRoot, alpha:1, duration:200, ease:'Sine.out', delay:70 });\n\n    // –ø–æ–¥—Å—á—ë—Ç—ã\n    this.refresh();\n  }\n\n  // —Å–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (x,y ‚Äî –ª–µ–≤—ã–π –≤–µ—Ä—Ö)\n  _sectionCaption(x, y, w, text){\n    const g = this.scene.add.rectangle(x, y, w, 36, 0x0b1019, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.10).setDepth(this.depthBase+1);\n    const t = this.scene.add.text(x + w/2, y + 6, text, {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#e9f0ff', fontStyle:'bold'\n    }).setOrigin(0.5,0).setDepth(this.depthBase+2);\n    return { g, t };\n  }\n\n  // –∫–∞—Ä—Ç–æ—á–∫–∞ —Å–ª–µ–≤–∞ (root ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–ª–æ–Ω–∫–∏)\n  _buildSellOption(root, { y, w, h, icon, title, subtitle, countText, estText, button }) {\n    const D = this.depthBase + 2, s = this.scene;\n\n    const r = s.add.rectangle(0, y, w, h, 0x2a3144, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.16).setDepth(D).setInteractive();\n    r.on('pointerover', ()=> r.setFillStyle(0x33405a,1));\n    r.on('pointerout',  ()=> r.setFillStyle(0x2a3144,1));\n    root.add(r); this.kill.push(r);\n\n    const iconBox = s.add.rectangle(12, y + 12, 110, h - 24, 0x0f141d, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.10).setDepth(D+1);\n    root.add(iconBox); this.kill.push(iconBox);\n\n    const iconG = this._drawSellIcon(icon, iconBox.x + 55, iconBox.y + (h-24)/2, 34);\n    root.add(iconG); this.kill.push(iconG);\n\n    const textX = 12 + 110 + 12;\n    const titleT = s.add.text(textX, y + 14, title, {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n    }).setOrigin(0,0).setDepth(D+1);\n    const subT = s.add.text(textX, titleT.y + 22, subtitle, {\n      fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#cfd8dc'\n    }).setOrigin(0,0).setDepth(D+1);\n    const cntT = s.add.text(textX, subT.y + 20, '', {\n      fontFamily:'Arial, sans-serif', fontSize:'13px', color:'#a9b7d0'\n    }).setOrigin(0,0).setDepth(D+1);\n    const estT = s.add.text(textX, cntT.y + 18, '', {\n      fontFamily:'Arial, sans-serif', fontSize:'13px', color:'#a9b7d0'\n    }).setOrigin(0,0).setDepth(D+1);\n    root.add(titleT); root.add(subT); root.add(cntT); root.add(estT);\n    this.kill.push(titleT, subT, cntT, estT);\n\n    const bw = 140, bh = 36;\n    const bx = w - bw - 12, by = y + h - bh - 12;\n    const btn = s.add.rectangle(bx, by, bw, bh, button?.disabled ? 0x4b5568 : 0x2a9d8f, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.18).setDepth(D+1);\n    const btnT = s.add.text(bx + bw/2, by + bh/2, button?.label || '–ü—Ä–æ–¥–∞—Ç—å', {\n      fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#ffffff'\n    }).setOrigin(0.5).setDepth(D+2);\n    root.add(btn); root.add(btnT); this.kill.push(btn, btnT);\n\n    if (!button?.disabled) {\n      btn.setInteractive({ useHandCursor:true })\n        .on('pointerover', ()=> btn.setFillStyle(0x32b3a3,1))\n        .on('pointerout',  ()=> btn.setFillStyle(0x2a9d8f,1))\n        .on('pointerdown', button.onClick);\n    }\n\n    const update = () => {\n      cntT.setText(countText ? countText() : '');\n      estT.setText(estText ? estText() : '');\n    };\n    update();\n\n    return { update };\n  }\n\n  // –ø—Ä–æ—Å—Ç—ã–µ –∏–∫–æ–Ω–∫–∏\n  _drawSellIcon(kind, x, y, s = 32) {\n    const g = this.scene.add.graphics().setDepth(this.depthBase + 3);\n    g.lineStyle(2, 0xffffff, 1);\n\n    if (kind === 'rare') {\n      g.strokeCircle(x - s/3, y, s/4);\n      g.beginPath(); g.moveTo(x - s/6, y); g.lineTo(x + s/2, y); g.strokePath();\n      for (let i = -2; i <= 2; i++) {\n        g.beginPath();\n        g.moveTo(x + i * 6, y); g.lineTo(x + i * 6 - 6, y - 6);\n        g.moveTo(x + i * 6, y); g.lineTo(x + i * 6 - 6, y + 6);\n        g.strokePath();\n      }\n      g.fillStyle(0xffffff, 1).fillCircle(x + s/2 + 2, y, 2);\n    } else if (kind === 'big') {\n      g.strokeEllipse(x, y, s * 1.2, s * 0.7);\n      g.beginPath();\n      g.moveTo(x + s * 0.6, y);\n      g.lineTo(x + s * 0.9, y - s * 0.2);\n      g.lineTo(x + s * 0.9, y + s * 0.2);\n      g.closePath(); g.strokePath();\n      g.fillStyle(0xffffff, 1).fillCircle(x - s * 0.25, y - s * 0.08, 2);\n    } else { // all\n      for (let i = 0; i < 3; i++) {\n        const yy = y - s * 0.22 + i * s * 0.22;\n        g.strokeEllipse(x - s * 0.1, yy, s * 0.7, s * 0.38);\n        g.beginPath();\n        g.moveTo(x + s * 0.25, yy); g.lineTo(x + s * 0.45, yy - s * 0.12);\n        g.moveTo(x + s * 0.25, yy); g.lineTo(x + s * 0.45, yy + s * 0.12);\n        g.strokePath();\n      }\n    }\n    return g;\n  }\n\n  // –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞ (—Ä–∏—Å—É–µ–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ ordersRoot, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Äî –æ—Ç –µ–≥–æ (0,0))\n  _buildOrderCard(root, order, x, y, w, h) {\n    const D = this.depthBase + 2, s = this.scene;\n\n    const box = s.add.rectangle(x, y, w, h, 0x2a3144, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.16).setDepth(D).setInteractive({useHandCursor:true});\n    box.on('pointerover', ()=> box.setFillStyle(0x33405a,1));\n    box.on('pointerout',  ()=> box.setFillStyle(0x2a3144,1));\n    box.on('pointerdown', ()=> this.soon());\n    root.add(box); this.kill.push(box);\n\n    const imgH = h - 74;\n    const imgBox = s.add.rectangle(x + 8, y + 8, w - 16, imgH, 0x0f141d, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.10).setDepth(D+1);\n    root.add(imgBox); this.kill.push(imgBox);\n\n    if (order.tex && s.textures?.exists(order.tex)) {\n      const im = s.add.image(imgBox.x + imgBox.width/2, imgBox.y + imgBox.height/2, order.tex).setDepth(D+2);\n      const k = Math.min((imgBox.width - 16) / im.width, (imgBox.height - 16) / im.height);\n      im.setScale(k); root.add(im); this.kill.push(im);\n    } else {\n      const g = s.add.graphics().setDepth(D+2);\n      g.lineStyle(2, 0x6bd1ff, 0.9).beginPath();\n      const left = imgBox.x + 12;\n      const step = (imgBox.width - 24) / 5;\n      for (let i = 0; i <= 5; i++) {\n        const px = left + i * step;\n        const py = imgBox.y + imgBox.height/2 + (i % 2 ? -12 : 12);\n        if (i === 0) g.moveTo(px, py); else g.lineTo(px, py);\n      }\n      g.strokePath();\n      root.add(g); this.kill.push(g);\n    }\n\n    const name = s.add.text(x + w/2, imgBox.y + imgBox.height + 8, order.name, {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff',\n      align:'center', wordWrap:{ width:w - 16 }\n    }).setOrigin(0.5,0).setDepth(D+2);\n    root.add(name); this.kill.push(name);\n\n    const pillW = 96, pillH = 28;\n    const priceBox = s.add.rectangle(x + (w - pillW)/2, y + h - pillH - 10, pillW, pillH, 0x0f141d, 1)\n      .setOrigin(0,0).setStrokeStyle(2, 0xffffff, 0.12).setDepth(D+2);\n    const priceT = s.add.text(priceBox.x + pillW/2, priceBox.y + pillH/2, `${order.price|0} ü™ô`, {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#e9f0ff'\n    }).setOrigin(0.5).setDepth(D+3);\n    root.add(priceBox); root.add(priceT); this.kill.push(priceBox, priceT);\n  }\n\n  // –ª–æ–≥–∏–∫–∞\n  refresh() {\n    const { small, prem, rec, sumSmall, sumPrem, cntRec } = summarizeKeepnet(this.keepnet);\n    this._cache = { small, prem, rec, sumSmall, sumPrem, cntRec };\n    this.sellCards?.forEach(c => c?.update && c.update());\n    const cap = (this.scene.keepnetCap | 0) || 25;\n    this.summaryBar.set(this.wallet.coins | 0, `${this.keepnet.length | 0}/${cap}`, this.wallet.gold | 0);\n\n  }\n\n  sellSmall(){\n    const { small, sumSmall } = this._cache;\n    if (!small.length) return;\n    this.keepnet.splice(0, this.keepnet.length, ...this.keepnet.filter(f=>!small.includes(f)));\n    this.wallet.coins += sumSmall;\n    this.toast(`–ü—Ä–æ–¥–∞–Ω–æ –ø–æ –∫–≥: +${sumSmall} –º–æ–Ω.`);\n    this.onChange && this.onChange();\n    this.refresh();\n  }\n\n  sellPremium(){\n    const { prem, sumPrem } = this._cache;\n    if (!prem.length) return;\n    this.keepnet.splice(0, this.keepnet.length, ...this.keepnet.filter(f=>!prem.includes(f)));\n    this.wallet.coins += sumPrem;\n    this.toast(`–ü—Ä–æ–¥–∞–Ω–æ —Ü–µ–Ω–Ω–æ–µ: +${sumPrem} –º–æ–Ω.`);\n    this.onChange && this.onChange();\n    this.refresh();\n  }\n\n  sellAll(){\n    const { small, prem, sumSmall, sumPrem } = this._cache;\n    const total = [...small, ...prem];\n    if (!total.length) return;\n    this.keepnet.splice(0, this.keepnet.length, ...this.keepnet.filter(f=>!total.includes(f)));\n    const add = (sumSmall|0) + (sumPrem|0);\n    this.wallet.coins += add;\n    this.toast(`–ü—Ä–æ–¥–∞–Ω–æ –≤—Å—ë: +${add} –º–æ–Ω.`);\n    this.onChange && this.onChange();\n    this.refresh();\n  }\n\n  soon(){ this.toast('–°–∫–æ—Ä–æ: —Å–ø–µ—Ü-–∑–∞–∫–∞–∑—ã –∏ —Ä–µ–¥–∫–∞—è —Ä—ã–±–∞ –∑–∞ –∑–æ–ª–æ—Ç–æ'); }\n\n  close(){\n    this.kill.forEach(o => { try{o.destroy();}catch(e){} });\n    this.onClose && this.onClose();\n  }\n  // –ø–æ–ª–æ—Å–∫–∞ –≤–Ω–∏–∑—É –ª–µ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏\n_buildSummaryBar(leftX, areaTop, colW, areaH){\n  const s = this.scene, D = this.depthBase + 2;\n  const x = leftX + 12, y = areaTop + areaH - 60, w = colW - 24, h = 52;\n\n  const grp = s.add.container(x, y).setDepth(D);\n  const bg  = s.add.rectangle(0, 0, w, h, 0x1b2230, 1).setOrigin(0,0)\n                 .setStrokeStyle(2, 0xffffff, 0.12);\n  const gloss = s.add.rectangle(w/2, 6, w-10, 8, 0xffffff, 0.05).setOrigin(0.5,0);\n  grp.add([bg, gloss]);\n\n  const pad = 8, pillW = Math.floor((w - pad*4)/3), pillH = h - 16;\n\n  const pCoins = this._makePill(grp, pad,               8, pillW, pillH, 0x26324a, (g,x,y)=>this._iconCoin(g,x,y),  '0');\n  const pKeep  = this._makePill(grp, pad*2 + pillW,     8, pillW, pillH, 0x26324a, (g,x,y)=>this._iconKeep(g,x,y), '0/0');\n  const pGold  = this._makePill(grp, pad*3 + pillW*2,   8, pillW, pillH, 0x2a3348, (g,x,y)=>this._iconGold(g,x,y),  '0');\n\n  return {\n    grp,\n    set:(coins, keepStr, gold)=>{\n      pCoins.text.setText(String(coins));\n      pKeep.text.setText(keepStr);\n      pGold.text.setText(String(gold));\n    }\n  };\n}\n\n// —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø–∏–ª—é–ª—è\n_makePill(parent, x, y, w, h, color, drawIcon, initial='0'){\n  const s = this.scene, D = this.depthBase + 3;\n  const c = s.add.container(x, y).setDepth(D);\n  const bg = s.add.rectangle(0,0,w,h,color,1).setOrigin(0,0)\n      .setStrokeStyle(2, 0xffffff, 0.12);\n  const gloss = s.add.rectangle(w/2,4,w-10,6,0xffffff,0.06).setOrigin(0.5,0);\n  const ic = s.add.graphics({ x: 14, y: Math.floor(h/2) }); drawIcon(ic, 0, 0);\n  const text = s.add.text(30, Math.floor(h/2), initial, {\n    fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#eaf2ff'\n  }).setOrigin(0,0.5);\n  c.add([bg,gloss,ic,text]); parent.add(c);\n  this.kill.push(c,bg,gloss,ic,text);\n  return { c, text };\n}\n\n// –∏–∫–æ–Ω–∫–∏\n_iconCoin(g, x, y){ g.fillStyle(0xf6d463,1).fillCircle(x,y,8); g.fillStyle(0xffffff,0.6).fillCircle(x-3,y-3,2); g.lineStyle(2,0xffffff,0.18).strokeCircle(x,y,8); }\n_iconGold(g, x, y){\n  const R1=8, R2=3.6; const pts=[];\n  for(let i=0;i<10;i++){ const a=-Math.PI/2 + i*Math.PI/5, r=(i%2?R2:R1); pts.push({x:x+Math.cos(a)*r,y:y+Math.sin(a)*r});}\n  g.fillStyle(0xffe47a,1).fillPoints(pts,true); g.lineStyle(2,0xffffff,0.18).strokePoints(pts,true);\n}\n_iconKeep(g, x, y){ // –º–∞–ª–µ–Ω—å–∫–∞—è ¬´—Ä—ã–±–∫–∞¬ª\n  g.lineStyle(2,0xb9d7ff,1); g.strokeEllipse(x-2,y,14,8);\n  g.beginPath(); g.moveTo(x+5,y); g.lineTo(x+11,y-4); g.moveTo(x+5,y); g.lineTo(x+11,y+4); g.strokePath();\n  g.fillStyle(0xffffff,1).fillCircle(x-7,y-1.2,1.2);\n}\n\n}\n\nexport default MarketModal;\n","// src/ui/ShopModal.js\nimport UI from '../ui/theme.js';\nimport { ShopCatalog, ensureCatalogInGearDB } from '../data/shopCatalog.js';\nimport { GearDB } from '../data/gear.js';\nimport { onItemBought, onInventoryChange, onWalletChange } from '../quests/QuestHooks.js';\n\n\nexport default class ShopModal {\n  /**\n   * @param {Phaser.Scene} scene\n   * @param {{coins:number,gold:number}} wallet\n   * @param {{rods:string[],reels:string[],lines:string[],hooks:string[],bait:Object, hookPacks?:Object}} inventory\n   * @param {number} level\n   * @param {Function=} onChange\n   * @param {Function=} onClose\n   */\n  constructor(scene, wallet, inventory, level = 1, onChange, onClose) {\n    this.s = scene;\n    this.wallet = wallet;\n    this.inventory = inventory;\n    this.level = level | 0;\n    this.onChange = onChange;\n    this.onClose = onClose;\n\n    ensureCatalogInGearDB(GearDB);\n\n    this.kill = [];\n    this.depthBase = UI?.z?.modal ? UI.z.modal + 50 : 3100;\n\n    const W = this.s.scale.width, H = this.s.scale.height;\n    const panelW = Math.min(1060, W - 80);\n    const panelH = Math.min(620,  H - 80);\n    const cx = Math.round(W / 2), cy = Math.round(H / 2);\n\n\n    // ===== overlay\n    const overlay = this.s.add\n      .rectangle(0, 0, W, H, 0x000000, 0.72)\n      .setOrigin(0, 0)\n      .setDepth(this.depthBase)\n      .setScrollFactor(0)\n      .setInteractive();\n    overlay.on('pointerdown', (_p,_x,_y,e)=>e?.stopPropagation());\n    overlay.on('wheel', (_p,_o,_dx,_dy,_dz,e)=>e?.stopPropagation());\n    this.kill.push(overlay);\n\n    // ===== panel\n    const shadow = this.s.add.rectangle(cx + 2, cy + 3, panelW, panelH, 0x000000, 0.22)\n      .setDepth(this.depthBase + 1).setScrollFactor(0);\n    const panel = this.s.add.rectangle(cx, cy, panelW, panelH, 0x151a24, 1)\n      .setStrokeStyle(2, 0xffffff, 0.22)\n      .setDepth(this.depthBase + 1).setScrollFactor(0);\n    this.kill.push(shadow, panel);\n\n    // ===== header\n    const titleY = cy - panelH/2 + 16;\n    const title = this.s.add.text(cx - panelW/2 + 20, titleY, '–ú–ê–ì–ê–ó–ò–ù', {\n      fontFamily:'Arial, sans-serif', fontSize:'28px', color:'#ffffff', fontStyle:'bold'\n    }).setOrigin(0,0).setDepth(this.depthBase+2);\n\n    const btnClose = this.s.add.text(cx + panelW/2 - 14, titleY - 8, '‚úï', {\n      fontFamily:'Arial, sans-serif', fontSize:'22px', color:'#ffffff'\n    }).setOrigin(1,0).setDepth(this.depthBase+2).setInteractive({useHandCursor:true});\n    btnClose.on('pointerdown', ()=> this.close());\n    this.kill.push(title, btnClose);\n\n    // –ª–µ–≤—ã–π –≤–µ—Ä—Ö ‚Äî —É—Ä–æ–≤–µ–Ω—å\n    const lvlTxt = this.s.add.text(cx - panelW/2 + 20, titleY + 34, `–£—Ä–æ–≤–µ–Ω—å: ${this.level}`, {\n      fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#8ea6c9'\n    }).setOrigin(0,0).setDepth(this.depthBase+2);\n    this.kill.push(lvlTxt);\n\n    // –ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö ‚Äî –∫–æ—à–µ–ª—ë–∫\n    this._walletText = this.s.add.text(cx + panelW/2 - 20, titleY + 34,\n      `ü™ô ${this.wallet.coins|0}   ‚òÖ ${this.wallet.gold|0}`,\n      { fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#cfd8ff' }\n    ).setOrigin(1,0).setDepth(this.depthBase+2);\n    this.kill.push(this._walletText);\n\n    // ===== —Ä–∞–∑–º–µ—Ç–∫–∞: –ª–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π / –ø—Ä–∞–≤–∞—è –∑–æ–Ω–∞ –∫–∞—Ä—Ç–æ—á–µ–∫\n    const PAD = 18;\n    const leftW = 260;\n    const topY = titleY + 70;\n    const innerH = panelH - (topY - (cy - panelH/2)) - PAD;\n\n    // –ª–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä + —Ä–∞–º–∫–∞\n    const leftX = Math.round(cx - panelW/2 + PAD + leftW/2);\n    const leftFrame = this.s.add.rectangle(leftX, Math.round(topY + innerH/2),\n      leftW, innerH, 0x0f141d, 1)\n      .setStrokeStyle(2, 0xffffff, 0.12)\n      .setDepth(this.depthBase+1);\n    this.kill.push(leftFrame);\n\n    // –ø—Ä–∞–≤–∞—è –æ–±–ª–∞—Å—Ç—å (–ª–∏—Å—Ç —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏)\n    const rightW = panelW - leftW - PAD*3;\n    const rightX = Math.round(leftX + leftW/2 + PAD + rightW/2);\n    const rightFrame = this.s.add.rectangle(rightX, Math.round(topY + innerH/2),\n      rightW, innerH, 0x0f141d, 1)\n      .setStrokeStyle(2, 0xffffff, 0.12)\n      .setDepth(this.depthBase+1);\n    this.kill.push(rightFrame);\n\n    // ===== –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ª–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞) ‚Äî —Å–∫—Ä–æ–ª–ª\n    this._catViewport = { x:leftX, y:Math.round(topY + innerH/2), w:leftW, h:innerH };\n    // –ì–ª–æ–±–∞–ª—å–Ω—ã–π wheel: —Ä–µ—à–∞–µ–º –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º, —á—Ç–æ –∫—Ä—É—Ç–∏—Ç—å\nthis._onWheel = (pointer, over, dx, dy, dz, event) => {\n  if (!this._catViewport || !this._listViewport) return;\n  const px = pointer.x, py = pointer.y;\n  if (this._ptIn(px, py, this._catViewport)) { event?.stopPropagation(); this._scrollCats(dy); return; }\n  if (this._ptIn(px, py, this._listViewport)) { event?.stopPropagation(); this._scrollList(dy); return; }\n};\nthis.s.input.on('wheel', this._onWheel);\n\n\n    this.catRoot = this.s.add.container(0,0).setDepth(this.depthBase+2);\n    this.kill.push(this.catRoot);\n\n    const catMaskG = this.s.make.graphics({ x:0, y:0, add:false });\n    catMaskG.fillStyle(0xffffff).fillRect(\n      Math.round(this._catViewport.x - this._catViewport.w/2),\n      Math.round(this._catViewport.y - this._catViewport.h/2),\n      this._catViewport.w, this._catViewport.h\n    );\n    const catMask = catMaskG.createGeometryMask();\n    this.catRoot.setMask(catMask);\n    this.kill.push(catMaskG);\n\n    // –∫–æ–ª–µ—Å–æ –º—ã—à–∏ –≤–Ω—É—Ç—Ä–∏ –ª–µ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏\n    // const catHit = this.s.add.rectangle(this._catViewport.x, this._catViewport.y,\n    //   this._catViewport.w, this._catViewport.h, 0x000000, 0)\n    //   .setDepth(this.depthBase+3).setInteractive();\n    // catHit.on('wheel', (_p,_o,dx,dy,_dz)=> this._scrollCats(dy));\n\n// // –ì–ª–æ–±–∞–ª—å–Ω—ã–π wheel: —Ä–µ—à–∞–µ–º –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º, —á—Ç–æ –∫—Ä—É—Ç–∏—Ç—å\nthis._onWheel = (pointer, over, dx, dy, dz, event) => {\n  const px = pointer.x, py = pointer.y;\n  if (this._ptIn(px, py, this._catViewport)) { event?.stopPropagation(); this._scrollCats(dy); return; }\n  if (this._ptIn(px, py, this._listViewport)) { event?.stopPropagation(); this._scrollList(dy); return; }\n};\nthis.s.input.on('wheel', this._onWheel);\n\n\n    // ===== –ø—Ä–∞–≤–∞—è –∑–æ–Ω–∞ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ ‚Äî —Å–∫—Ä–æ–ª–ª\n    this._listViewport = { x:rightX, y:Math.round(topY + innerH/2), w:rightW, h:innerH };\n    // –ì–ª–æ–±–∞–ª—å–Ω—ã–π wheel: —Ä–µ—à–∞–µ–º –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º, —á—Ç–æ –∫—Ä—É—Ç–∏—Ç—å\nthis._onWheel = (pointer, over, dx, dy, dz, event) => {\n  if (!this._catViewport || !this._listViewport) return;\n  const px = pointer.x, py = pointer.y;\n  if (this._ptIn(px, py, this._catViewport)) { event?.stopPropagation(); this._scrollCats(dy); return; }\n  if (this._ptIn(px, py, this._listViewport)) { event?.stopPropagation(); this._scrollList(dy); return; }\n};\nthis.s.input.on('wheel', this._onWheel);\n\n    this.cardsRoot = this.s.add.container(0,0).setDepth(this.depthBase+2);\n    const listMaskG = this.s.make.graphics({x:0, y:0, add:false});\n    listMaskG.fillStyle(0xffffff).fillRect(\n      Math.round(this._listViewport.x - this._listViewport.w/2),\n      Math.round(this._listViewport.y - this._listViewport.h/2),\n      this._listViewport.w, this._listViewport.h\n    );\n    const listMask = listMaskG.createGeometryMask();\n    this.cardsRoot.setMask(listMask);\n    this.kill.push(this.cardsRoot, listMaskG);\n\n    // const listHit = this.s.add.rectangle(this._listViewport.x, this._listViewport.y,\n    // this._listViewport.w, this._listViewport.h, 0x000000, 0)\n    // .setDepth(this.depthBase+1).setInteractive(); // –Ω–∏–∂–µ –∫–∞—Ä—Ç–æ—á–µ–∫\n    // listHit.on('wheel', (_p,_o,dx,dy,_dz)=> this._scrollList(dy));\n\n\n    // ===== –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π\n    this._labelMap = {\n      sets:'–°–µ—Ç—ã',\n      rods:'–£–¥–æ—á–∫–∏',\n      reels:'–ö–∞—Ç—É—à–∫–∏',\n      lines:'–õ–µ—Å–∫–∞',\n      hooks:'–ö—Ä—é—á–∫–∏',\n      bait:'–ù–∞–∂–∏–≤–∫–∞',\n      accessories:'–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã',\n      ex_rods:'–≠–∫—Å–∫–ª—é–∑–∏–≤. —É–¥–∏–ª–∏—â–∞',\n      ex_reels:'–≠–∫—Å–∫–ª—é–∑–∏–≤. –∫–∞—Ç—É—à–∫–∏'\n    };\n\n    const defaultOrder = ['rods','reels','lines','hooks','bait','accessories','sets','ex_rods','ex_reels'];\n    const available = Object.keys(ShopCatalog.items || {});\n    this.categories = (ShopCatalog.categories && ShopCatalog.categories.length)\n      ? ShopCatalog.categories\n      : defaultOrder.filter(k => available.includes(k));\n    if (this.categories.length === 0) this.categories = ['rods']; // safety\n\n    this.activeTab = this.categories[0];\n    this._buildCategories();     // —Å–ª–µ–≤–∞\n    this._renderList(true);      // —Å–ø—Ä–∞–≤–∞\n\n    // ESC\n    this.s.input.keyboard?.once('keydown-ESC', () => this.close());\n  }\n\n  // ============ –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê –ö–ê–¢–ï–ì–û–†–ò–ô ============\n  _buildCategories(){\n    this.catRoot.removeAll(true);\n    const { x, y, w, h } = this._catViewport;\n\n    const GAP = 10, BTN_H = 58, PADX = 12;\n    let cy = Math.round(y - h/2) + 8 + BTN_H/2;\n\n    this._catBtns = [];\n\n    for (const cat of this.categories) {\n      const r = this.s.add.rectangle(x, cy, w - 14, BTN_H, 0x1b2230, 1)\n        .setStrokeStyle(2, 0xffffff, 0.12)\n        .setDepth(this.depthBase+2)\n        .setInteractive({useHandCursor:true})\n        .on('pointerover', ()=>r.setFillStyle(0x222b3e,1))\n        .on('pointerout',  ()=>r.setFillStyle((cat===this.activeTab)?0x24324b:0x1b2230,1))\n        .on('pointerdown', ()=> this._switchTab(cat));\n      this.catRoot.add(r);\n\n      // –∏–∫–æ–Ω–∫–∞ —Å–ª–µ–≤–∞\n      const icon = this._drawCatIcon(cat, x - (w-14)/2 + PADX + 16, cy);\n      this.catRoot.add(icon);\n\n\n      // –ø–æ–¥–ø–∏—Å—å\n      const t = this.s.add.text(x - (w-14)/2 + PADX + 36, cy,\n        this._labelMap[cat] || cat, {\n          fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#e9f0ff'\n        }).setOrigin(0,0.5).setDepth(this.depthBase+3);\n      this.catRoot.add(t);\n\n      this._catBtns.push({ r, t, cat });\n      cy += BTN_H + GAP;\n    }\n\n    this._updateCatVisual();\n    this._catsMinY = this.catRoot.first?.y || 0;\n    this._catsMaxY = Math.max(this._catsMinY, Math.round(y + h/2) - 12);\n  }\n//—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥\n _ptIn(x, y, r) {\n  return x >= r.x - r.w/2 && x <= r.x + r.w/2 &&\n         y >= r.y - r.h/2 && y <= r.y + r.h/2;\n}\n  _drawCatIcon(cat, cx, cy){\n    const g = this.s.add.graphics().setDepth(this.depthBase+3);\n    g.lineStyle(2, 0xb5c2d9, 1);\n    g.fillStyle(0xb5c2d9, 1);\n\n    switch(cat){\n      case 'rods': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.beginPath();\n        g.moveTo(cx-14, cy+10); g.lineTo(cx+14, cy-10);\n        g.strokePath();\n        g.fillCircle(cx+10, cy-8, 2);\n        break;\n      }\n      case 'reels': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.strokeCircle(cx, cy, 10);\n        g.beginPath(); g.moveTo(cx+10, cy); g.lineTo(cx+16, cy); g.strokePath();\n        break;\n      }\n      case 'lines': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.strokeRect(cx-10, cy-10, 20, 20);\n        g.beginPath();\n        g.moveTo(cx-6, cy-6); g.lineTo(cx+6, cy+6);\n        g.moveTo(cx+6, cy-6); g.lineTo(cx-6, cy+6);\n        g.strokePath();\n        break;\n      }\n      case 'hooks': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.beginPath();\n        g.moveTo(cx-6, cy-12);\n        g.lineTo(cx-6, cy+6);\n        g.arc(cx, cy+6, 6, Math.PI, Math.PI*1.8, false);\n        g.strokePath();\n        break;\n      }\n      case 'bait': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.strokeCircle(cx-4, cy, 5);\n        g.strokeCircle(cx+6, cy-2, 4);\n        break;\n      }\n      case 'accessories': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.strokeRoundedRect(cx-12, cy-10, 24, 20, 4);\n        g.beginPath(); g.moveTo(cx, cy-6); g.lineTo(cx, cy+6); g.moveTo(cx-6, cy); g.lineTo(cx+6, cy); g.strokePath();\n        break;\n      }\n      case 'sets': {\n        g.lineStyle(2, 0x9ec9ff, 1);\n        g.strokeRoundedRect(cx-12, cy-10, 24, 20, 3);\n        g.beginPath(); g.moveTo(cx-12, cy-3); g.lineTo(cx+12, cy-3); g.strokePath();\n        break;\n      }\n      default: {\n        g.strokeCircle(cx, cy, 8);\n      }\n    }\n    return g;\n  }\n\n  _switchTab(cat){\n    if (this.activeTab === cat) return;\n    this.activeTab = cat;\n    this._updateCatVisual();\n    this._renderList(true);\n  }\n\n  _updateCatVisual(){\n    this._catBtns?.forEach(({r, t, cat})=>{\n      const active = (cat === this.activeTab);\n      r.setFillStyle(active?0x24324b:0x1b2230,1);\n      r.setStrokeStyle(2, 0x6bd1ff, active?0.6:0.12);\n      t.setColor(active?'#ffffff':'#c9d3e7');\n      t.setFontStyle(active?'bold':'normal');\n    });\n  }\n\n  _scrollCats(deltaY){\n    if (!this._catBtns?.length) return;\n    const step = Phaser.Math.Clamp(deltaY, -60, 60);\n    // –≤—ã—á–∏—Å–ª–∏–º –ø—Ä–µ–¥–µ–ª—ã\n    const first = this._catBtns[0].r;\n    const last  = this._catBtns[this._catBtns.length-1].r;\n    const minY = Math.round(this._catViewport.y - this._catViewport.h/2 + 8 + first.height/2);\n    const maxY = Math.round(this._catViewport.y + this._catViewport.h/2 - 8 - last.height/2);\n\n    // —Å–¥–≤–∏–≥–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã\n    this.catRoot.iterate(obj => { if (obj.y != null) obj.y -= step; });\n\n    // clamp\n    const curFirstY = first.y;\n    const curLastY  = last.y;\n    let corr = 0;\n    if (curFirstY > minY) corr = curFirstY - minY;\n    if (curLastY < maxY)  corr = curLastY - maxY;\n    if (corr) this.catRoot.iterate(obj => { if (obj.y != null) obj.y -= corr; });\n  }\n\n  // ============ –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨ ‚Äî –°–ü–ò–°–û–ö –ö–ê–†–¢–û–ß–ï–ö ============\n  _getItemsForActiveTab() {\n    const list = ShopCatalog.items?.[this.activeTab] || [];\n    let res = [...list];\n    // —Ñ–∏–ª—å—Ç—Ä ¬´–¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —É—Ä–æ–≤–Ω—é —Å–≤–µ—Ä—Ö—É¬ª\n    res.sort((a,b)=>\n      (a.level|0)-(b.level|0) || (a.price|0)-(b.price|0) || String(a.id).localeCompare(String(b.id))\n    );\n    return res;\n  }\n\n  _renderList(withFade=false){\n    this.cardsRoot.removeAll(true);\n\n    const items = this._getItemsForActiveTab();\n    const PAD = 14, cols = 4;\n    const colW = Math.floor((this._listViewport.w - PAD*(cols-1) - 24) / cols);\n    const cardW = Math.min(240, colW);\n    const cardH = 214;\n\n    let xi = 0;\n    let y = Math.round(this._listViewport.y - this._listViewport.h/2) + 12 + cardH/2;\n\n    const x0 = Math.round(this._listViewport.x - this._listViewport.w/2) + 12 + Math.floor((colW - cardW)/2);\n\n    for (const it of items) {\n      const x = x0 + xi * (colW) + cardW/2;\n      const objs = this._makeCard(it, x, y, cardW, cardH);\n      this.cardsRoot.add(objs);\n\n      xi++;\n      if (xi >= cols){ xi = 0; y += cardH + PAD; }\n    }\n\n    // –∑–∞–ø–æ–º–Ω–∏–º –≥—Ä–∞–Ω–∏—Ü—ã –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞\n    this._listMinY = Math.round(this._listViewport.y - this._listViewport.h/2) + 8 + cardH/2;\n    this._listMaxY = Math.max(this._listMinY, y);\n\n    if (withFade){\n      this.cardsRoot.setAlpha(0);\n      this.s.tweens.add({ targets: this.cardsRoot, alpha:1, duration:180, ease:'Sine.inOut' });\n    }\n  }\n\n  _makeCard(it, x, y, w, h){\n    const D = this.depthBase+3;\n    const objs = [];\n\n    // —Ñ–æ–Ω\n    const rect = this.s.add.rectangle(x, y, w, h, 0x1b2230, 1)\n      .setStrokeStyle(2, 0xffffff, 0.14).setDepth(D).setInteractive();\n    rect.on('pointerover', ()=>rect.setFillStyle(0x212a3e,1));\n    rect.on('pointerout',  ()=>rect.setFillStyle(0x1b2230,1));\n    objs.push(rect);\n\n    // –º–∏–Ω–∏-–∫–∞—Ä—Ç–∏–Ω–∫–∞ (–ø–ª–∞—à–∫–∞ —Å–≤–µ—Ä—Ö—É)\n    const imgH = 90;\n    const imgRect = this.s.add.rectangle(x, Math.round(y - h/2 + imgH/2 + 8), w-16, imgH, 0x0f141d, 1)\n      .setStrokeStyle(2, 0xffffff, 0.08).setDepth(D+1);\n    objs.push(imgRect);\n\n    // –ø—Ä–æ—Å—Ç–∞—è ¬´–∑–∞–≥–ª—É—à–∫–∞-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ¬ª\n    const g = this.s.add.graphics().setDepth(D+2);\n    g.lineStyle(2, 0x6bd1ff, 0.9);\n    g.beginPath();\n    g.moveTo(imgRect.x - (w-16)/2 + 10, imgRect.y + 20);\n    g.lineTo(imgRect.x - (w-16)/2 + 40, imgRect.y - 10);\n    g.lineTo(imgRect.x - (w-16)/2 + 70, imgRect.y + 10);\n    g.lineTo(imgRect.x - (w-16)/2 + 100, imgRect.y - 6);\n    g.strokePath();\n    objs.push(g);\n\n    // –∏–º—è\n    const name = this.s.add.text(x, imgRect.y + imgRect.height/2 + 6,\n      it.name || it.id, {\n        fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#ffffff',\n        align:'center', wordWrap:{ width:w-18 }\n      }).setOrigin(0.5,0).setDepth(D+2);\n    objs.push(name);\n\n    // –æ–ø–∏—Å–∞–Ω–∏–µ/—Å—Ç–∞—Ç—ã\n    const stats = this.s.add.text(x, name.y + name.height + 2, this._statsText(it), {\n      fontFamily:'Arial, sans-serif', fontSize:'12px', color:'#a9b7d0',\n      align:'center', wordWrap:{ width:w-18 }\n    }).setOrigin(0.5,0).setDepth(D+2);\n    objs.push(stats);\n\n    // —Ç—Ä–µ–±—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å\n    const req = this.s.add.text(x - w/2 + 10, y + h/2 - 44,\n      `–¢—Ä–µ–±. —É—Ä.: ${it.level ?? 1}`, {\n        fontFamily:'Arial, sans-serif', fontSize:'12px', color:'#8ea6c9'\n      }).setOrigin(0,1).setDepth(D+2);\n    objs.push(req);\n\n    // –±–µ–π–¥–∂ ¬´–£–∂–µ –µ—Å—Ç—å¬ª\n    if (!it.contains && this.activeTab !== 'bait' && this._owns(this.activeTab, it.id)) {\n      const own = this.s.add.text(x + w/2 - 10, y - h/2 + 10, '–£–∂–µ –µ—Å—Ç—å', {\n        fontFamily:'Arial, sans-serif', fontSize:'12px', color:'#a7ffeb'\n      }).setOrigin(1,0).setDepth(D+4);\n      objs.push(own);\n    }\n\n    // –∫–Ω–æ–ø–∫–∞ –∫—É–ø–∏—Ç—å (–ø–∏–ª—é–ª—è)\n    const bw = Math.min(160, w-18), bh = 32;\n    const buy = this.s.add.rectangle(x, y + h/2 - 16, bw, bh, 0x2a9d8f, 1)\n      .setStrokeStyle(2, 0xffffff, 0.18).setDepth(D+2);\n    const priceStr = `${it.price|0}ü™ô`;\n    const buyLbl = this.s.add.text(x, buy.y, `–ö—É–ø–∏—Ç—å ‚Ä¢ ${priceStr}`, {\n      fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#ffffff'\n    }).setOrigin(0.5).setDepth(D+3);\n    objs.push(buy, buyLbl);\n\n    const { canBuy, reason } = this._canBuy(it);\n    if (canBuy){\n      buy.setInteractive({useHandCursor:true})\n        .on('pointerover', ()=>buy.setFillStyle(0x32b3a3,1))\n        .on('pointerout',  ()=>buy.setFillStyle(0x2a9d8f,1))\n        .on('pointerdown', ()=> this._attemptBuy(it));\n    } else {\n      buy.setFillStyle(0x4b5568,1).disableInteractive();\n      buyLbl.setColor('#c7c7c7');\n      buyLbl.setText(reason || '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ');\n    }\n\n    // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ (–∫–æ–ª-–≤–æ –Ω–∞–∂–∏–≤–∫–∏/–∫—Ä—é—á–∫–æ–≤)\n    if (!it.contains){\n      let ownedNote = '';\n      if (this.activeTab === 'bait'){\n        const n = (this.inventory.bait?.[it.id] | 0);\n        ownedNote = n ? `–í –Ω–∞–ª–∏—á–∏–∏: ${n} —à—Ç.` : '';\n      } else if (this.activeTab === 'hooks'){\n        const n = (this.inventory.hookPacks?.[it.id] | 0);\n        ownedNote = n ? `–ö—Ä—é—á–∫–æ–≤: ${n} —à—Ç.` : '';\n      }\n      if (ownedNote){\n        const note = this.s.add.text(x, stats.y + stats.height + 2, ownedNote, {\n          fontFamily:'Arial, sans-serif', fontSize:'12px', color:'#a7ffeb'\n        }).setOrigin(0.5,0).setDepth(D+2);\n        objs.push(note);\n      }\n    }\n\n    return objs;\n  }\n\n  _scrollList(deltaY){\n    if (!this.cardsRoot.list?.length) return;\n    const step = Phaser.Math.Clamp(deltaY, -80, 80);\n    this.cardsRoot.iterate(obj => { if (obj.y != null) obj.y -= step; });\n\n    // clamp –ø–æ –ø–µ—Ä–≤–æ–π/–ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ\n    const objs = this.cardsRoot.list.filter(o => o?.type === 'Rectangle'); // —Ñ–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫\n    if (!objs.length) return;\n    const first = objs[0], last = objs[objs.length-1];\n\n    const minY = Math.round(this._listViewport.y - this._listViewport.h/2 + 12 + first.height/2);\n    const maxY = Math.round(this._listViewport.y + this._listViewport.h/2 - 12 - first.height/2);\n\n    const curFirstY = first.y;\n    const curLastY  = last.y;\n    let corr = 0;\n    if (curFirstY > minY) corr = curFirstY - minY;\n    if (curLastY < maxY)  corr = curLastY - maxY;\n    if (corr) this.cardsRoot.iterate(obj => { if (obj.y != null) obj.y -= corr; });\n  }\n\n  // ‚Äî‚Äî‚Äî helpers ‚Äî‚Äî‚Äî\n  _owns(kindPlural, id) {\n    if (kindPlural === 'bait') return false;\n    const arr = this.inventory[kindPlural] || [];\n    return Array.isArray(arr) && arr.includes(id);\n  }\n\n  _statsText(it) {\n    if (it.contains) {\n      const compact = it.contains.map(c => {\n        if (c.kind === 'bait') return '–Ω–∞–∂–∏–≤–∫–∞ √ó' + (c.qty || 0);\n        const map = { rods:'—É–¥–æ—á–∫–∞', reels:'–∫–∞—Ç—É—à–∫–∞', lines:'–ª–µ—Å–∫–∞', hooks:'–∫—Ä—é—á–æ–∫' };\n        return map[c.kind] || c.kind;\n      });\n      return compact.join(' ‚Ä¢ ');\n    }\n    if ('capKg' in it)     return `–ü—Ä–æ—á–Ω–æ—Å—Ç—å: ${(+it.capKg).toFixed(2)} –∫–≥`;\n    if ('pullBoost' in it) return `–¢—è–≥–∞: √ó${(+it.pullBoost).toFixed(2)}`;\n    if ('control' in it)   return `–ö–æ–Ω—Ç—Ä–æ–ª—å: √ó${(+it.control).toFixed(2)}`;\n    if ('pack' in it)      return `–ü–∞—á–∫–∞: ${it.pack|0} —à—Ç.`;\n    if ('keepnetCap' in it)return `–°–∞–¥–æ–∫: ${it.keepnetCap|0} –º–µ—Å—Ç`;\n    return '';\n  }\n\n  _canBuy(it) {\n    if (this.level < (it.level ?? 1)) return { canBuy:false, reason:'üîí –£—Ä–æ–≤–µ–Ω—å' };\n    if ((this.wallet.coins|0) < (it.price|0)) return { canBuy:false, reason:'–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç' };\n\n    if (!it.contains && this.activeTab !== 'bait' && this.activeTab !== 'accessories') {\n      if (this._owns(this.activeTab, it.id)) return { canBuy:false, reason:'–£–∂–µ –µ—Å—Ç—å' };\n    }\n    if (it.contains) {\n      const everythingOwned = it.contains.every(c=>{\n        if (c.kind === 'bait') return false;\n        const arr = this.inventory[c.kind] || [];\n        return arr.includes(c.id);\n      });\n      if (everythingOwned) return { canBuy:false, reason:'–ö–æ–º–ø–ª–µ–∫—Ç —É–∂–µ –µ—Å—Ç—å' };\n    }\n    return { canBuy:true, reason:'' };\n  }\n\n  _attemptBuy(it) {\n    const { canBuy, reason } = this._canBuy(it);\n    if (!canBuy) { this._toast(reason || '–ü–æ–∫—É–ø–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞'); return; }\n\n    // —Å–ø–∏—Å—ã–≤–∞–µ–º –º–æ–Ω–µ—Ç—ã\n    this.wallet.coins = (this.wallet.coins|0) - (it.price|0);\n    //QUEST HOOKS:\n    onWalletChange(this.wallet);\n\n    // –≤—ã–¥–∞—á–∞\n    if (it.contains) {\n      for (const c of it.contains) this._grantItem(c.kind, c.id, c.qty || 0);\n    } else {\n      const kind = this.activeTab;\n      const qty = (kind === 'bait') ? (it.pack || 0) : 0;\n      this._grantItem(kind, it.id, qty, it);\n    }\n\n    // QUEST HOOKS: –ø–æ–∫—É–ø–∫–∞ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å\n   onItemBought({ itemId: it.id, kind: this.activeTab });\n   if (it.contains) {\n     // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å—á–∏—Ç–∞–µ–º –ø–æ–∫—É–ø–∫—É –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ\n     for (const c of it.contains) onItemBought({ itemId: c.id, kind: c.kind });\n   }\n   onInventoryChange(this.inventory);\n\n    // –∞–ø–¥–µ–π—Ç\n    this._walletText?.setText(`ü™ô ${this.wallet.coins|0}   ‚òÖ ${this.wallet.gold|0}`);\n    this._renderList();\n    this.onChange && this.onChange();\n    this._toast('–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞');\n  }\n\n  _grantItem(kind, id, qty = 0, itemObj = null) {\n    if (kind === 'bait') {\n      const bag = this.inventory.bait || (this.inventory.bait = {});\n      bag[id] = (bag[id] | 0) + (qty | 0);\n      return;\n    }\n    if (kind === 'hooks') {\n      const pack = qty || (itemObj?.pack|0) || 5;\n      const stacks = this.inventory.hookPacks || (this.inventory.hookPacks = {});\n      stacks[id] = (stacks[id] | 0) + pack;\n      const arr = this.inventory.hooks || (this.inventory.hooks = []);\n      if (!arr.includes(id)) arr.push(id);\n      return;\n    }\n    if (kind === 'accessories') {\n      // –∞–ø–≥—Ä–µ–π–¥—ã: —Å–µ–π—á–∞—Å ‚Äî —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–∞–¥–∫–∞\n      if (itemObj && itemObj.keepnetCap){\n        if (typeof this.s.keepnetCap === 'number') this.s.keepnetCap = itemObj.keepnetCap|0;\n        // —Å–æ—Ö—Ä–∞–Ω–∏–º –º–∞—Ä–∫–µ—Ä –∞–ø–≥—Ä–µ–π–¥–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å\n        const up = (this.inventory.upgrades ||= {});\n        up.keepnetCap = itemObj.keepnetCap|0;\n      }\n      return;\n    }\n    // rods / reels / lines ‚Äî –ø–æ—à—Ç—É—á–Ω–æ\n    const arr = this.inventory[kind] || (this.inventory[kind] = []);\n    if (!arr.includes(id)) arr.push(id);\n  }\n\n  _toast(msg) {\n    const t = this.s.add.text(\n      Math.round(this.s.scale.width / 2),\n      Math.round(this.s.scale.height - 64),\n      msg,\n      { fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#ffffff' }\n    ).setOrigin(0.5).setDepth(this.depthBase + 10).setScrollFactor(0);\n    this.s.tweens.add({ targets:t, y:t.y-12, alpha:0, delay:600, duration:1600, onComplete:()=>t.destroy() });\n  }\n\n  close() {\n    if (this._onWheel) this.s.input.off('wheel', this._onWheel);\n    this.kill.forEach(o => { try { o.destroy(); } catch(_) {} });\n    this.onClose && this.onClose();\n\n  }\n}\n","// src/ui/WalletBadge.js\nexport class WalletBadge {\n  constructor(scene, wallet, {\n    x = 320, y = 46,\n    width = 420,\n    showPerks = true,\n    labels = { coins: '–°–µ—Ä–µ–±—Ä–æ', gold: '–ó–æ–ª–æ—Ç–æ', perks: '–ü–µ—Ä–∫–∏' },\n  } = {}) {\n    this.s = scene;\n    this.wallet = wallet || { coins: 0, gold: 0, perks: 0 };\n    this.w = width; this.h = 54;\n\n    this.c = scene.add.container(x, y).setDepth(952);\n\n    // –∫–∞—Ä—Ç–æ—á–∫–∞-—Ñ–æ–Ω\n    const card = scene.add.rectangle(0, 0, this.w, this.h, 0x151b27, 1)\n      .setOrigin(0.5).setStrokeStyle(2, 0xffffff, 0.14);\n    const gloss = scene.add.rectangle(0, -this.h/2 + 8, this.w - 16, 10, 0xffffff, 0.05).setOrigin(0.5);\n    this.c.add([card, gloss]);\n\n    // —Ä–∞–∑–º–µ—Ç–∫–∞ –ø–æ–¥ 2/3 –ø–∏–ª—é–ª–∏\n    const pad = 8;\n    const cols = showPerks ? 3 : 2;\n    const pillW = Math.floor((this.w - pad*(cols+1)) / cols);\n    const pillH = 34;\n    const y0 = 0;\n\n    // –ø–∏–ª—é–ª–∏\n    this.pillCoins = this._makePill(-this.w/2 + pad + pillW/2, y0, pillW, pillH, 0x212a3c, this._icCoin.bind(this), labels.coins);\n    this.pillGold  = this._makePill(this.pillCoins.grp.x + pillW/2 + pad + pillW/2, y0, pillW, pillH, 0x2a3348, this._icGold.bind(this), labels.gold);\n\n    if (showPerks) {\n      const xPerk = this.pillGold.grp.x + pillW/2 + pad + pillW/2;\n      this.pillPerk = this._makePill(xPerk, y0, pillW, pillH, 0x252e41, this._icPerk.bind(this), labels.perks);\n    }\n\n    this.set(this.wallet.coins|0, this.wallet.gold|0, this.wallet.perks|0);\n  }\n\n  set(coins, gold, perks = 0){\n    this.coins = coins|0; this.gold = gold|0; this.perks = perks|0;\n    this.pillCoins.value.setText(String(this.coins));\n    this.pillGold.value.setText(String(this.gold));\n    if (this.pillPerk) this.pillPerk.value.setText(String(this.perks));\n  }\n\n  setPosition(x,y){ this.c.setPosition(x,y); }\n  getBounds(){ return new Phaser.Geom.Rectangle(this.c.x - this.w/2, this.c.y - this.h/2, this.w, this.h); }\n\n  // ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî\n  _makePill(cx, cy, w, h, color, drawIcon, label){\n    const grp = this.s.add.container(cx, cy); this.c.add(grp);\n\n    const bg = this.s.add.rectangle(0, 0, w, h, color, 1)\n      .setOrigin(0.5).setStrokeStyle(2, 0xffffff, 0.12);\n    const gloss = this.s.add.rectangle(0, -h/2 + 5, w - 10, 8, 0xffffff, 0.06).setOrigin(0.5);\n\n    // –∏–∫–æ–Ω–∫–∞\n    const ic = this.s.add.graphics({ x: -w/2 + 16, y: 0 });\n    drawIcon(ic, 0, 0);\n\n    // –ø–æ–¥–ø–∏—Å—å –∏ —á–∏—Å–ª–æ\n    const labelT = this.s.add.text(ic.x + 18, -9, label, { fontFamily:'Arial, sans-serif', fontSize:'11px', color:'#a9b7d0' }).setOrigin(0,0.5);\n    const valueT = this.s.add.text(ic.x + 18, 8,  '0', { fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#eaf2ff' }).setOrigin(0,0.5);\n\n    // –ø–ª—é—Å–∏–∫ (–ø–æ–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π)\n    const plus = this.s.add.rectangle(w/2 - 14, 0, 22, 22, 0xffffff, 0.10)\n      .setOrigin(0.5).setStrokeStyle(2, 0xffffff, 0.14);\n    const plusT = this.s.add.text(plus.x, plus.y - 1, '+', { fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#ffffff' }).setOrigin(0.5);\n\n    grp.add([bg, gloss, ic, labelT, valueT, plus, plusT]);\n    return { grp, value: valueT };\n  }\n\n  _icCoin(g,x,y){ g.fillStyle(0xf6d463,1).fillCircle(x,y,8); g.fillStyle(0xffffff,0.6).fillCircle(x-3,y-3,2); g.lineStyle(2,0xffffff,0.18).strokeCircle(x,y,8); }\n  _icGold(g,x,y){ const R1=8,R2=3.6,pts=[]; for(let i=0;i<10;i++){const a=-Math.PI/2+i*Math.PI/5,r=i%2?R2:R1;pts.push({x:x+Math.cos(a)*r,y:y+Math.sin(a)*r});} g.fillStyle(0xffe47a,1).fillPoints(pts,true); g.lineStyle(2,0xffffff,0.18).strokePoints(pts,true); }\n  _icPerk(g,x,y){ g.lineStyle(2,0xb9d7ff,1); g.strokeCircle(x,y,8); g.beginPath(); g.moveTo(x-5,y); g.lineTo(x+5,y); g.moveTo(x,y-5); g.lineTo(x,y+5); g.strokePath(); }\n}\n\nexport default WalletBadge;\n","// src/scenes/Base.js\nimport MarketModal from '../ui/MarketModal.js';\nimport ShopModal from '../ui/ShopModal.js';\nimport { VM as vm } from '../vm.js';\nimport { onWalletChange } from '../quests/QuestHooks.js'; // —É —Ç–µ–±—è —ç–∫—Å–ø–æ—Ä—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–æ–∂–µ –µ—Å—Ç—å ‚Äî –∏–º–ø–æ—Ä—Ç—É–π –∫–∞–∫ –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–∏–Ω—è—Ç–æ\n\nimport { WalletBadge } from '../ui/WalletBadge.js';\n\n\nexport class Base extends Phaser.Scene {\n  constructor(){ super('Base'); }\n\n  preload(){\n    // –ü–æ–ª–æ–∂–∏ –ª—é–±–æ–π —Ñ–æ–Ω –ø–æ —ç—Ç–æ–º—É –ø—É—Ç–∏ –∏–ª–∏ –ø–æ–º–µ–Ω—è–π –∫–ª—é—á/URL\n    this.load.image('base_bg', 'assets/ui/base_bg.jpg');\n  }\n\n  create(data){\n    // –ë–µ—Ä—ë–º –∏–∑ VM —á–µ—Ä–µ–∑ get(), –∏–Ω–∞—á–µ ‚Äî –∏–∑ data, –∏–Ω–∞—á–µ ‚Äî –∏–∑ –¥–µ—Ñ–æ–ª—Ç–æ–≤\n    const d = vm?.defaults?.() ?? { wallet:{coins:0,gold:0}, keepnet:[], keepnetCap:25 };\n\n    this.state      = vm?.get?.('state',      data?.state)      ?? {};\n    this.wallet     = vm?.get?.('wallet',     data?.wallet)     ?? d.wallet;\n    this.keepnet    = vm?.get?.('keepnet',    data?.keepnet)    ?? d.keepnet;\n    this.keepnetCap = vm?.get?.('keepnetCap', data?.keepnetCap) ?? d.keepnetCap;\n     // –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏ —É—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫–∞ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞\n    this.inventory  = vm?.get?.('inventory') ?? {\n      rods:  ['rod_wood_1'],\n      reels: ['reel_rusty'],\n      lines: ['line_old_1'],\n      hooks: ['hook_rusty'],\n      bait:  { worm: 25 }\n  };\n  this.playerLevel = vm?.get?.('level') ?? 1;\n\n    const W = this.scale.width, H = this.scale.height;\n\n    // ===== –§–û–ù —Å cover-–ø–æ–¥–≥–æ–Ω–∫–æ–π =====\n    this.bg = this.add.image(W/2, H/2, 'base_bg').setDepth(-100).setOrigin(0.5);\n    this._fitCover(this.bg);\n    // –ª—ë–≥–∫–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ, —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –≤—Å–µ–≥–¥–∞ —á–∏—Ç–∞–ª—Å—è (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –≤ layout)\n    this.bgDim = this.add.rectangle(W/2, H/2, W, H, 0x0b1222, 0.42)\n      .setDepth(-99).setScrollFactor(0);\n\n    // ===== –®–∞–ø–∫–∞ =====\n    this.add.text(12, 10, '–ë–∞–∑–∞', {\n      fontFamily:'Arial, sans-serif', fontSize:'26px', color:'#ffffff'\n    }).setDepth(940).setOrigin(0,0);\n\n    this.walletBadge = new WalletBadge(this, this.wallet, { x: 300, y: 36 });\n    this.updateWallet();\n\n    // ¬´–∫ –≤–æ–¥–æ—ë–º—É¬ª + –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ —Å–∞–¥–∫–∞ ‚Äî –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –±–µ–π–¥–∂–∞\n    this._makeBackButton();\n\n    // ===== –ú–µ–Ω—é –ø–æ —Ü–µ–Ω—Ç—Ä—É =====\n    this.menu = this.add.container(W/2, H/2).setDepth(950);\n    const mkBtn = (label, onClick, {enabled=true, icon=null}={})=>{\n      const w = 360, h = 56;\n      const r = this.add.rectangle(0,0,w,h, enabled?0x2b334a:0x232838, 1)\n        .setStrokeStyle(2, 0xffffff, enabled?0.18:0.10)\n        .setOrigin(0.5).setDepth(951);\n      if (enabled) {\n        r.setInteractive({ useHandCursor:true })\n         .on('pointerover', ()=> r.setFillStyle(0x323c58,1))\n         .on('pointerout',  ()=> r.setFillStyle(0x2b334a,1))\n         .on('pointerdown', onClick);\n      } else {\n        r.setAlpha(0.6);\n      }\n      const txt = this.add.text(0,0, `${icon?icon+' ':''}${label}`, {\n        fontFamily:'Arial, sans-serif', fontSize:'20px', color:'#ffffff'\n      }).setOrigin(0.5).setDepth(952);\n      const c = this.add.container(0,0,[r,txt]);\n      this.menu.add(c);\n      return c;\n    };\n\n    const items = [\n      mkBtn('–ü—Ä–æ–¥–∞—Ç—å —Ä—ã–±—É', ()=> this.openMarket(), { icon:'üß∫' }),\n      mkBtn('–ú–∞–≥–∞–∑–∏–Ω', ()=> this.openShop(), { enabled:true, icon:'üõí' }),\n      mkBtn('–£–ª—É—á—à–µ–Ω–∏—è (WIP)', ()=>{}, { enabled:false, icon:'üõ†Ô∏è' }),\n      mkBtn('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å (WIP)', ()=>{}, { enabled:false, icon:'üéí' }),\n    ];\n    const GAP = 16;\n    items.forEach((c,i)=> c.setPosition(0, i*(56+GAP)));\n\n    // –ø–æ–¥—Å–∫–∞–∑–∫–∞ –≤–Ω–∏–∑—É\n    this.add.text(W/2, H-10,\n      '–ù–∞ ¬´–ë–∞–∑–µ¬ª –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ —Ä—ã–±–∞–ª–∫–∞. –ó–¥–µ—Å—å ‚Äî —Ç–æ—Ä–≥–æ–≤–ª—è, –ø–µ—Ä–∫–∏, –º–∞–≥–∞–∑–∏–Ω –∏ –ø—Ä.',\n      { fontFamily:'Arial, sans-serif', fontSize:'14px', color:'#9fb1db' }\n    ).setOrigin(0.5,1).setDepth(930);\n\n    // –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞ ¬´–Ω–∞–∑–∞–¥¬ª\n    this.input.keyboard?.on('keydown-ESC', () => {\n      this.commitToVM();\n      this.scene.start('Start');\n    });\n\n    // —Ä–µ—Å–ø–æ–Ω—Å–∏–≤\n    this.scale.on('resize', ()=> this.layout());\n    this.layout();\n  }\n\n  // ===== –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ VM (–º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞!) =====\n  commitToVM(){\n    vm.set?.('wallet', this.wallet);\n    vm.set?.('keepnet', this.keepnet);\n    vm.set?.('keepnetCap', this.keepnetCap);\n    vm.set?.('inventory', this.inventory);\n    vm.set?.('level', this.playerLevel);\n  }\n\n  layout(){\n    const W = this.scale.width, H = this.scale.height;\n    this._fitCover(this.bg);\n    this.menu.setPosition(W/2, Math.round(H*0.40));\n    // –æ–≤–µ—Ä–ª–µ–π –ø–æ–¥–≥–æ–Ω—è–µ–º –ø–æ–¥ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ\n    this.bgDim.setPosition(W/2, H/2);\n    this.bgDim.setSize(W, H);\n\n    // –æ–±–Ω–æ–≤–∏–º –ø–æ–∑–∏—Ü–∏—é back-–∫–Ω–æ–ø–∫–∏\n    const badge = this._backBadge;\n    const bx = W - 150, by = 36;\n    this._backBtn?.setPosition(bx, by);\n    this._backLbl?.setPosition(bx, by);\n    badge?.setPosition(bx + 140, by); // –º–∞–ª–µ–Ω—å–∫–∞—è ¬´–ø–∏–ª—é–ª—è¬ª —Å–∞–¥–∫–∞ —Å–ø—Ä–∞–≤–∞ –æ—Ç –∫–Ω–æ–ø–∫–∏\n  }\n\n  // ===== –∫–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –º–∏–Ω–∏-—Å—á—ë—Ç—á–∏–∫ —Å–∞–¥–∫–∞ =====\n  _makeBackButton(){\n    const W = this.scale.width;\n    const bx = W - 150, by = 36;\n    const bw = 170, bh = 40;\n\n    this._backBtn = this.add.rectangle(bx, by, bw, bh, 0x36425b, 1)\n      .setStrokeStyle(2, 0xffffff, 0.20).setDepth(953)\n      .setInteractive({ useHandCursor:true })\n      .on('pointerover', ()=> this._backBtn.setFillStyle(0x3c4a66,1))\n      .on('pointerout',  ()=> this._backBtn.setFillStyle(0x36425b,1))\n      .on('pointerdown', ()=> {\n        this.commitToVM();\n        this.scene.start('Start');\n      });\n\n    this._backLbl = this.add.text(bx, by, '‚Üê –ö –≤–æ–¥–æ—ë–º—É', {\n      fontFamily:'Arial, sans-serif', fontSize:'18px', color:'#ffffff'\n    }).setOrigin(0.5).setDepth(954);\n\n    // –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ —Å–∞–¥–∫–∞ (–ø–∏–ª—é–ª—è)\n    const pillW = 86, pillH = 30;\n    const r = this.add.rectangle(bx + 140, by, pillW, pillH, 0x2a3348, 1)\n      .setOrigin(0.5).setStrokeStyle(2, 0xffffff, 0.12).setDepth(954);\n    const t = this.add.text(r.x, r.y, '0/0', {\n      fontFamily:'Arial, sans-serif', fontSize:'16px', color:'#eaf2ff'\n    }).setOrigin(0.5).setDepth(955);\n    this._backBadge = { r, t, setPosition:(x,y)=>{ r.setPosition(x,y); t.setPosition(x,y);} };\n    this.refreshKeepnetPill();\n  }\n\n  refreshKeepnetPill(){\n    if (!this._backBadge) return;\n    this._backBadge.t.setText(`${this.keepnet.length}/${this.keepnetCap}`);\n  }\n\n  updateWallet(){\n    this.walletBadge?.set(this.wallet.coins|0, this.wallet.gold|0);\n  }\n\n  openMarket(){\n    // –º–æ–¥–∞–ª–∫–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ; –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º –∫–æ—à–µ–ª—ë–∫ –∏ —Å—á—ë—Ç—á–∏–∫\n    new MarketModal(\n      this,\n      this.keepnet,\n      this.wallet,\n      ()=>{ // onChange\n        this.updateWallet();\n        this.refreshKeepnetPill();\n        this.commitToVM();\n        onWalletChange(this.wallet); // QUEST HOOKS\n      },\n      ()=>{ // onClose\n        this.updateWallet();\n        this.refreshKeepnetPill();\n        this.commitToVM();\n        onWalletChange(this.wallet); // –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∫–æ—à–µ–ª—ë–∫ –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–∏\n      }\n    );\n  }\n   openShop(){\n  new ShopModal(\n    this,\n    this.wallet,\n    this.inventory,\n    this.playerLevel,\n    ()=>{ // onChange\n      this.updateWallet();\n      this.commitToVM();\n    },\n    ()=>{ // onClose\n      this.updateWallet();\n      this.commitToVM();\n    }\n  );\n}\n\n\n  _fitCover(img){\n    const W = this.scale.width, H = this.scale.height;\n    const k = Math.max(W / img.width, H / img.height);\n    img.setScale(k).setPosition(W/2, H/2);\n  }\n}\n\nexport default Base;\n","//  /src/scenes/Auth.js\n\nimport { API, Auth } from '../net/api.js';\n\nexport default class AuthScene extends Phaser.Scene {\n  constructor(){ super('Auth'); }\n\n  preload(){}\n\n  create(){\n    const W = this.scale.width, H = this.scale.height;\n    const cx = W/2, cy = H/2, panelW = Math.min(420, W-60), panelH = 300;\n\n    const panel = this.add.rectangle(cx, cy, panelW, panelH, 0x101420, 1)\n      .setStrokeStyle(2, 0xffffff, 0.18);\n\n    const title = this.add.text(cx, cy - panelH/2 + 16, '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è / –í—Ö—ñ–¥', {\n      fontFamily:'Arial', fontSize:'20px', color:'#fff'\n    }).setOrigin(0.5,0);\n\n    // HTML-–∏–Ω–ø—É—Ç—ã —á–µ—Ä–µ–∑ DOMElement (—É–¥–æ–±–Ω–æ –¥–ª—è –º–æ–±–∏–ª–∫–∏)\n    this.add.dom(cx, cy-20).createFromHTML(`\n      <div style=\"display:flex; flex-direction:column; gap:8px; width:${panelW-60}px\">\n        <input id=\"email\"    type=\"text\" placeholder=\"Email –∞–±–æ username\" style=\"padding:8px;border-radius:8px;border:1px solid #445;background:#0e1220;color:#fff\" />\n        <input id=\"username\" type=\"text\" placeholder=\"–ù—ñ–∫ (–¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó)\" style=\"padding:8px;border-radius:8px;border:1px solid #445;background:#0e1220;color:#fff\" />\n        <input id=\"pass\"     type=\"password\" placeholder=\"–ü–∞—Ä–æ–ª—å\" style=\"padding:8px;border-radius:8px;border:1px solid #445;background:#0e1220;color:#fff\" />\n        <div style=\"display:flex; gap:12px; margin-top:8px;\">\n          <button id=\"btnReg\"  style=\"flex:1;padding:10px;border-radius:10px;border:none;background:#2b74ff;color:#fff\">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>\n          <button id=\"btnLog\"  style=\"flex:1;padding:10px;border-radius:10px;border:1px solid #5a6;color:#cfe\">–£–≤—ñ–π—Ç–∏</button>\n        </div>\n        <div id=\"err\" style=\"color:#f88; min-height:20px; font:12px Arial;\"></div>\n      </div>\n    `);\n\n    const dom = document;\n    const byId = (id)=> dom.getElementById(id);\n    const showErr = (t)=> { const e = byId('err'); if (e) e.textContent = t || ''; };\n\n    const goStart = async ()=>{\n      try{\n        // –ø–æ–¥—Ç—è–Ω—É—Ç—å state –∏ —Å—Ç–∞—Ä—Ç–∞–Ω—É—Ç—å Start\n        this.scene.start('Start', {});\n      }catch(e){ showErr('–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É'); }\n    };\n\n    byId('btnReg')?.addEventListener('click', async ()=>{\n      showErr('');\n      const email = byId('email').value.trim();\n      const username = byId('username').value.trim();\n      const pass = byId('pass').value;\n      try{\n        const r = await API.register(email, username, pass);\n        Auth.token = r.token;\n        await goStart();\n      }catch(err){ showErr('–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–µ –≤–¥–∞–ª–∞—Å—è'); }\n    });\n\n    byId('btnLog')?.addEventListener('click', async ()=>{\n      showErr('');\n      const emailOrUsername = byId('email').value.trim();\n      const pass = byId('pass').value;\n      try{\n        const r = await API.login(emailOrUsername, pass);\n        Auth.token = r.token;\n        await goStart();\n      }catch(err){ showErr('–ù–µ–≤—ñ—Ä–Ω—ñ –¥–∞–Ω—ñ'); }\n    });\n  }\n}\n","// src/main.js\nimport { Auth } from './net/api.js';\nimport VM from './vm.js';\nimport { Start } from './scenes/Start.js';\nimport Base from './scenes/Base.js';\nimport AuthScene from './scenes/Auth.js';\n\n(async () => {\n  // 1) —É–∑–Ω–∞—ë–º —é–∑–µ—Ä–∞ (–ø–æ–¥—Ç—è–≥–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ LS)\n  try { await Auth.ensure(); } catch {}\n\n  const uid = Auth?.user?.id || 'guest';\n\n  // 2) –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –≤–µ—Å—å —Ä–∞–Ω: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è —ç—Ç–æ–≥–æ —é–∑–µ—Ä–∞\n  VM.init({ persist: true, key: `rf.vm.u:${uid}` });\n\n  // (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–ª–æ–≥–∏–Ω–∏–ª–∏—Å—å ‚Äî –º–∏–≥—Ä–∏—Ä—É–π –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ–π–≤:\n  if (uid !== 'guest') {\n    const guestKey = 'rf.vm.u:guest';\n    if (!localStorage.getItem(`rf.vm.u:${uid}`) && localStorage.getItem(guestKey)) {\n      localStorage.setItem(`rf.vm.u:${uid}`, localStorage.getItem(guestKey));\n    }\n  }\n\n  console.log('[BOOT] VM key =', VM._lsKey,\n              'raw =', localStorage.getItem(VM._lsKey)); // –¥–µ–±–∞–≥: –≤–∏–¥–Ω–æ, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –ª–µ–∂–∏—Ç –≤ LS\n\n  const config = {\n  type: Phaser.AUTO,\n  title: 'Overlord Rising',\n  description: '',\n  parent: 'game-container',      // <div id=\"game-container\"></div> –≤ index.html\n  width: 1280,\n  height: 720,\n  backgroundColor: '#000000',\n  pixelArt: false,\n  scene: [Start, Base, AuthScene], // –ø–æ—Ä—è–¥–æ–∫ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω, –≥–ª–∞–≤–Ω–æ–µ ‚Äî —á—Ç–æ–±—ã —Å—Ü–µ–Ω–∞ –±—ã–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞\n  scale: {\n    mode: Phaser.Scale.FIT,\n    autoCenter: Phaser.Scale.CENTER_BOTH,\n  },\n  dom: { createContainer: true }, // <<< –í–ö–õ–Æ–ß–ê–ï–ú DOM, –∏–Ω–∞—á–µ this.add.dom –∫–∏–Ω–µ—Ç –æ—à–∏–±–∫—É\n};\n\n  new Phaser.Game(config);\n})();"],"names":["API_BASE","LS_USER","LS_TOKEN","LS_STATE","tryFetch","url","opts","r","Auth","t","u","email","password","data","user","token","API","raw","state","VM","k","dflt","v","obj","persist","key","scene","_b","_a","_c","_d","GearSlots","a2","a3","gear","onClick","slotsBottom","W","H","i","idx","x","bg","icon","value","hit","fn","gearIn","text","el","FishCatalog","LootCatalog","SPAWN_TABLES","Catalog","s","weightFromTable","loc","id","timeAllowed","def","tag","pref","depthRangeFromTable","pickWeighted","pairs","sum","w","rollWeight","spec","bait","minW","maxW","baseBias","bias","randInt","b","rollReward","a","spawnFish","ctx","tod","d","candidates","sp","d0","d1","minD","maxD","pool","areaMods","y","TYPE_WEIGHT","mul","chosenSpec","chosenW","weightKg","reward","BASE_TUNING","clamp","pow","calcFightParams","fish","hookQ","T","deepMerge","env","difficulty","rodCap","lineCap","reelBoost","hookCtrl","weight","aggression","burst","endurance","agility","ratioRod","ratioLine","meanRatio","rigPenalty","_e","effHookQ","RATE_AT_1","alpha","diffScale","rate","rodUp","lineUp","down","envFishK","envPullK","basePull","baseFish","pullSpeed","fishPullSpeed","fishCap","escapeLimit","heav","jerkAdd","jerkChance","baseSlipChance","_f","out","HBar","xLeft","yBottom","width","height","label","pct","on","vis","g","h","threshold","val","fillW","danger","fillColor","fillR","glossH","tx","BarsDock","slots","pullBtnRect","gap","leftX","rightX","pad","innerX","innerRight","innerW","barH","spacing","barsBottom","mode","active","rodVal","lineVal","Progress","level","rarity","base","mult","released","gain","amount","add","leveled","need","o","GearModal","kind","list","activeId","onPick","onClose","titleText","it","row","rowH","name","subTxt","sub","tick","panelW","panelH","areaLeft","areaTop","areaWidth","rowGap","textLeft","GearDB","getDefaultGear","Bobber","isShallow","tw","UI","px","ModalHost","baseDepth","swallow","pointer","_x","_y","event","e","buildFn","depthOffset","c","closed","escCb","api","escOnce","container","__vite_glob_0_0$1","__vite_glob_0_1$1","__vite_glob_0_2$1","__vite_glob_0_3$1","BG","__vite_glob_0_0","__vite_glob_0_1","__vite_glob_0_2","__vite_glob_0_3","LOCATIONS","LocationMgr","initialId","S","dayKey","dayUrl","nightKey","_g","_h","nightUrl","_i","_j","file","imgDay","imgNight","imgDayW","imgNightW","_k","info","phase","dayImg","nightImg","useDay","dayW","nightW","veilA","color","p","ti","pm","pipe","amp","waveLen","speed","go","_t","dt","n","vals","topY","bottomY","lock","toPx","top","bottom","shore","Hwater","allowedPolys","polys","poly","p0","have","minV","maxV","pt","img","castMask","left","span","vv","inside","j","xi","yi","xj","yj","mask","toXY","draw","pts","t0","t1","cols","colIdx","samples","dc","prof","depths","max","gx","gy","c0","c1","r0","r1","ty","d00","d10","d01","d11","bands","yg","areas","mods","l","ShopCatalog","ensureCatalogInGearDB","arrName","__vite_glob_0_4","__vite_glob_0_5","__vite_glob_0_6","__vite_glob_0_7","__vite_glob_0_8","__vite_glob_0_9","__vite_glob_1_0","__vite_glob_1_1","__vite_glob_1_2","__vite_glob_1_3","__vite_glob_1_4","__vite_glob_1_5","__vite_glob_1_6","_toIdArray","cat","FISH_IDS","PICK_IDS","fishFiles","pickFiles","_toNameUrlMap","m","path","lastSlash","FISH_URL","PICK_URL","ALIAS","_MISSING","_LOADED","idsForLocation","locId","table","ids","fishIdsForLocation","pickIdsForLocation","_attachLogsOnce","type","queueForScene","lists","doFish","doPick","oldPath","enqFish","enqPick","ensureOne","resolve","onDone","doneKey","PhotoBank","_fmtKg","_fmtG","_drawImage","keyOrFrame","box","depth","frame","im","py","_statLine","t2","_badge","_triangleBtn","dir","size","_button","disabled","fontSize","_renderEntry","ui","entry","idxInfo","PAD","D","cx","cy","SCALE","PW","PH","SZ","CLOSE_DELAY_MS","canClose","tryClose","overlay","shadow","panel","_","__","___","panelRect","isInsidePanel","onGlobalPointerDown","detach","prevEsc","title","btnClose","lx","ly","ev","innerTop","innerH","colGap","leftW","rightW","imgBox","imgFrame","imgObj","lR","lG","rR","rG","pageText","rFrame","rx0","ry","nameT","infoStr","infoLabel","SHIFT_X","wrapW","desc","by","GAP","rightEdge","actions","xR","aL","aR","xL","keyEsc","_pickInfo","_entryForFish","keepnetFull","badges","stats","imageKey","_entryForLoot","pick","coins","openFishCatchModal","extra","baseKeepnet","finished","finish","rerender","cur","isCatch","removed","iLocal","openKeepnetModal","keepnet","startIndex","orig","iGlobal","openLootModal","KeepnetBadge","capacity","M","count","ClockHUD","timeCycle","C","ringSize","contentW","end","force","LevelBadge","progress","fallback","lvl","curRaw","needRaw","bx","bw","bh","DepthSonar","outer","inner","tabX","ctrl","castX","castY","u0","currentY","xIdx","i0","i1","frac","bottomDepth","rig","baitDepth","dotDepth","tension","reeling","noiseAmp","noise","wantDive","target","L","VW","VH","range","mx","my","drift","lm","shift","rW","rH","BRX","BRY","DepthCtrl","initValueM","pos","onChange","newCm","silent","clamped","nx","deltaCm","vMeters","rawCm","snappedCm","root","withOverlay","ovr","closeX","trackW","trackY","x0","x1","track","toX","ticksG","stepTick","dragTo","rawM","vCm","_p","dragX","makeBtn","txt","ok","okLbl","cancel","cancelLbl","hostRoot","apply","openMapModal","buildMapUI","cleanup","maskG","onResize","W2","H2","depthBase","listPad","listH","listY","twoCols","itemW","itemH","col","minY","onWheel","onDragMove","onDragUp","dragging","lastY","_dx","dy","ActionDock","onBase","onLocationPick","wallet","showPerks","z","gold","perks","bH","contentH","wBase","wExp","wChip","chip","coinsW","goldW","perksW","chipGroupW","hitW","hitH","drawIcon","ic","needW","PagedGrid","pg","cb","items","index","instant","total","next","prevPage","nextPage","totalPages","makeCell","makeStub","dash","page","gi","item","node","indexes","startX","dot","atFirst","atLast","min","NPCS","getAllNPC","_pending","emitQuestProgress","detail","fire","LS_KEY","_state","load","save","ensureNpc","npcId","emit","QuestState","npcDef","stIx","task","rec","taskId","delta","npc","stage","finishedIndex","goal","_sink","setRewardSink","grantReward","openQuestsModal","host","ensureModalHost","QuestsModal","modalApi","origClose","sw","sh","maxH","baseVW","baseVH","dotsH","stop","_lx","_ly","_dy","closeBtn","hover","portrait","star","openQuestDetailsModal","st","winW","winH","y0","panelHit","isActive","actBtn","cont","head","avatar","stName","hp","pw","ph","bar","ratio","counter","innerY","viewH","scrollWrap","body","labelTasks","makeTaskRowUI","none","_l","labelRw","_m","chips","makeRewardChipsUI","ready","claim","makeClaimButtonUI","rwd","currentScroll","maxY","_n","done","check","prog","right","children","push","enabled","fill","stroke","ActiveQuestHUD","baseZ","newW","now","_pickTrackedQuest","sc","rect","immediately","headerTaskId","_taskProgress","totalH","rrShadow","rr","openAllRow","baseCol","hoverCol","textTop","iconY","barW","barY","chevron","btnW","btnH","npcs","tracked","scan","TopHUD","cap","ckB","dockW","dockH","row1Y","knW","knH","knX","knY","maxRight","minLeft","dockX","aqMinW","aqMaxW","leftEdge","avail","useW","aqY","underGap","centerX","vgap","row2Y","lvlY","baselineY","raise","sonarY","sizeW","xRight","TimeCfgDefault","ORDER","TimeCycle","cfg","onPhaseChange","hhmm","schedule","passed","baseMs","pct24","mins24","clock","curName","curStart","nextName","nextStart","dur","into","initial","LocationEditor","locationId","ax","ay","vx","vy","wx","wy","c2","ptUV","bestI","bestD","maxDist","best","kb","TOP","SHORE","toUV","gAllowed","gBlocked","handles","ensurePoly","layer","colors","previewApply","repaintPolys","drawSet","rebuildHandles","dragY","uv","repaintAll","addAtCursor","ptr","onOverlayPointerDown","roundN","roundPolys","onKey","A","B","payload","wb","E","speciesList","curSpIdx","curSpecies","ensureLayer","repaint","vi","dx","clean","one","inRange","lo","hi","normStr","evIs","evs","weightToG","getSpeciesId","normTime","listFromKgOrG","params","_anyHasItemId","arr","wantId","QuestKinds","toleranceG","ignoreZero","targetsG","tg","want","_pick","dm","purchase","inventory","cats","baits","matchTask","processEvent","targets","ctxExt","changed","onCatch","onWalletChange","onLevelChange","onItemBought","onInventoryChange","handleCatch","_phaseToTime","mergedCtx","questOnCatch","ChatClient","io","baseUrl","ChatOverlay","chatClient","roomId","dom","msg","limit","renderNow","Start","Phaser","savedProgress","savedLevel","_saveTO","res","_o","_q","parts","actualDepth","minStand","lie","invFromVM","slot","prevId","stacks","tempX","tempY","btnRect","area","waterDepth","hookDepth","delay","tinfo","picked","halfWin","K","targetY","targetX","chance","minMs","maxMs","bump","bottomClamp","P","distToShore","nearShoreFactor","topEdge","distTop","slow","sideMult","step","move","atShore","safe","hid","questCtx","prevLock","action","award","bag","close","names","nameTxt","cntTxt","btn","btnLbl","PriceRules","ruleFor","f","isPremium","isRecord","priceKg","pricePremium","summarizeKeepnet","small","prem","sumSmall","sumPrem","cntRec","MarketModal","_dz","titleTop","headerH","gapCols","colW","capL","capR","areaH","leftFrame","rightFrame","gp","cardW","cardH","y2","subtitle","countText","estText","button","iconBox","iconG","textX","titleT","subT","cntT","estT","btnT","update","yy","order","imgH","pillW","pillH","priceBox","priceT","grp","gloss","pCoins","pKeep","pGold","keepStr","parent","ShopModal","titleY","lvlTxt","over","dz","catMaskG","catMask","listMaskG","listMask","defaultOrder","available","BTN_H","PADX","deltaY","first","last","curFirstY","curLastY","corr","withFade","objs","imgRect","req","own","buy","priceStr","buyLbl","canBuy","reason","ownedNote","note","kindPlural","qty","itemObj","pack","up","WalletBadge","labels","card","xPerk","labelT","valueT","plus","plusT","Base","vm","mkBtn","badge","AuthScene","byId","showErr","goStart","username","pass","emailOrUsername","uid","guestKey","config"],"mappings":"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"}